<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>pgBackRest Référence de commandes</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8"></meta><meta property="og:site_name" content="pgBackRest - Reliable PostgreSQL Backup &amp; Restore"></meta><meta property="og:title" content="pgBackRest Référence de commandes"></meta><meta property="og:type" content="website"></meta><link rel="icon" href="favicon.png" type="image/png"></link><meta property="og:image:type" content="image/png"></meta><meta property="og:image" content="http://www.pgbackrest.org/logo.png"></meta><meta name="description" content="La référence de commandes de {[projet]} détaille toutes les commandes et options."></meta><meta property="og:description" content="La référence de commandes de {[projet]} détaille toutes les commandes et options."></meta><link rel="stylesheet" href="default.css" type="text/css"></link></head><body><div class="page-header"><div class="page-header-title">pgBackRest Référence de commandes</div></div><div class="page-menu"><div class="menu-body"><div class="menu"><a class="menu-link" href="configuration.html">Configuration</a></div></div></div><div class="page-toc"><div class="page-toc-header"><div class="page-toc-title">Table of Contents</div></div><div class="page-toc-body"><div class="section1-toc"><div class="section1-toc-number">1</div><div class="section1-toc-title"><a href="#introduction">Introduction</a></div></div><div class="section1-toc"><div class="section1-toc-number">2</div><div class="section1-toc-title"><a href="#command-archive-get">Commande Récupération Archive (<span class="id">archive-get</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">3</div><div class="section1-toc-title"><a href="#command-archive-push">Commande Pousser Archive (<span class="id">archive-push</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">4</div><div class="section1-toc-title"><a href="#command-backup">Commande Sauvegarde (<span class="id">backup</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">5</div><div class="section1-toc-title"><a href="#command-check">Commande Vérification (<span class="id">check</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">6</div><div class="section1-toc-title"><a href="#command-expire">Commande Expiration (<span class="id">expire</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">7</div><div class="section1-toc-title"><a href="#command-help">Commande Aide (<span class="id">help</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">8</div><div class="section1-toc-title"><a href="#command-info">Commande Info (<span class="id">info</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">9</div><div class="section1-toc-title"><a href="#command-repo-create">Commande Création dépôt (<span class="id">repo-create</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">10</div><div class="section1-toc-title"><a href="#command-repo-get">Commande Obtenir un fichier du dépôt (<span class="id">repo-get</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">11</div><div class="section1-toc-title"><a href="#command-repo-ls">Commande Liste des chemins/dossiers du dépôt (<span class="id">repo-ls</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">12</div><div class="section1-toc-title"><a href="#command-repo-put">Commande Déposer un ficher (<span class="id">repo-put</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">13</div><div class="section1-toc-title"><a href="#command-repo-rm">Commande Supprimer les chemins/dossiers du dépôt (<span class="id">repo-rm</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">14</div><div class="section1-toc-title"><a href="#command-restore">Commande Restauration (<span class="id">restore</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">15</div><div class="section1-toc-title"><a href="#command-stanza-create">Commande Création du Stanza (<span class="id">stanza-create</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">16</div><div class="section1-toc-title"><a href="#command-stanza-delete">Commande suppression du Stanza (<span class="id">stanza-delete</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">17</div><div class="section1-toc-title"><a href="#command-stanza-upgrade">Commande Mise à niveau du Stanza (<span class="id">stanza-upgrade</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">18</div><div class="section1-toc-title"><a href="#command-start">Commande Start (<span class="id">start</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">19</div><div class="section1-toc-title"><a href="#command-stop">Commande Stop (<span class="id">stop</span>)</a></div></div><div class="section1-toc"><div class="section1-toc-number">20</div><div class="section1-toc-title"><a href="#command-version">Commande Version (<span class="id">version</span>)</a></div></div></div></div><div class="page-body"><div class="section1"><a id="introduction"></a><div class="section1-header"><div class="section1-number">1</div><div class="section1-title">Introduction</div></div><div class="section-intro">Les commandes sont utilisées pour exécuter les différentes fonctionnalités de <span class="backrest">pgBackRest</span>. Ici, les options de commande sont énumérées de manière détaillée, autrement dit, chaque option applicable à une commande est énumérée avec cette commande, même si elle s'applique à une ou plusieurs autres commandes. Cela inclut toutes les options qui peuvent également être configurées dans <span class="file">pgbackrest.conf</span>.<br/>
<br/>
Les options non booléennes configurées dans <span class="file">pgbackrest.conf</span> peuvent être réinitialisées à la valeur par défaut lors de l'appel en ligne de commande en utilisant le préfixe <span class="id">reset-</span>. Cette fonctionnalité peut être utilisée afin de restaurer une sauvegarde directement sur le serveur du dépôt. Normalement, <span class="backrest">pgBackRest</span> sera en erreur car il detectera que l'hôte de la base de données est distant et que la restauration ne peut pas être faites à distance. En ajoutant <span class="br-option">--reset-pg1-host</span> sur la ligne de commande, <span class="backrest">pgBackRest</span> ignorera l'hôte de base de données distant et restaurera localement. Il peut être nécessaire de passer un nouveau <span class="br-option">--pg-path</span> pour forcer la restauration à se faire dans un chemin spécifique, c'est-à-dire pas le chemin utilisé sur l'hôte d'instance de la base de données.<br/>
<br/>
Le préfixe <span class="id">no-</span> peut être utilisé pour définir une option booléenne à false (faux) sur la ligne de commande.<br/>
<br/>
Toute option peut être définie dans une variable d'environnement en utilisant le préfixe <span class="id">PGBACKREST_</span> et le nom de l'option en toutes lettres majuscules en remplaçant <span class="id">-</span> par <span class="id">_</span>, par exemple, <span class="br-option">pg1-path</span> devient <span class="id">PGBACKREST_PG1_PATH</span> et <span class="br-option">stanza</span> devient <span class="id">PGBACKREST_STANZA</span>. Les options booléennes sont représentées comme elles le seraient dans un fichier de configuration, par exemple <span class="id">PGBACKREST_COMPRESS="n"</span>, et les variantes <span class="id">reset-*</span> ne sont pas autorisées. Les options qui peuvent être spécifiées plusieurs fois sur la ligne de commande ou dans un fichier de configuration peuvent être représentées en séparant les valeurs par des deux points, par exemple <span class="id">PGBACKREST_DB_INCLUDE="db1:db2"</span>.<br/>
<br/>
Les options de la ligne de commande écrasent les options de l'environnement qui écrasent, elles, les options du fichier de configuration.</div><div class="section-body"></div></div><div class="section1"><a id="command-archive-get"></a><div class="section1-header"><div class="section1-number">2</div><div class="section1-title">Commande Récupération Archive (<span class="id">archive-get</span>)</div></div><div class="section-intro">Les segments WAL sont nécessaires pour restaurer une instance <span class="postgres">PostgreSQL</span> ou pour maintenir une réplication.</div><div class="section-body"><div class="section2"><a id="command-archive-get/category-command"></a><div class="section2-header"><div class="section2-number">2.1</div><div class="section2-title">Command Options</div></div><div class="section-body"><div class="section3"><a id="command-archive-get/category-command/option-archive-async"></a><div class="section3-header"><div class="section3-number">2.1.1</div><div class="section3-title">Archivage asynchrone (<span class="id">--archive-async</span>)</div></div><div class="section-body"><div class="section-body-text">Pousser et obtenir des segments WAL de manière asynchrone.</div><div class="section-body-text">Permet d'activer un fonctionnement asynchrone pour les commandes <span class="cmd">archive-push</span> et <span class="cmd">archive-get</span>.<br/>
<br/>
Le fonctionnement asynchrone est plus performant car il permet de réutiliser les connexions et de tirer parti du parallélisme. Consultez les options <span class="br-option">spool-path</span>, <span class="br-option">archive-get-queue-max</span>, et <span class="br-option">archive-push-queue-max</span> pour plus d'informations.</div><pre class="code-block">default: n
example: --archive-async</pre></div></div><div class="section3"><a id="command-archive-get/category-command/option-archive-get-queue-max"></a><div class="section3-header"><div class="section3-number">2.1.2</div><div class="section3-title">Taille maximale file d'attente récupération d'Archive (<span class="id">--archive-get-queue-max</span>)</div></div><div class="section-body"><div class="section-body-text">Taille maximale de la file d'attente <span class="backrest">pgBackRest</span> archive-get.</div><div class="section-body-text">Spécifie la taille maximale de la file d'attente <span class="cmd">archive-get</span> lorsque <span class="br-option">archive-async</span> est activée. La file d'attente est stockée sur l'emplacement définit par <span class="br-option">spool-path</span> et est utilisée pour accélérer la réception des données de WAL par <span class="postgres">PostgreSQL</span>.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB ou PB où le multiplicateur est une puissance de 1024.</div><pre class="code-block">default: 134217728
allowed: 0-4503599627370496
example: --archive-get-queue-max=1073741824</pre></div></div><div class="section3"><a id="command-archive-get/category-command/option-archive-timeout"></a><div class="section3-header"><div class="section3-number">2.1.3</div><div class="section3-title">Archive Délai d'attente (<span class="id">--archive-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente de l'archivage (archive timeout).</div><div class="section-body-text">Définit le temps maximum, en secondes, à attendre pour que chaque segment WAL atteigne le dépôt d'archives de <span class="backrest">pgBackRest</span>. Le délai s'applique aux commandes <span class="cmd">check</span> et <span class="cmd">backup</span> lorsqu'on attend que les segments WAL nécessaires à la cohérence de la sauvegarde soient archivés.</div><pre class="code-block">default: 60
allowed: 0.1-86400
example: --archive-timeout=30</pre></div></div></div></div><div class="section2"><a id="command-archive-get/category-general"></a><div class="section2-header"><div class="section2-number">2.2</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-archive-get/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">2.2.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">2.2.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number">2.2.3</div><div class="section3-title">Niveau de compression réseau (<span class="id">--compress-level-network</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de compression du réseau.</div><div class="section-body-text">Définit le niveau de compression sur le réseau, lorsque <span class="br-setting">compress-type=none</span> et que la commande n'est pas exécutée sur le même hôte que le dépôt. La compression est utilisée pour réduire le trafic réseau mais peut être désactivée en définissant <span class="br-setting">compress-level-network=0</span>. Lorsque <span class="br-setting">compress-type</span> n'est pas égal à <span class="id">none</span>, le paramètre <span class="br-setting">compress-level-network</span> est ignoré et <span class="br-setting">compress-level</span> est utilisé à la place de sorte que le fichier ne soit compressé qu'une seule fois. La compression SSH est toujours désactivée.</div><pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-config"></a><div class="section3-header"><div class="section3-number">2.2.4</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">2.2.5</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">2.2.6</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number">2.2.7</div><div class="section3-title">Timeout de la base de données (<span class="id">--db-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente des requêtes à la base de données.</div><div class="section-body-text">Définit le délai d'attente, en secondes, pour les interrogations de la base de données. Cela inclut les fonctions <span class="id">pg_start_backup()</span> et <span class="id">pg_stop_backup()</span> qui peuvent chacune prendre un temps considérable. C'est pourquoi le délai d'attente doit être maintenu à un niveau élevé, sauf si vous savez que ces fonctions retourneront rapidement (c'est-à-dire si vous avez défini <span class="br-setting">startfast=y</span> et que vous savez que l'instance de base de données ne générera pas beaucoup de segments WAL pendant la sauvegarde). <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">db-timeout</span> doit être inférieure à l'option <span class="br-option">protocol-timeout</span>.</div></div></div><pre class="code-block">default: 1800
allowed: 0.1-604800
example: --db-timeout=600</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">2.2.8</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number">2.2.9</div><div class="section3-title">Chemin fichier de verrouillage (<span class="id">--lock-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockés les fichiers de verrouillage.</div><div class="section-body-text">Le chemin de verrouillage fournit l'emplacement à <span class="backrest">pgBackRest</span> pour créer des fichiers de verrouillage afin d'éviter que des opérations en conflictuelles ne soient exécutées simultanément.</div><pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">2.2.10</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-process-max"></a><div class="section3-header"><div class="section3-number">2.2.11</div><div class="section3-title">Processus Maximum (<span class="id">--process-max</span>)</div></div><div class="section-body"><div class="section-body-text">Nombre de processus maximal lors utilisé lors de la compression et du transfert.</div><div class="section-body-text">Chaque processus effectuera une compression et un transfert pour que la commande s'exécute plus rapidement, mais ne réglez pas <span class="br-setting">process-max</span> à un niveau si élevé que cela affecte les performances de la base de données.</div><pre class="code-block">default: 1
allowed: 1-999
example: --process-max=4</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number">2.2.12</div><div class="section3-title">Délai d'attente au niveau Protocole (<span class="id">--protocol-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente du protocole.</div><div class="section-body-text">Définit le délai, en secondes, durant lequel le processus local ou distant attendra qu'un nouveau message soit reçu au niveau de la couche protocole. Cela permet d'éviter que les processus n'attendent indéfiniment un message. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">protocol-timeout</span> doit être supérieure à celle de <span class="br-option">db-timeout</span> option.</div></div></div><pre class="code-block">default: 1830
allowed: 0.1-604800
example: --protocol-timeout=630</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">2.2.13</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-spool-path"></a><div class="section3-header"><div class="section3-number">2.2.14</div><div class="section3-title">Chemin pour données transitoires (Spool) (<span class="id">--spool-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin où les données transitoires sont stockées.</div><div class="section-body-text">Ce chemin est utilisé pour stocker les données nécessaires à la commande asynchrone <span class="cmd">archive-push</span> et <span class="cmd">archive-get</span>.<br/>
<br/>
La commande asynchrone <span class="cmd">archive-push</span> enregistre des accusés de réception dans le chemin du spool lorsqu'elle a stocké avec succès le WAL dans l'archive (et des erreurs en cas d'échec) afin que le processus de premier plan puisse rapidement notifier <span class="postgres">PostgreSQL</span>. Les fichiers d'accusés de réception sont très petits (zéro octets en cas de succès et quelques centaines d'octets en cas d'erreur).<br/>
<br/>
La commande asynchrone <span class="cmd">archive-get</span> met en file d'attente le WAL dans le chemin du spool afin qu'il puisse être fourni très rapidement lorsque <span class="postgres">PostgreSQL</span> le demande. Le déplacement de fichiers vers <span class="postgres">PostgreSQL</span> est plus efficace lorsque le chemin du spool se trouve sur le même système de fichiers que <span class="path">pg_xlog</span>/<span class="path">pg_wal</span>.<br/>
<br/>
Les données stockées dans le chemin du spool ne sont pas réellement temporaires puisqu'elles peuvent et doivent survivre à un redémarrage. Cependant, la perte des données dans le chemin du spool n'est pas un problème. <span class="backrest">pgBackRest</span> va simplement revérifier chaque segment WAL pour s'assurer qu'il est bien archivé pour <span class="cmd">archive-push</span> et reconstruire la file d'attente pour <span class="cmd">archive-get</span>.<br/>
<br/>
Le chemin du spool est destiné à être situé sur un système de fichiers local compatible Posix, et non sur un système de fichiers distant tel que <span class="host">NFS</span> ou <span class="host">CIFS</span>.</div><pre class="code-block">default: /var/spool/pgbackrest
example: --spool-path=/backup/db/spool</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">2.2.15</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">2.2.16</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">2.2.17</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-archive-get/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">2.2.18</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-archive-get/category-log"></a><div class="section2-header"><div class="section2-number">2.3</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-archive-get/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">2.3.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-archive-get/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">2.3.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-archive-get/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">2.3.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-archive-get/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">2.3.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-archive-get/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">2.3.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-archive-get/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">2.3.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-archive-get/category-repository"></a><div class="section2-header"><div class="section2-number">2.4</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-archive-get/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">2.4.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number">2.4.2</div><div class="section3-title">Hôte du dépot (<span class="id">--repo-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte de dépôt dans le cas d'un fonctionnement à distance via SSH.</div><div class="section-body-text">Assurez-vous que l'authentification SSH soit correctement approuvé entre l'hôte <span class="postgres">PostgreSQL</span> et l'hôte du référentiel.<br/>
<br/>
Ce paramètre n'est pas nécessaire pour la sauvegarde et l'archivage sur un système de fichiers monté localement.</div><pre class="code-block">example: --repo1-host=repo1.domain.com</pre><div class="section-body-text">Nom obsolète: backup-host</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number">2.4.3</div><div class="section3-title">Chemin des binaires (<span class="id">--repo-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin des binaires <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Nécessaire uniquement si le chemin d'accès à <span class="file">pgbackrest</span> est différent entre les hôtes locaux et l'hote du dépôt. S'il n'est pas défini, le chemin des binaires sur l'hôte du dépôt sera le même que le chemin des binaires locaux.</div><pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: backup-cmd</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number">2.4.4</div><div class="section3-title">Emplacement du fichier de configuration (<span class="id">--repo-host-config</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du fichier de configuration <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le fichier de configuration de l'hôte du dépôt se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: backup-config</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number">2.4.5</div><div class="section3-title">Chemin d'inclusion de la configuration (<span class="id">--repo-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion <span class="backrest">pgBackRest</span> de la configuration de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin d'inclusion de la configuration de l'hôte du dépôt se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number">2.4.6</div><div class="section3-title">Chemin de configuration (<span class="id">--repo-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin de configuration de l'hôte du référentiel se trouve à un endroit différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --repo1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number">2.4.7</div><div class="section3-title">Port de l'hôte du dépôt (<span class="id">--repo-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Utilisez cette option pour spécifier un port non par défaut pour le protocole d'accès à l'hôte du dépôt. Actuellement, seul SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre><div class="section-body-text">Nom obsolète: backup-ssh-port</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number">2.4.8</div><div class="section3-title">Utilisateur de l'hôte du dépôt (<span class="id">--repo-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Définit l'utilisateur qui sera utilisé pour les opérations sur l'hôte du dépôt. De préférence, il ne s'agit pas de l'utilisateur <span class="id">postgres</span> mais plutôt d'un autre utilisateur comme <span class="id">pgbackrest</span>. Si <span class="postgres">PostgreSQL</span> fonctionne sur l'hôte du dépôt, l'utilisateur <span class="id">postgres</span> peut être placé dans le groupe <span class="id">pgbackrest</span> afin qu'il ait les autorisations de lecture sur le dépôt sans pouvoir en endommager le contenu accidentellement.</div><pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre><div class="section-body-text">Nom obsolète: backup-user</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">2.4.9</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">2.4.10</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">2.4.11</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">2.4.12</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">2.4.13</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">2.4.14</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">2.4.15</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">2.4.16</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">2.4.17</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">2.4.18</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-archive-get/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">2.4.19</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div><div class="section2"><a id="command-archive-get/category-stanza"></a><div class="section2-header"><div class="section2-number">2.5</div><div class="section2-title">Stanza Options</div></div><div class="section-body"><div class="section3"><a id="command-archive-get/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number">2.5.1</div><div class="section3-title">PostgreSQL Chemin (<span class="id">--pg-path</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="postgres">PostgreSQL</span> data directory.</div><div class="section-body-text">Ce paramètre doit être le même que le paramètre <span class="br-setting">data_directory</span> du fichier <span class="file">postgresql.conf</span>. Même si cette valeur peut être lue à partir de <span class="file">postgresql.conf</span> ou <span class="postgres">PostgreSQL</span>, il est conseillé de la définir au cas où ces ressources ne seraient pas disponibles pendant un scénario de restauration ou de sauvegarde hors ligne.<br/>
<br/>
L'option <span class="br-setting">pg-path</span> est testée par rapport à la valeur indiquée par <span class="postgres">PostgreSQL</span> à chaque sauvegarde en ligne, elle doit donc toujours être à jour.</div><pre class="code-block">example: --pg1-path=/data/db</pre><div class="section-body-text">Nom obsolète: db-path</div></div></div></div></div></div></div><div class="section1"><a id="command-archive-push"></a><div class="section1-header"><div class="section1-number">3</div><div class="section1-title">Commande Pousser Archive (<span class="id">archive-push</span>)</div></div><div class="section-intro">Un segment WAL peut être poussé immédiatement vers les archives ou stocké localement selon la valeur de <span class="br-setting">archive-async</span></div><div class="section-body"><div class="section2"><a id="command-archive-push/category-command"></a><div class="section2-header"><div class="section2-number">3.1</div><div class="section2-title">Command Options</div></div><div class="section-body"><div class="section3"><a id="command-archive-push/category-command/option-archive-async"></a><div class="section3-header"><div class="section3-number">3.1.1</div><div class="section3-title">Archivage asynchrone (<span class="id">--archive-async</span>)</div></div><div class="section-body"><div class="section-body-text">Pousser et obtenir des segments WAL de manière asynchrone.</div><div class="section-body-text">Permet d'activer un fonctionnement asynchrone pour les commandes <span class="cmd">archive-push</span> et <span class="cmd">archive-get</span>.<br/>
<br/>
Le fonctionnement asynchrone est plus performant car il permet de réutiliser les connexions et de tirer parti du parallélisme. Consultez les options <span class="br-option">spool-path</span>, <span class="br-option">archive-get-queue-max</span>, et <span class="br-option">archive-push-queue-max</span> pour plus d'informations.</div><pre class="code-block">default: n
example: --archive-async</pre></div></div><div class="section3"><a id="command-archive-push/category-command/option-archive-push-queue-max"></a><div class="section3-header"><div class="section3-number">3.1.2</div><div class="section3-title">Taille maximale de la file d'attente pour les archives (<span class="id">--archive-push-queue-max</span>)</div></div><div class="section-body"><div class="section-body-text">Taille maximale de la file d'attente <span class="postgres">PostgreSQL</span> archive..</div><div class="section-body-text">Une fois la limite atteinte, voici ce qui se produira :<br/>
<ol><li><span class="backrest">pgBackRest</span> signalera à <span class="postgres">PostgreSQL</span> que les journaux de transaction (WAL) ont été archivée avec succès, puis, <b>LES SUPPRIMES</b>.</li><li>Un avertissement sera émis dans le journal de trace de <span class="postgres">PostgreSQL</span>.</li></ol>Si cela se produit, le flux d'archives sera interrompu et le PITR ne sera plus possible au-delà de ce moment. Une nouvelle sauvegarde est alors indispensable pour retrouver la fonctionnalité de restauration complète.<br/>
<br/>
En mode asynchrone, la totalité de la file d'attente sera supprimée afin d'éviter que des flots de WAL ne passent avant que la limite de la file ne soit à nouveau dépassée.<br/>
<br/>
Le but de cette fonction est d'éviter que le disque utilisé pour le stockage du journal (pg_wal ou pg_log) ne se remplisse, ce qui entraînerait l'arrêt complet de l'instance <span class="postgres">PostgreSQL</span>. Il est peut être préférable de perdre la sauvegarde que d'avoir <span class="postgres">PostgreSQL</span> s'arrêter.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB ou PB où le multiplicateur est une puissance de 1024.</div><pre class="code-block">allowed: 0-4503599627370496
example: --archive-push-queue-max=1GB</pre><div class="section-body-text">Nom obsolète: archive-queue-max</div></div></div><div class="section3"><a id="command-archive-push/category-command/option-archive-timeout"></a><div class="section3-header"><div class="section3-number">3.1.3</div><div class="section3-title">Archive Délai d'attente (<span class="id">--archive-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente de l'archivage (archive timeout).</div><div class="section-body-text">Définit le temps maximum, en secondes, à attendre pour que chaque segment WAL atteigne le dépôt d'archives de <span class="backrest">pgBackRest</span>. Le délai s'applique aux commandes <span class="cmd">check</span> et <span class="cmd">backup</span> lorsqu'on attend que les segments WAL nécessaires à la cohérence de la sauvegarde soient archivés.</div><pre class="code-block">default: 60
allowed: 0.1-86400
example: --archive-timeout=30</pre></div></div></div></div><div class="section2"><a id="command-archive-push/category-general"></a><div class="section2-header"><div class="section2-number">3.2</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-archive-push/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">3.2.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">3.2.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-compress"></a><div class="section3-header"><div class="section3-number">3.2.3</div><div class="section3-title">Compression (<span class="id">--compress</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisez la compression de fichiers.</div><div class="section-body-text">Les fichiers de sauvegarde sont compatibles avec les outils de compression en ligne de commande.<br/>
<br/>
Cette option est désormais obsolète. L'option <span class="br-setting">compress-type</span> doit être utilisée à la place.</div><pre class="code-block">default: y
example: --no-compress</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-compress-level"></a><div class="section3-header"><div class="section3-number">3.2.4</div><div class="section3-title">Niveau de compression (<span class="id">--compress-level</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de compression des fichiers.</div><div class="section-body-text">Définit le niveau à utiliser pour la compression des fichiers lorsque <span class="br-setting">compress-type</span> n'est pas égal à <span class="id">none</span> ou <span class="br-setting">compress=y</span> (déprécié).</div><pre class="code-block">allowed: 0-9
example: --compress-level=9</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number">3.2.5</div><div class="section3-title">Niveau de compression réseau (<span class="id">--compress-level-network</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de compression du réseau.</div><div class="section-body-text">Définit le niveau de compression sur le réseau, lorsque <span class="br-setting">compress-type=none</span> et que la commande n'est pas exécutée sur le même hôte que le dépôt. La compression est utilisée pour réduire le trafic réseau mais peut être désactivée en définissant <span class="br-setting">compress-level-network=0</span>. Lorsque <span class="br-setting">compress-type</span> n'est pas égal à <span class="id">none</span>, le paramètre <span class="br-setting">compress-level-network</span> est ignoré et <span class="br-setting">compress-level</span> est utilisé à la place de sorte que le fichier ne soit compressé qu'une seule fois. La compression SSH est toujours désactivée.</div><pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-compress-type"></a><div class="section3-header"><div class="section3-number">3.2.6</div><div class="section3-title">Type de compression (<span class="id">--compress-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de compression pour les fichiers.</div><div class="section-body-text">Les types de compression suivants sont pris en charge :<br/>
<ul><li><span class="id">bz2</span> - format de compression bzip2</li><li><span class="id">gz</span> - format de compression gzip</li><li><span class="id">lz4</span> - format de compression lz4 (non disponible sur toutes les plateformes)</li><li><span class="id">zst</span> - format de compression Zstandard (non disponible sur toutes les plateformes)</li></ul></div><pre class="code-block">default: gz
example: --compress-type=n</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-config"></a><div class="section3-header"><div class="section3-number">3.2.7</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">3.2.8</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">3.2.9</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number">3.2.10</div><div class="section3-title">Timeout de la base de données (<span class="id">--db-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente des requêtes à la base de données.</div><div class="section-body-text">Définit le délai d'attente, en secondes, pour les interrogations de la base de données. Cela inclut les fonctions <span class="id">pg_start_backup()</span> et <span class="id">pg_stop_backup()</span> qui peuvent chacune prendre un temps considérable. C'est pourquoi le délai d'attente doit être maintenu à un niveau élevé, sauf si vous savez que ces fonctions retourneront rapidement (c'est-à-dire si vous avez défini <span class="br-setting">startfast=y</span> et que vous savez que l'instance de base de données ne générera pas beaucoup de segments WAL pendant la sauvegarde). <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">db-timeout</span> doit être inférieure à l'option <span class="br-option">protocol-timeout</span>.</div></div></div><pre class="code-block">default: 1800
allowed: 0.1-604800
example: --db-timeout=600</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">3.2.11</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number">3.2.12</div><div class="section3-title">Chemin fichier de verrouillage (<span class="id">--lock-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockés les fichiers de verrouillage.</div><div class="section-body-text">Le chemin de verrouillage fournit l'emplacement à <span class="backrest">pgBackRest</span> pour créer des fichiers de verrouillage afin d'éviter que des opérations en conflictuelles ne soient exécutées simultanément.</div><pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">3.2.13</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-process-max"></a><div class="section3-header"><div class="section3-number">3.2.14</div><div class="section3-title">Processus Maximum (<span class="id">--process-max</span>)</div></div><div class="section-body"><div class="section-body-text">Nombre de processus maximal lors utilisé lors de la compression et du transfert.</div><div class="section-body-text">Chaque processus effectuera une compression et un transfert pour que la commande s'exécute plus rapidement, mais ne réglez pas <span class="br-setting">process-max</span> à un niveau si élevé que cela affecte les performances de la base de données.</div><pre class="code-block">default: 1
allowed: 1-999
example: --process-max=4</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number">3.2.15</div><div class="section3-title">Délai d'attente au niveau Protocole (<span class="id">--protocol-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente du protocole.</div><div class="section-body-text">Définit le délai, en secondes, durant lequel le processus local ou distant attendra qu'un nouveau message soit reçu au niveau de la couche protocole. Cela permet d'éviter que les processus n'attendent indéfiniment un message. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">protocol-timeout</span> doit être supérieure à celle de <span class="br-option">db-timeout</span> option.</div></div></div><pre class="code-block">default: 1830
allowed: 0.1-604800
example: --protocol-timeout=630</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">3.2.16</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-spool-path"></a><div class="section3-header"><div class="section3-number">3.2.17</div><div class="section3-title">Chemin pour données transitoires (Spool) (<span class="id">--spool-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin où les données transitoires sont stockées.</div><div class="section-body-text">Ce chemin est utilisé pour stocker les données nécessaires à la commande asynchrone <span class="cmd">archive-push</span> et <span class="cmd">archive-get</span>.<br/>
<br/>
La commande asynchrone <span class="cmd">archive-push</span> enregistre des accusés de réception dans le chemin du spool lorsqu'elle a stocké avec succès le WAL dans l'archive (et des erreurs en cas d'échec) afin que le processus de premier plan puisse rapidement notifier <span class="postgres">PostgreSQL</span>. Les fichiers d'accusés de réception sont très petits (zéro octets en cas de succès et quelques centaines d'octets en cas d'erreur).<br/>
<br/>
La commande asynchrone <span class="cmd">archive-get</span> met en file d'attente le WAL dans le chemin du spool afin qu'il puisse être fourni très rapidement lorsque <span class="postgres">PostgreSQL</span> le demande. Le déplacement de fichiers vers <span class="postgres">PostgreSQL</span> est plus efficace lorsque le chemin du spool se trouve sur le même système de fichiers que <span class="path">pg_xlog</span>/<span class="path">pg_wal</span>.<br/>
<br/>
Les données stockées dans le chemin du spool ne sont pas réellement temporaires puisqu'elles peuvent et doivent survivre à un redémarrage. Cependant, la perte des données dans le chemin du spool n'est pas un problème. <span class="backrest">pgBackRest</span> va simplement revérifier chaque segment WAL pour s'assurer qu'il est bien archivé pour <span class="cmd">archive-push</span> et reconstruire la file d'attente pour <span class="cmd">archive-get</span>.<br/>
<br/>
Le chemin du spool est destiné à être situé sur un système de fichiers local compatible Posix, et non sur un système de fichiers distant tel que <span class="host">NFS</span> ou <span class="host">CIFS</span>.</div><pre class="code-block">default: /var/spool/pgbackrest
example: --spool-path=/backup/db/spool</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">3.2.18</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">3.2.19</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">3.2.20</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-archive-push/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">3.2.21</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-archive-push/category-log"></a><div class="section2-header"><div class="section2-number">3.3</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-archive-push/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">3.3.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-archive-push/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">3.3.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-archive-push/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">3.3.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-archive-push/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">3.3.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-archive-push/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">3.3.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-archive-push/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">3.3.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-archive-push/category-repository"></a><div class="section2-header"><div class="section2-number">3.4</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-archive-push/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">3.4.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number">3.4.2</div><div class="section3-title">Hôte du dépot (<span class="id">--repo-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte de dépôt dans le cas d'un fonctionnement à distance via SSH.</div><div class="section-body-text">Assurez-vous que l'authentification SSH soit correctement approuvé entre l'hôte <span class="postgres">PostgreSQL</span> et l'hôte du référentiel.<br/>
<br/>
Ce paramètre n'est pas nécessaire pour la sauvegarde et l'archivage sur un système de fichiers monté localement.</div><pre class="code-block">example: --repo1-host=repo1.domain.com</pre><div class="section-body-text">Nom obsolète: backup-host</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number">3.4.3</div><div class="section3-title">Chemin des binaires (<span class="id">--repo-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin des binaires <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Nécessaire uniquement si le chemin d'accès à <span class="file">pgbackrest</span> est différent entre les hôtes locaux et l'hote du dépôt. S'il n'est pas défini, le chemin des binaires sur l'hôte du dépôt sera le même que le chemin des binaires locaux.</div><pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: backup-cmd</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number">3.4.4</div><div class="section3-title">Emplacement du fichier de configuration (<span class="id">--repo-host-config</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du fichier de configuration <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le fichier de configuration de l'hôte du dépôt se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: backup-config</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number">3.4.5</div><div class="section3-title">Chemin d'inclusion de la configuration (<span class="id">--repo-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion <span class="backrest">pgBackRest</span> de la configuration de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin d'inclusion de la configuration de l'hôte du dépôt se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number">3.4.6</div><div class="section3-title">Chemin de configuration (<span class="id">--repo-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin de configuration de l'hôte du référentiel se trouve à un endroit différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --repo1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number">3.4.7</div><div class="section3-title">Port de l'hôte du dépôt (<span class="id">--repo-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Utilisez cette option pour spécifier un port non par défaut pour le protocole d'accès à l'hôte du dépôt. Actuellement, seul SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre><div class="section-body-text">Nom obsolète: backup-ssh-port</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number">3.4.8</div><div class="section3-title">Utilisateur de l'hôte du dépôt (<span class="id">--repo-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Définit l'utilisateur qui sera utilisé pour les opérations sur l'hôte du dépôt. De préférence, il ne s'agit pas de l'utilisateur <span class="id">postgres</span> mais plutôt d'un autre utilisateur comme <span class="id">pgbackrest</span>. Si <span class="postgres">PostgreSQL</span> fonctionne sur l'hôte du dépôt, l'utilisateur <span class="id">postgres</span> peut être placé dans le groupe <span class="id">pgbackrest</span> afin qu'il ait les autorisations de lecture sur le dépôt sans pouvoir en endommager le contenu accidentellement.</div><pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre><div class="section-body-text">Nom obsolète: backup-user</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">3.4.9</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">3.4.10</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">3.4.11</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">3.4.12</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">3.4.13</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">3.4.14</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">3.4.15</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">3.4.16</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">3.4.17</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">3.4.18</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-archive-push/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">3.4.19</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div><div class="section2"><a id="command-archive-push/category-stanza"></a><div class="section2-header"><div class="section2-number">3.5</div><div class="section2-title">Stanza Options</div></div><div class="section-body"><div class="section3"><a id="command-archive-push/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number">3.5.1</div><div class="section3-title">PostgreSQL Chemin (<span class="id">--pg-path</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="postgres">PostgreSQL</span> data directory.</div><div class="section-body-text">Ce paramètre doit être le même que le paramètre <span class="br-setting">data_directory</span> du fichier <span class="file">postgresql.conf</span>. Même si cette valeur peut être lue à partir de <span class="file">postgresql.conf</span> ou <span class="postgres">PostgreSQL</span>, il est conseillé de la définir au cas où ces ressources ne seraient pas disponibles pendant un scénario de restauration ou de sauvegarde hors ligne.<br/>
<br/>
L'option <span class="br-setting">pg-path</span> est testée par rapport à la valeur indiquée par <span class="postgres">PostgreSQL</span> à chaque sauvegarde en ligne, elle doit donc toujours être à jour.</div><pre class="code-block">example: --pg1-path=/data/db</pre><div class="section-body-text">Nom obsolète: db-path</div></div></div></div></div></div></div><div class="section1"><a id="command-backup"></a><div class="section1-header"><div class="section1-number">4</div><div class="section1-title">Commande Sauvegarde (<span class="id">backup</span>)</div></div><div class="section-intro"><span class="backrest">pgBackRest</span> n'a pas de planificateur de taches intégré, il est donc conseillé de l'exécuter à partir de cron ou d'un autre système de planification.</div><div class="section-body"><div class="section2"><a id="command-backup/category-command"></a><div class="section2-header"><div class="section2-number">4.1</div><div class="section2-title">Command Options</div></div><div class="section-body"><div class="section3"><a id="command-backup/category-command/option-archive-check"></a><div class="section3-header"><div class="section3-number">4.1.1</div><div class="section3-title">Check Archive (<span class="id">--archive-check</span>)</div></div><div class="section-body"><div class="section-body-text">Contrôle que les segments WAL se trouvent bien dans les archives à la fin du processus de sauvegarde.</div><div class="section-body-text">Contrôle que tous les segments de WAL nécessaires pour rendre la sauvegarde cohérente sont présents dans les archives de WAL. Il est conseillé de laisser ce paramètre par défaut, à moins que vous n'utilisiez une autre méthode d'archivage..<br/>
<br/>
Cette option doit être activée si <span class="br-option">archive-copy</span> est activé.</div><pre class="code-block">default: y
example: --no-archive-check</pre></div></div><div class="section3"><a id="command-backup/category-command/option-archive-copy"></a><div class="section3-header"><div class="section3-number">4.1.2</div><div class="section3-title">Copie des Archives (<span class="id">--archive-copy</span>)</div></div><div class="section-body"><div class="section-body-text">Copier tous les segments WAL nécessaires à la cohérence de la sauvegarde.</div><div class="section-body-text">Cette option un peu parano protège contre la corruption dans les archives des segments WAL en stockant les segments WAL nécessaires à la cohérence directement dans la sauvegarde. Les segments WAL sont toujours stockés dans l'archive, donc cette option utilisera de l'espace supplémentaire.<br/>
<br/>
Lors de la restauration, les segments WAL seront présents dans <span class="path">pg_xlog/pg_wal</span> et <span class="postgres">PostgreSQL</span> les utilisera de préférence plutôt que d'appeler la <span class="id">restore_command</span>.<br/>
<br/>
L'option <span class="br-option">archive-check</span> doit être activée si <span class="br-option">archive-copy</span> est activée</div><pre class="code-block">default: n
example: --archive-copy</pre></div></div><div class="section3"><a id="command-backup/category-command/option-archive-timeout"></a><div class="section3-header"><div class="section3-number">4.1.3</div><div class="section3-title">Archive Délai d'attente (<span class="id">--archive-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente de l'archivage (archive timeout).</div><div class="section-body-text">Définit le temps maximum, en secondes, à attendre pour que chaque segment WAL atteigne le dépôt d'archives de <span class="backrest">pgBackRest</span>. Le délai s'applique aux commandes <span class="cmd">check</span> et <span class="cmd">backup</span> lorsqu'on attend que les segments WAL nécessaires à la cohérence de la sauvegarde soient archivés.</div><pre class="code-block">default: 60
allowed: 0.1-86400
example: --archive-timeout=30</pre></div></div><div class="section3"><a id="command-backup/category-command/option-backup-standby"></a><div class="section3-header"><div class="section3-number">4.1.4</div><div class="section3-title">Sauvegarde à partir du secondaire (<span class="id">--backup-standby</span>)</div></div><div class="section-body"><div class="section-body-text">Sauvegarde depuis l'instance standby secondaire.</div><div class="section-body-text">Activer la sauvegarde depuis le secondaire en standby pour réduire la charge sur l'instance primaire. Cette option nécessite que les hôtes <span class="host">primary</span> (primaire) et <span class="host">standby</span> (secondaire en standby) soit correctement configurés.</div><pre class="code-block">default: n
example: --backup-standby</pre></div></div><div class="section3"><a id="command-backup/category-command/option-checksum-page"></a><div class="section3-header"><div class="section3-number">4.1.5</div><div class="section3-title">Sommes de controle des Pages (<span class="id">--checksum-page</span>)</div></div><div class="section-body"><div class="section-body-text">Validation des sommes de contrôle des pages de données (checksums).</div><div class="section-body-text">Permet à <span class="backrest">pgBackRest</span> de valider toutes les sommes de contrôle des pages de données pendant la sauvegarde de l'instance. Cette option est automatiquement activée lorsque les sommes de contrôle des pages de données sont activées sur l'instance.<br/>
<br/>
Un échec dans la validation de la somme de contrôle n'annulera pas la sauvegarde. Au contraire, des avertissements seront émis dans le journal des traces (et par défaut sur la console); la liste des pages non valides sera stockée dans le manifeste de sauvegarde.</div><pre class="code-block">example: --no-checksum-page</pre></div></div><div class="section3"><a id="command-backup/category-command/option-exclude"></a><div class="section3-header"><div class="section3-number">4.1.6</div><div class="section3-title">Exclusions Chemin/Fichier (<span class="id">--exclude</span>)</div></div><div class="section-body"><div class="section-body-text">Exclusion des chemins/fichiers de la sauvegarde..</div><div class="section-body-text">Toutes les exclusions sont relatives à <span class="path">$PGDATA</span>. Si l'exclusion se termine par / alors seuls les fichiers du répertoire spécifié seront exclus, par exemple <span class="br-option">--exclude=junk/</span> exclura tous les fichiers du répertoire <span class="path">$PGDATA/junk</span> mais inclura le répertoire lui-même. Si l'exclusion ne se termine pas par / alors le fichier peut correspondre exactement à l'exclusion ou correspondre à / apposé à l'exclusion, par exemple <span class="br-option">--exclude=junk</span> exclura le répertoire <span class="path">$PGDATA/junk</span> et tous les fichiers qu'il contient.<br/>
<br/>
<b>Soyez prudent en utilisant cette fonctionnalité : il est très rapide d'exclure quelque chose d'essentiel qui rendra la sauvegarde incohérente. Assurez-vous de tester vos restaurations ! </b><br/>
<br/>
Tous les fichiers exclus seront journalisés au niveau <span class="id">info</span> avec la règle d'exclusion.Veillez à vérifier la liste des fichiers exclus pour vous assurer que rien d'inattendu n'est exclu.<div class="admonition"><div class="note">NOTE:</div><div class="note-text">Les exclusions ne sont pas prises en compte lors des restaurations delta. Tout fichier/répertoire qui a été exclu par la sauvegarde sera <i>supprimé</i> lors de la restauration delta.</div></div>Cette option ne doit pas être utilisée pour exclure les journaux de traces <span class="postgres">PostgreSQL</span> d'une sauvegarde. Les journaux peuvent être déplacés hors du répertoire <span class="id">PGDATA</span> en utilisant le paramètre <span class="postgres">PostgreSQL</span> <span class="br-setting">log_directory</span>, ce qui présente l'avantage de permettre la préservation des journaux après une restauration.<br/>
<br/>
Les exclusions multiples peuvent être spécifiées sur la ligne de commande ou dans le fichier de configuration.</div><pre class="code-block">example: --exclude=junk/</pre></div></div><div class="section3"><a id="command-backup/category-command/option-force"></a><div class="section3-header"><div class="section3-number">4.1.7</div><div class="section3-title">Forcer (<span class="id">--force</span>)</div></div><div class="section-body"><div class="section-body-text">Forcer une sauvegarde hors ligne.</div><div class="section-body-text">Lorsqu'il est utilisé avec <span class="br-option">--no-start-stop</span> une sauvegarde sera exécutée même si <span class="backrest">pgBackRest</span> pense que <span class="postgres">PostgreSQL</span> est en cours d'exécution. <b>Cette option doit être utilisée avec une extrême prudence car elle risque d'entraîner une sauvegarde incorrecte.</b><br/>
<br/>
Il y quelques scénarios où une telle sauvegarde pourrait encore être utile dans ces conditions. Par exemple, si un serveur tombe en panne et que le volume de l'instance de base de données ne peut être monté qu'en lecture seule, il serait judicieux d'effectuer une sauvegarde même si <span class="file">postmaster.pid</span> est présent. Dans ce cas, il serait plus intéressant de revenir à la sauvegarde précédente et de rejouer le WAL, mais il est possible qu'il y ait une transaction très importante dans un segment du WAL qui n'a pas été archivé.</div><pre class="code-block">default: n
example: --force</pre></div></div><div class="section3"><a id="command-backup/category-command/option-manifest-save-threshold"></a><div class="section3-header"><div class="section3-number">4.1.8</div><div class="section3-title">Seuil sauvegarde manifeste (<span class="id">--manifest-save-threshold</span>)</div></div><div class="section-body"><div class="section-body-text">Seuil de déclenchement de la sauvegarde du manifeste lors de la sauvegarde.</div><div class="section-body-text">Définit la fréquence à laquelle le manifeste sera sauvegardé lors d'une sauvegarde. La sauvegarde du manifeste est importante car elle permet de stocker les sommes de contrôle et de faire fonctionner efficacement la fonction de reprise. Le volume réel utilisé est de 1 % de la taille de la sauvegarde ou <span class="br-setting">manifest-save-threshold</span>, la valeur la plus élevée étant retenue.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024.</div><pre class="code-block">default: 1073741824
allowed: 1-1099511627776
example: --manifest-save-threshold=5G</pre></div></div><div class="section3"><a id="command-backup/category-command/option-online"></a><div class="section3-header"><div class="section3-number">4.1.9</div><div class="section3-title">Online (<span class="id">--online</span>)</div></div><div class="section-body"><div class="section-body-text">Effectuer une sauvegarde en ligne.</div><div class="section-body-text">Le fait de spécifier --no-online empêche <span class="backrest">pgBackRest</span> de lancer <span class="id">pg_start_backup()</span> et <span class="id">pg_stop_backup()</span> sur l'instance de la base de données. Pour que --no-online fonctionne, l'instance <span class="postgres">PostgreSQL</span> doit être arrêté sinon <span class="backrest">pgBackRest</span> générera une erreur.<br/>
<br/>
L'objectif de cette option est de permettre des sauvegardes hors ligne. Le répertoire <span class="path">pg_xlog</span>/<span class="path">pg_wal</span> est copié tel quel et <span class="br-setting">archive-check</span> est automatiquement désactivé lors de la sauvegarde.</div><pre class="code-block">default: y
example: --no-online</pre></div></div><div class="section3"><a id="command-backup/category-command/option-resume"></a><div class="section3-header"><div class="section3-number">4.1.10</div><div class="section3-title">Reprise (<span class="id">--resume</span>)</div></div><div class="section-body"><div class="section-body-text">Permettre la reprise d'une sauvegarde échoué</div><div class="section-body-text">Définit si la fonctionnalité de reprise est activée. La reprise peut réduire considérablement le temps nécessaire pour exécuter une sauvegarde si une sauvegarde précédente du même type a échoué. Elle ajoute toutefois de la complexité, de sorte qu'il peut être conseillé de la désactiver dans les environnements qui n'ont pas besoin de cette fonction.</div><pre class="code-block">default: y
example: --no-resume</pre></div></div><div class="section3"><a id="command-backup/category-command/option-start-fast"></a><div class="section3-header"><div class="section3-number">4.1.11</div><div class="section3-title">Démarrage rapide (<span class="id">--start-fast</span>)</div></div><div class="section-body"><div class="section-body-text">Forcer un point de contrôle (checkpoint) pour lancer plus rapidement la sauvegarde.</div><div class="section-body-text">Force un point de contrôle (en passant le paramètre <span class="id">y</span> à <span class="id">fast</span> de <span class="id">pg_start_backup()</span>) pour que la sauvegarde commence immédiatement. Sinon, la sauvegarde commencera après le prochain point de contrôle contrôle.<br/>
<br/>
Cette fonction ne fonctionne qu'à partir de <span class="postgres">PostgreSQL</span> version >= <span class="id">8.4</span>.</div><pre class="code-block">default: n
example: --start-fast</pre></div></div><div class="section3"><a id="command-backup/category-command/option-stop-auto"></a><div class="section3-header"><div class="section3-number">4.1.12</div><div class="section3-title">Arrêt Automatique (<span class="id">--stop-auto</span>)</div></div><div class="section-body"><div class="section-body-text">Arrêt d'une sauvegarde antérieure défaillante lors la nouvelle sauvegarde.</div><div class="section-body-text">Cette opération ne sera effectuée que si un verrouillage consultatif exclusif peut être acquis afin de faire la preuve que le processus de sauvegarde antérieur ayant échoué s'est réellement arrêté.<br/>
<br/>
Cette fonctionnalité repose sur pg_is_in_backup() et ne fonctionne donc qu'avec <span class="postgres">PostgreSQL</span> >= <span class="id">9.3</span>.<br/>
<br/>
Cette fonctionnalité n'est pas prise en charge pour <span class="postgres">PostgreSQL</span> >= <span class="id">9.6</span> car les sauvegardes sont exécutées en mode non exclusif.<br/>
<br/>
Ce paramètre est désactivé par défaut car il suppose que <span class="backrest">pgBackRest</span> est le seul processus qui effectue exclusivement des sauvegardes en ligne. Il se base sur un verrou consultatif que seul <span class="backrest">pgBackRest</span> définit afin de pouvoir interrompre les autres processus qui effectuent des sauvegardes exclusives en ligne. Notez que <span class="cmd">base_backup</span> et <span class="cmd">pg_dump</span> sont sans risque avec ce paramétrage car ils n'appellent pas <span class="id">pg_start_backup()</span> et ne sont donc pas exclusifs.</div><pre class="code-block">default: n
example: --stop-auto</pre></div></div><div class="section3"><a id="command-backup/category-command/option-type"></a><div class="section3-header"><div class="section3-number">4.1.13</div><div class="section3-title">Type (<span class="id">--type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de sauvegarde.</div><div class="section-body-text">Les types de sauvegarde ci-dessous sont pris en charge:<br/>
<ul><li><span class="id">full</span> - tous les fichiers de l'instance de bases de données seront copiés et il n'y aura aucune dépendance par rapport aux sauvegardes précédentes.</li><li><span class="id">incr</span> - incrémentale basé sur la dernière sauvegarde complète réussit.</li><li><span class="id">diff</span> - comme une sauvegarde incrémentale mais toujours basée sur la dernière sauvegarde complète.</li></ul></div><pre class="code-block">default: incr
example: --type=full</pre></div></div></div></div><div class="section2"><a id="command-backup/category-general"></a><div class="section2-header"><div class="section2-number">4.2</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-backup/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">4.2.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-backup/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">4.2.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-backup/category-general/option-compress"></a><div class="section3-header"><div class="section3-number">4.2.3</div><div class="section3-title">Compression (<span class="id">--compress</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisez la compression de fichiers.</div><div class="section-body-text">Les fichiers de sauvegarde sont compatibles avec les outils de compression en ligne de commande.<br/>
<br/>
Cette option est désormais obsolète. L'option <span class="br-setting">compress-type</span> doit être utilisée à la place.</div><pre class="code-block">default: y
example: --no-compress</pre></div></div><div class="section3"><a id="command-backup/category-general/option-compress-level"></a><div class="section3-header"><div class="section3-number">4.2.4</div><div class="section3-title">Niveau de compression (<span class="id">--compress-level</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de compression des fichiers.</div><div class="section-body-text">Définit le niveau à utiliser pour la compression des fichiers lorsque <span class="br-setting">compress-type</span> n'est pas égal à <span class="id">none</span> ou <span class="br-setting">compress=y</span> (déprécié).</div><pre class="code-block">allowed: 0-9
example: --compress-level=9</pre></div></div><div class="section3"><a id="command-backup/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number">4.2.5</div><div class="section3-title">Niveau de compression réseau (<span class="id">--compress-level-network</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de compression du réseau.</div><div class="section-body-text">Définit le niveau de compression sur le réseau, lorsque <span class="br-setting">compress-type=none</span> et que la commande n'est pas exécutée sur le même hôte que le dépôt. La compression est utilisée pour réduire le trafic réseau mais peut être désactivée en définissant <span class="br-setting">compress-level-network=0</span>. Lorsque <span class="br-setting">compress-type</span> n'est pas égal à <span class="id">none</span>, le paramètre <span class="br-setting">compress-level-network</span> est ignoré et <span class="br-setting">compress-level</span> est utilisé à la place de sorte que le fichier ne soit compressé qu'une seule fois. La compression SSH est toujours désactivée.</div><pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre></div></div><div class="section3"><a id="command-backup/category-general/option-compress-type"></a><div class="section3-header"><div class="section3-number">4.2.6</div><div class="section3-title">Type de compression (<span class="id">--compress-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de compression pour les fichiers.</div><div class="section-body-text">Les types de compression suivants sont pris en charge :<br/>
<ul><li><span class="id">bz2</span> - format de compression bzip2</li><li><span class="id">gz</span> - format de compression gzip</li><li><span class="id">lz4</span> - format de compression lz4 (non disponible sur toutes les plateformes)</li><li><span class="id">zst</span> - format de compression Zstandard (non disponible sur toutes les plateformes)</li></ul></div><pre class="code-block">default: gz
example: --compress-type=n</pre></div></div><div class="section3"><a id="command-backup/category-general/option-config"></a><div class="section3-header"><div class="section3-number">4.2.7</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-backup/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">4.2.8</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-backup/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">4.2.9</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-backup/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number">4.2.10</div><div class="section3-title">Timeout de la base de données (<span class="id">--db-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente des requêtes à la base de données.</div><div class="section-body-text">Définit le délai d'attente, en secondes, pour les interrogations de la base de données. Cela inclut les fonctions <span class="id">pg_start_backup()</span> et <span class="id">pg_stop_backup()</span> qui peuvent chacune prendre un temps considérable. C'est pourquoi le délai d'attente doit être maintenu à un niveau élevé, sauf si vous savez que ces fonctions retourneront rapidement (c'est-à-dire si vous avez défini <span class="br-setting">startfast=y</span> et que vous savez que l'instance de base de données ne générera pas beaucoup de segments WAL pendant la sauvegarde). <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">db-timeout</span> doit être inférieure à l'option <span class="br-option">protocol-timeout</span>.</div></div></div><pre class="code-block">default: 1800
allowed: 0.1-604800
example: --db-timeout=600</pre></div></div><div class="section3"><a id="command-backup/category-general/option-delta"></a><div class="section3-header"><div class="section3-number">4.2.11</div><div class="section3-title">Delta (<span class="id">--delta</span>)</div></div><div class="section-body"><div class="section-body-text">Restauration ou sauvegarde à l'aide de sommes de contrôle.</div><div class="section-body-text">Lors d'une restauration, par défaut, les répertoires <span class="postgres">PostgreSQL</span> data et tablespace sont censés être présents mais vides. Cette option effectue une restauration delta en utilisant des sommes de contrôle.<br/>
<br/>
Lors d'une sauvegarde, cette option utilisera les sommes de contrôle au lieu des horodatages pour déterminer si les fichiers devront être copiés.</div><pre class="code-block">default: n
example: --delta</pre></div></div><div class="section3"><a id="command-backup/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">4.2.12</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-backup/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number">4.2.13</div><div class="section3-title">Chemin fichier de verrouillage (<span class="id">--lock-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockés les fichiers de verrouillage.</div><div class="section-body-text">Le chemin de verrouillage fournit l'emplacement à <span class="backrest">pgBackRest</span> pour créer des fichiers de verrouillage afin d'éviter que des opérations en conflictuelles ne soient exécutées simultanément.</div><pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre></div></div><div class="section3"><a id="command-backup/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">4.2.14</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-backup/category-general/option-process-max"></a><div class="section3-header"><div class="section3-number">4.2.15</div><div class="section3-title">Processus Maximum (<span class="id">--process-max</span>)</div></div><div class="section-body"><div class="section-body-text">Nombre de processus maximal lors utilisé lors de la compression et du transfert.</div><div class="section-body-text">Chaque processus effectuera une compression et un transfert pour que la commande s'exécute plus rapidement, mais ne réglez pas <span class="br-setting">process-max</span> à un niveau si élevé que cela affecte les performances de la base de données.</div><pre class="code-block">default: 1
allowed: 1-999
example: --process-max=4</pre></div></div><div class="section3"><a id="command-backup/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number">4.2.16</div><div class="section3-title">Délai d'attente au niveau Protocole (<span class="id">--protocol-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente du protocole.</div><div class="section-body-text">Définit le délai, en secondes, durant lequel le processus local ou distant attendra qu'un nouveau message soit reçu au niveau de la couche protocole. Cela permet d'éviter que les processus n'attendent indéfiniment un message. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">protocol-timeout</span> doit être supérieure à celle de <span class="br-option">db-timeout</span> option.</div></div></div><pre class="code-block">default: 1830
allowed: 0.1-604800
example: --protocol-timeout=630</pre></div></div><div class="section3"><a id="command-backup/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">4.2.17</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-backup/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">4.2.18</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-backup/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">4.2.19</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-backup/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">4.2.20</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-backup/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">4.2.21</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-backup/category-log"></a><div class="section2-header"><div class="section2-number">4.3</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-backup/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">4.3.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-backup/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">4.3.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-backup/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">4.3.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-backup/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">4.3.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-backup/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">4.3.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-backup/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">4.3.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-backup/category-repository"></a><div class="section2-header"><div class="section2-number">4.4</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-backup/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">4.4.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-hardlink"></a><div class="section3-header"><div class="section3-number">4.4.2</div><div class="section3-title">Liens physiques Dépot (<span class="id">--repo-hardlink</span>)</div></div><div class="section-body"><div class="section-body-text">Liens physiques (hardlink) des fichiers entre les sauvegardes dans le dépôt.</div><div class="section-body-text">Activation la liaison physique des fichiers dans les sauvegardes différentielles et incrémentales avec leurs sauvegardes complètes. Cela donne l'impression que chaque sauvegarde est une sauvegarde complète au niveau du système de fichiers. Attention, cependant, car la modification de fichiers liés peut affecter toutes les sauvegardes de ce jeu.</div><pre class="code-block">default: n
example: --repo1-hardlink</pre><div class="section-body-text">Nom obsolète: hardlink</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">4.4.3</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-retention-archive"></a><div class="section3-header"><div class="section3-number">4.4.4</div><div class="section3-title">Rétention d'Archive (<span class="id">--repo-retention-archive</span>)</div></div><div class="section-body"><div class="section-body-text">Nombre de sauvegardes correspondant à la valeur de WAL continue à conserver.</div><div class="section-body-text"><div class="admonition"><div class="note">NOTE:</div><div class="note-text">Les segments WAL nécessaires pour rendre une sauvegarde cohérente sont toujours conservés jusqu'à l'expiration de la sauvegarde, quelle que soit la configuration de cette option.</div></div> Si cette configuration n'est pas définie et que <span class="br-setting">repo-retention-full-type</span> est positionné sur <span class="br-setting">count</span> (valeur par défaut), alors l'expiration de l'archive sera par défaut à la valeur de <span class="br-setting">repo-retention-full</span> si <span class="br-setting">repo-retention-archive-type</span> est définit à <span class="br-setting">full</span> (ou à <span class="br-setting">repo-retention-diff</span> si <span class="br-setting">repo-retention-archive-type</span> est définit à <span class="br-setting">diff</span> ). Cela permet de garantir que le WAL n'expirera que pour les sauvegardes ayant déjà expirées. Si <span class="br-setting">repo-retention-full-type</span> est positionné sur <span class="br-setting">time</span>, avec cette valeur, par défaut, les archives qui sont antérieures à la plus ancienne sauvegarde complète conservée et satisfaisant au paramètre <span class="br-setting">repo-retention-full</span> seront supprimés.<br/>
<br/>
Cette option doit être définie si <span class="br-setting">repo-retention-archive-type</span> est positionné sur <span class="br-setting">incr</span>. Si l'espace disque est insuffisant, ce paramètre, associé à <span class="br-setting">repo-retention-archive-type</span>, peut être utilisé pour faire expirer de manière agressive les segments WAL. Toutefois, cela annule la possibilité d'effectuer un PITR à partir des sauvegardes avec les WAL expirés et donc <b>n'est pas</b> recommandé.</div><pre class="code-block">allowed: 1-9999999
example: --repo1-retention-archive=2</pre><div class="section-body-text">Nom obsolète: retention-archive</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-retention-archive-type"></a><div class="section3-header"><div class="section3-number">4.4.5</div><div class="section3-title">Type Rétention Archive (<span class="id">--repo-retention-archive-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de sauvegarde pour la conservation des journaux de transaction (WAL).</div><div class="section-body-text">Lorsque <span class="br-setting">repo-retention-archive-type</span> est positionné sur <span class="br-setting">full</span> <span class="backrest">pgBackRest</span> conservera les journaux de trasnaction (WAL) pour le nombre de sauvegardes complètes défini par <span class="br-setting">repo-retention-archive</span>. S'il est positionné sur <span class="br-setting">diff</span> (différentiel) <span class="backrest">pgBackRest</span> conservera les journaux de trasnaction (WAL) pour le nombre de sauvegardes complètes et différentielles défini par <span class="br-setting">repo-retention-archive</span>, ce qui signifie que si la dernière sauvegarde effectuée était une sauvegarde complète, elle sera comptée comme un différentiel pour les besoins de la retention du dépôt. S'il est positionné sur <span class="br-setting">incr</span> (incrémental) <span class="backrest">pgBackRest</span> conservera les journaux de trasnaction (WAL) pour le nombre de sauvegardes complètes, différentielles et incrémentielles défini par <span class="br-setting">repo-retention-archive</span>. Il est recommandé de ne pas modifier ce paramètre par rapport à la valeur par défaut : expiration que lorsque les sauvegardes complètes auront expiré.</div><pre class="code-block">default: full
example: --repo1-retention-archive-type=diff</pre><div class="section-body-text">Nom obsolète: retention-archive-type</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-retention-diff"></a><div class="section3-header"><div class="section3-number">4.4.6</div><div class="section3-title">Rétention Différentielle (<span class="id">--repo-retention-diff</span>)</div></div><div class="section-body"><div class="section-body-text">Nombre de sauvegardes différentielles à conserver.</div><div class="section-body-text">Lorsqu'une sauvegarde différentielle expire, toutes les sauvegardes incrémentales associées à la sauvegarde différentielle expirent également. Lorsqu'elles ne sont pas définies, toutes les sauvegardes différentielles seront conservées jusqu'à ce que les sauvegardes complètes dont elles dépendent expirent.</div><pre class="code-block">allowed: 1-9999999
example: --repo1-retention-diff=3</pre><div class="section-body-text">Nom obsolète: retention-diff</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-retention-full"></a><div class="section3-header"><div class="section3-number">4.4.7</div><div class="section3-title">Rétention Complète (<span class="id">--repo-retention-full</span>)</div></div><div class="section-body"><div class="section-body-text">Nombre ou temps de sauvegardes complètes à conserver.</div><div class="section-body-text">Lorsqu'une sauvegarde complète expire, toutes les sauvegardes différentielles et incrémentielles associées à la sauvegarde complète expirent également. Lorsque l'option n'est pas définie, un avertissement sera émis. Si une conservation indéfinie est souhaitée, il faut alors définir l'option à la valeur maximale.</div><pre class="code-block">allowed: 1-9999999
example: --repo1-retention-full=2</pre><div class="section-body-text">Nom obsolète: retention-full</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-retention-full-type"></a><div class="section3-header"><div class="section3-number">4.4.8</div><div class="section3-title">Type de rétention Complète (<span class="id">--repo-retention-full-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de conservation pour les sauvegardes complètes.</div><div class="section-body-text">Détermine si le paramètre <span class="br-setting">repo-retention-full</span> représente une période de temps (jours) ou le nombre de sauvegardes complètes à conserver. Si le paramètre est réglé sur <span class="br-setting">time</span> les sauvegardes complètes plus anciennes que le paramètre <span class="br-setting">repo-retention-full</span> seront supprimées du dépôt si au moins une sauvegarde est égale ou supérieure au paramètre <span class="br-setting">repo-retention-full</span>. Par exemple, si <span class="br-setting">repo-retention-full</span> est de 30 (jours) et qu'il y a 2 sauvegardes complètes : une de 25 jours et une de 35 jours, aucune sauvegarde complète n'expirera puisque l'expiration de la sauvegarde de 35 jours ne laisserait que la sauvegarde de 25 jours; ce qui violerait la politique de conservation de 30 jours : à savoir, avoir au moins une sauvegarde de 30 jours avant qu'une plus ancienne puisse expirer. Les journaux de transactions archivés (WAL) plus anciennes que la sauvegarde complète la plus ancienne restante seront automatiquement expirées, à moins que les paramètres <span class="br-setting">repo-retention-archive-type</span> et <span class="br-setting">repo-retention-archive</span> ne soient explicitement définis.</div><pre class="code-block">default: count
example: --repo1-retention-full-type=30</pre></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">4.4.9</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">4.4.10</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">4.4.11</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">4.4.12</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">4.4.13</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">4.4.14</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">4.4.15</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">4.4.16</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">4.4.17</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-backup/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">4.4.18</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div><div class="section2"><a id="command-backup/category-stanza"></a><div class="section2-header"><div class="section2-number">4.5</div><div class="section2-title">Stanza Options</div></div><div class="section-body"><div class="section3"><a id="command-backup/category-stanza/option-pg-host"></a><div class="section3-header"><div class="section3-number">4.5.1</div><div class="section3-title">Hôte PostgreSQL (<span class="id">--pg-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte <span class="postgres">PostgreSQL</span> pour les opérations à distance via SSH.</div><div class="section-body-text">Utilisé pour les sauvegardes lorsque l'hôte <span class="postgres">PostgreSQL</span> est différent de l'hôte du dépôt.</div><pre class="code-block">example: --pg1-host=db.domain.com</pre><div class="section-body-text">Nom obsolète: db-host</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-cmd"></a><div class="section3-header"><div class="section3-number">4.5.2</div><div class="section3-title">Hôte PostgreSQL Commande (<span class="id">--pg-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des exécutable <span class="backrest">pgBackRest</span> sur l'hôte <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Uniquement requis si le chemin vers <span class="file">pgbackrest</span> est différent sur le serveur local et <span class="postgres">PostgreSQL</span>. S'il n'est pas défini, le chemin de l'<span class="file">pgbackrest</span> de l'hôte de la base de données sera le même que le chemin de l'<span class="file">pgbackrest</span> local.</div><pre class="code-block">example: --pg1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: db-cmd</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-config"></a><div class="section3-header"><div class="section3-number">4.5.3</div><div class="section3-title">Hôte PostgreSQL Configuration (<span class="id">--pg-host-config</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="backrest">pgBackRest</span> database host configuration file.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le fichier de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --pg1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: db-config</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-config-include-path"></a><div class="section3-header"><div class="section3-number">4.5.4</div><div class="section3-title">Hôte PostgreSQL Chemin inclusion Configuration (<span class="id">--pg-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion de la configuration <span class="backrest">pgBackRest</span> sur l'hôte.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin d'inclusion de la configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --pg1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-config-path"></a><div class="section3-header"><div class="section3-number">4.5.5</div><div class="section3-title">Hôte PostgreSQL Chemin Configuration (<span class="id">--pg-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte de base de données.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --pg1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-port"></a><div class="section3-header"><div class="section3-number">4.5.6</div><div class="section3-title">Hôte PostgreSQL Port (<span class="id">--pg-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est configuré.</div><div class="section-body-text">Utiliser cette option pour spécifier un port non par défaut pour le protocole hôte <span class="postgres">PostgreSQL</span>. Actuellement, seul le protocole SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --pg1-host-port=25</pre><div class="section-body-text">Nom obsolète: db-ssh-port</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-host-user"></a><div class="section3-header"><div class="section3-number">4.5.7</div><div class="section3-title">Hôte PostgreSQL Utilisateur (<span class="id">--pg-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de connexion <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est défini.</div><div class="section-body-text">Cet utilisateur sera également propriétaire du processus distant <span class="backrest">pgBackRest</span> et initiera les connexions à <span class="postgres">PostgreSQL</span>. Pour que cela puisse fonctionner correctement, l'utilisateur doit être le propriétaire de l'instance de base de données <span class="postgres">PostgreSQL</span>, qui est généralement par défaut <span class="id">postgres</span>.</div><pre class="code-block">default: postgres
example: --pg1-host-user=db_owner</pre><div class="section-body-text">Nom obsolète: db-user</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number">4.5.8</div><div class="section3-title">PostgreSQL Chemin (<span class="id">--pg-path</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="postgres">PostgreSQL</span> data directory.</div><div class="section-body-text">Ce paramètre doit être le même que le paramètre <span class="br-setting">data_directory</span> du fichier <span class="file">postgresql.conf</span>. Même si cette valeur peut être lue à partir de <span class="file">postgresql.conf</span> ou <span class="postgres">PostgreSQL</span>, il est conseillé de la définir au cas où ces ressources ne seraient pas disponibles pendant un scénario de restauration ou de sauvegarde hors ligne.<br/>
<br/>
L'option <span class="br-setting">pg-path</span> est testée par rapport à la valeur indiquée par <span class="postgres">PostgreSQL</span> à chaque sauvegarde en ligne, elle doit donc toujours être à jour.</div><pre class="code-block">example: --pg1-path=/data/db</pre><div class="section-body-text">Nom obsolète: db-path</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-port"></a><div class="section3-header"><div class="section3-number">4.5.9</div><div class="section3-title">PostgreSQL Port (<span class="id">--pg-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Port sur lequel <span class="postgres">PostgreSQL</span> écoute. Il n'est généralement pas nécessaire de le préciser car la plupart des instances <span class="postgres">PostgreSQL</span> fonctionnent sur le port par défaut.</div><pre class="code-block">default: 5432
allowed: 0-65535
example: --pg1-port=6543</pre><div class="section-body-text">Nom obsolète: db-port</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-socket-path"></a><div class="section3-header"><div class="section3-number">4.5.10</div><div class="section3-title">PostgreSQL Emplacement Socket Unix (<span class="id">--pg-socket-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement socket unix <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Le répertoire de la socket unix qui a été spécifié au démarrage de <span class="postgres">PostgreSQL</span>. <span class="backrest">pgBackRest</span> trouvera automatiquement l'emplacement standard pour votre système d'exploitation, il n'est donc généralement pas nécessaire de spécifier ce paramètre, sauf si le répertoire des sockets a été explicitement modifié avec le paramètre <span class="br-setting">unix_socket_directory</span> dans <span class="file">postgresql.conf</span>.</div><pre class="code-block">allowed: 0-65535
example: --pg1-socket-path=/var/run/postgresql</pre><div class="section-body-text">Nom obsolète: db-socket-path</div></div></div><div class="section3"><a id="command-backup/category-stanza/option-pg-user"></a><div class="section3-header"><div class="section3-number">4.5.11</div><div class="section3-title">PostgreSQL Utilisateur Base de données (<span class="id">--pg-user</span>)</div></div><div class="section-body"><div class="section-body-text">Nom d'utilisateur de base de données <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Le nom d'utilisateur de la base de données utilisé lors de la connexion à <span class="postgres">PostgreSQL</span>. S'il n'est pas spécifié, <span class="backrest">pgBackRest</span> se connectera avec l'utilisateur du système d'exploitation local ou <span class="id">PGUSER</span>.</div><pre class="code-block">example: --pg1-user=backupuser</pre></div></div></div></div></div></div><div class="section1"><a id="command-check"></a><div class="section1-header"><div class="section1-number">5</div><div class="section1-title">Commande Vérification (<span class="id">check</span>)</div></div><div class="section-intro">La commande <span class="cmd">check</span> valide que <span class="backrest">pgBackRest</span> et le paramétre <span class="pg-setting">archive_command</span> sont configurés correctement pour l'archivage et les sauvegardes. Il détecte d'éventuelles erreurs de configuration, en particulier pour l'archivage. Une mauvaise configuration de l'archivage se traduit par des sauvegardes incomplètes : les segments WAL requis n'étant pas parvenus aux archives. La commande peut être exécutée sur le serveur de l'instance de la base de données ou sur le serveur du dépôt de sauvegarde. La commande peut également être exécutée sur l'hôte secondaire (standby), mais comme les commandes <span class="id">pg_switch_xlog()</span>/<span class="id">pg_switch_wal()</span> ne peut pas être exécuté sur une instance secondaire, la commande ne testera que la configuration du dépôt.<br/>
<br/>
Notez que <span class="id">pg_create_restore_point('pgBackRest Archive Check')</span> et <span class="id">pg_switch_xlog()</span>/<span class="id">pg_switch_wal()</span> sont appelés pour forcer <span class="postgres">PostgreSQL</span> à archiver un segment WAL. Les points de restauration ne sont supportés que dans <span class="postgres">PostgreSQL</span> >= 9.1; Pour les versions plus anciennes, la commande <span class="cmd">check</span> peut échouer s'il n'y a pas eu d'activité d'écriture depuis la dernière rotation du journal, il est donc recommandé que l'activité soit générée par l'utilisateur s'il n'y a pas eu d'écriture depuis le dernier changement de WAL avant l'exécution de la commande <span class="cmd">check</span></div><div class="section-body"><div class="section2"><a id="command-check/category-command"></a><div class="section2-header"><div class="section2-number">5.1</div><div class="section2-title">Command Options</div></div><div class="section-body"><div class="section3"><a id="command-check/category-command/option-archive-check"></a><div class="section3-header"><div class="section3-number">5.1.1</div><div class="section3-title">Check Archive (<span class="id">--archive-check</span>)</div></div><div class="section-body"><div class="section-body-text">Contrôle que les segments WAL se trouvent bien dans les archives à la fin du processus de sauvegarde.</div><div class="section-body-text">Contrôle que tous les segments de WAL nécessaires pour rendre la sauvegarde cohérente sont présents dans les archives de WAL. Il est conseillé de laisser ce paramètre par défaut, à moins que vous n'utilisiez une autre méthode d'archivage..<br/>
<br/>
Cette option doit être activée si <span class="br-option">archive-copy</span> est activé.</div><pre class="code-block">default: y
example: --no-archive-check</pre></div></div><div class="section3"><a id="command-check/category-command/option-archive-timeout"></a><div class="section3-header"><div class="section3-number">5.1.2</div><div class="section3-title">Archive Délai d'attente (<span class="id">--archive-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente de l'archivage (archive timeout).</div><div class="section-body-text">Définit le temps maximum, en secondes, à attendre pour que chaque segment WAL atteigne le dépôt d'archives de <span class="backrest">pgBackRest</span>. Le délai s'applique aux commandes <span class="cmd">check</span> et <span class="cmd">backup</span> lorsqu'on attend que les segments WAL nécessaires à la cohérence de la sauvegarde soient archivés.</div><pre class="code-block">default: 60
allowed: 0.1-86400
example: --archive-timeout=30</pre></div></div><div class="section3"><a id="command-check/category-command/option-backup-standby"></a><div class="section3-header"><div class="section3-number">5.1.3</div><div class="section3-title">Sauvegarde à partir du secondaire (<span class="id">--backup-standby</span>)</div></div><div class="section-body"><div class="section-body-text">Sauvegarde depuis l'instance standby secondaire.</div><div class="section-body-text">Activer la sauvegarde depuis le secondaire en standby pour réduire la charge sur l'instance primaire. Cette option nécessite que les hôtes <span class="host">primary</span> (primaire) et <span class="host">standby</span> (secondaire en standby) soit correctement configurés.</div><pre class="code-block">default: n
example: --backup-standby</pre></div></div></div></div><div class="section2"><a id="command-check/category-general"></a><div class="section2-header"><div class="section2-number">5.2</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-check/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">5.2.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-check/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">5.2.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-check/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number">5.2.3</div><div class="section3-title">Niveau de compression réseau (<span class="id">--compress-level-network</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de compression du réseau.</div><div class="section-body-text">Définit le niveau de compression sur le réseau, lorsque <span class="br-setting">compress-type=none</span> et que la commande n'est pas exécutée sur le même hôte que le dépôt. La compression est utilisée pour réduire le trafic réseau mais peut être désactivée en définissant <span class="br-setting">compress-level-network=0</span>. Lorsque <span class="br-setting">compress-type</span> n'est pas égal à <span class="id">none</span>, le paramètre <span class="br-setting">compress-level-network</span> est ignoré et <span class="br-setting">compress-level</span> est utilisé à la place de sorte que le fichier ne soit compressé qu'une seule fois. La compression SSH est toujours désactivée.</div><pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre></div></div><div class="section3"><a id="command-check/category-general/option-config"></a><div class="section3-header"><div class="section3-number">5.2.4</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-check/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">5.2.5</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-check/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">5.2.6</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-check/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number">5.2.7</div><div class="section3-title">Timeout de la base de données (<span class="id">--db-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente des requêtes à la base de données.</div><div class="section-body-text">Définit le délai d'attente, en secondes, pour les interrogations de la base de données. Cela inclut les fonctions <span class="id">pg_start_backup()</span> et <span class="id">pg_stop_backup()</span> qui peuvent chacune prendre un temps considérable. C'est pourquoi le délai d'attente doit être maintenu à un niveau élevé, sauf si vous savez que ces fonctions retourneront rapidement (c'est-à-dire si vous avez défini <span class="br-setting">startfast=y</span> et que vous savez que l'instance de base de données ne générera pas beaucoup de segments WAL pendant la sauvegarde). <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">db-timeout</span> doit être inférieure à l'option <span class="br-option">protocol-timeout</span>.</div></div></div><pre class="code-block">default: 1800
allowed: 0.1-604800
example: --db-timeout=600</pre></div></div><div class="section3"><a id="command-check/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">5.2.8</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-check/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">5.2.9</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-check/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number">5.2.10</div><div class="section3-title">Délai d'attente au niveau Protocole (<span class="id">--protocol-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente du protocole.</div><div class="section-body-text">Définit le délai, en secondes, durant lequel le processus local ou distant attendra qu'un nouveau message soit reçu au niveau de la couche protocole. Cela permet d'éviter que les processus n'attendent indéfiniment un message. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">protocol-timeout</span> doit être supérieure à celle de <span class="br-option">db-timeout</span> option.</div></div></div><pre class="code-block">default: 1830
allowed: 0.1-604800
example: --protocol-timeout=630</pre></div></div><div class="section3"><a id="command-check/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">5.2.11</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-check/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">5.2.12</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-check/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">5.2.13</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-check/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">5.2.14</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-check/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">5.2.15</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-check/category-log"></a><div class="section2-header"><div class="section2-number">5.3</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-check/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">5.3.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-check/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">5.3.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-check/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">5.3.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-check/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">5.3.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-check/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">5.3.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-check/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">5.3.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-check/category-repository"></a><div class="section2-header"><div class="section2-number">5.4</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-check/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">5.4.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-check/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number">5.4.2</div><div class="section3-title">Hôte du dépot (<span class="id">--repo-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte de dépôt dans le cas d'un fonctionnement à distance via SSH.</div><div class="section-body-text">Assurez-vous que l'authentification SSH soit correctement approuvé entre l'hôte <span class="postgres">PostgreSQL</span> et l'hôte du référentiel.<br/>
<br/>
Ce paramètre n'est pas nécessaire pour la sauvegarde et l'archivage sur un système de fichiers monté localement.</div><pre class="code-block">example: --repo1-host=repo1.domain.com</pre><div class="section-body-text">Nom obsolète: backup-host</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number">5.4.3</div><div class="section3-title">Chemin des binaires (<span class="id">--repo-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin des binaires <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Nécessaire uniquement si le chemin d'accès à <span class="file">pgbackrest</span> est différent entre les hôtes locaux et l'hote du dépôt. S'il n'est pas défini, le chemin des binaires sur l'hôte du dépôt sera le même que le chemin des binaires locaux.</div><pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: backup-cmd</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number">5.4.4</div><div class="section3-title">Emplacement du fichier de configuration (<span class="id">--repo-host-config</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du fichier de configuration <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le fichier de configuration de l'hôte du dépôt se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: backup-config</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number">5.4.5</div><div class="section3-title">Chemin d'inclusion de la configuration (<span class="id">--repo-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion <span class="backrest">pgBackRest</span> de la configuration de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin d'inclusion de la configuration de l'hôte du dépôt se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number">5.4.6</div><div class="section3-title">Chemin de configuration (<span class="id">--repo-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin de configuration de l'hôte du référentiel se trouve à un endroit différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --repo1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number">5.4.7</div><div class="section3-title">Port de l'hôte du dépôt (<span class="id">--repo-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Utilisez cette option pour spécifier un port non par défaut pour le protocole d'accès à l'hôte du dépôt. Actuellement, seul SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre><div class="section-body-text">Nom obsolète: backup-ssh-port</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number">5.4.8</div><div class="section3-title">Utilisateur de l'hôte du dépôt (<span class="id">--repo-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Définit l'utilisateur qui sera utilisé pour les opérations sur l'hôte du dépôt. De préférence, il ne s'agit pas de l'utilisateur <span class="id">postgres</span> mais plutôt d'un autre utilisateur comme <span class="id">pgbackrest</span>. Si <span class="postgres">PostgreSQL</span> fonctionne sur l'hôte du dépôt, l'utilisateur <span class="id">postgres</span> peut être placé dans le groupe <span class="id">pgbackrest</span> afin qu'il ait les autorisations de lecture sur le dépôt sans pouvoir en endommager le contenu accidentellement.</div><pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre><div class="section-body-text">Nom obsolète: backup-user</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">5.4.9</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">5.4.10</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">5.4.11</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">5.4.12</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">5.4.13</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">5.4.14</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">5.4.15</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">5.4.16</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">5.4.17</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-check/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">5.4.18</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-check/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">5.4.19</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div><div class="section2"><a id="command-check/category-stanza"></a><div class="section2-header"><div class="section2-number">5.5</div><div class="section2-title">Stanza Options</div></div><div class="section-body"><div class="section3"><a id="command-check/category-stanza/option-pg-host"></a><div class="section3-header"><div class="section3-number">5.5.1</div><div class="section3-title">Hôte PostgreSQL (<span class="id">--pg-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte <span class="postgres">PostgreSQL</span> pour les opérations à distance via SSH.</div><div class="section-body-text">Utilisé pour les sauvegardes lorsque l'hôte <span class="postgres">PostgreSQL</span> est différent de l'hôte du dépôt.</div><pre class="code-block">example: --pg1-host=db.domain.com</pre><div class="section-body-text">Nom obsolète: db-host</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-cmd"></a><div class="section3-header"><div class="section3-number">5.5.2</div><div class="section3-title">Hôte PostgreSQL Commande (<span class="id">--pg-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des exécutable <span class="backrest">pgBackRest</span> sur l'hôte <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Uniquement requis si le chemin vers <span class="file">pgbackrest</span> est différent sur le serveur local et <span class="postgres">PostgreSQL</span>. S'il n'est pas défini, le chemin de l'<span class="file">pgbackrest</span> de l'hôte de la base de données sera le même que le chemin de l'<span class="file">pgbackrest</span> local.</div><pre class="code-block">example: --pg1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: db-cmd</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-config"></a><div class="section3-header"><div class="section3-number">5.5.3</div><div class="section3-title">Hôte PostgreSQL Configuration (<span class="id">--pg-host-config</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="backrest">pgBackRest</span> database host configuration file.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le fichier de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --pg1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: db-config</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-config-include-path"></a><div class="section3-header"><div class="section3-number">5.5.4</div><div class="section3-title">Hôte PostgreSQL Chemin inclusion Configuration (<span class="id">--pg-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion de la configuration <span class="backrest">pgBackRest</span> sur l'hôte.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin d'inclusion de la configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --pg1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-config-path"></a><div class="section3-header"><div class="section3-number">5.5.5</div><div class="section3-title">Hôte PostgreSQL Chemin Configuration (<span class="id">--pg-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte de base de données.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --pg1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-port"></a><div class="section3-header"><div class="section3-number">5.5.6</div><div class="section3-title">Hôte PostgreSQL Port (<span class="id">--pg-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est configuré.</div><div class="section-body-text">Utiliser cette option pour spécifier un port non par défaut pour le protocole hôte <span class="postgres">PostgreSQL</span>. Actuellement, seul le protocole SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --pg1-host-port=25</pre><div class="section-body-text">Nom obsolète: db-ssh-port</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-host-user"></a><div class="section3-header"><div class="section3-number">5.5.7</div><div class="section3-title">Hôte PostgreSQL Utilisateur (<span class="id">--pg-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de connexion <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est défini.</div><div class="section-body-text">Cet utilisateur sera également propriétaire du processus distant <span class="backrest">pgBackRest</span> et initiera les connexions à <span class="postgres">PostgreSQL</span>. Pour que cela puisse fonctionner correctement, l'utilisateur doit être le propriétaire de l'instance de base de données <span class="postgres">PostgreSQL</span>, qui est généralement par défaut <span class="id">postgres</span>.</div><pre class="code-block">default: postgres
example: --pg1-host-user=db_owner</pre><div class="section-body-text">Nom obsolète: db-user</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number">5.5.8</div><div class="section3-title">PostgreSQL Chemin (<span class="id">--pg-path</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="postgres">PostgreSQL</span> data directory.</div><div class="section-body-text">Ce paramètre doit être le même que le paramètre <span class="br-setting">data_directory</span> du fichier <span class="file">postgresql.conf</span>. Même si cette valeur peut être lue à partir de <span class="file">postgresql.conf</span> ou <span class="postgres">PostgreSQL</span>, il est conseillé de la définir au cas où ces ressources ne seraient pas disponibles pendant un scénario de restauration ou de sauvegarde hors ligne.<br/>
<br/>
L'option <span class="br-setting">pg-path</span> est testée par rapport à la valeur indiquée par <span class="postgres">PostgreSQL</span> à chaque sauvegarde en ligne, elle doit donc toujours être à jour.</div><pre class="code-block">example: --pg1-path=/data/db</pre><div class="section-body-text">Nom obsolète: db-path</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-port"></a><div class="section3-header"><div class="section3-number">5.5.9</div><div class="section3-title">PostgreSQL Port (<span class="id">--pg-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Port sur lequel <span class="postgres">PostgreSQL</span> écoute. Il n'est généralement pas nécessaire de le préciser car la plupart des instances <span class="postgres">PostgreSQL</span> fonctionnent sur le port par défaut.</div><pre class="code-block">default: 5432
allowed: 0-65535
example: --pg1-port=6543</pre><div class="section-body-text">Nom obsolète: db-port</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-socket-path"></a><div class="section3-header"><div class="section3-number">5.5.10</div><div class="section3-title">PostgreSQL Emplacement Socket Unix (<span class="id">--pg-socket-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement socket unix <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Le répertoire de la socket unix qui a été spécifié au démarrage de <span class="postgres">PostgreSQL</span>. <span class="backrest">pgBackRest</span> trouvera automatiquement l'emplacement standard pour votre système d'exploitation, il n'est donc généralement pas nécessaire de spécifier ce paramètre, sauf si le répertoire des sockets a été explicitement modifié avec le paramètre <span class="br-setting">unix_socket_directory</span> dans <span class="file">postgresql.conf</span>.</div><pre class="code-block">allowed: 0-65535
example: --pg1-socket-path=/var/run/postgresql</pre><div class="section-body-text">Nom obsolète: db-socket-path</div></div></div><div class="section3"><a id="command-check/category-stanza/option-pg-user"></a><div class="section3-header"><div class="section3-number">5.5.11</div><div class="section3-title">PostgreSQL Utilisateur Base de données (<span class="id">--pg-user</span>)</div></div><div class="section-body"><div class="section-body-text">Nom d'utilisateur de base de données <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Le nom d'utilisateur de la base de données utilisé lors de la connexion à <span class="postgres">PostgreSQL</span>. S'il n'est pas spécifié, <span class="backrest">pgBackRest</span> se connectera avec l'utilisateur du système d'exploitation local ou <span class="id">PGUSER</span>.</div><pre class="code-block">example: --pg1-user=backupuser</pre></div></div></div></div></div></div><div class="section1"><a id="command-expire"></a><div class="section1-header"><div class="section1-number">6</div><div class="section1-title">Commande Expiration (<span class="id">expire</span>)</div></div><div class="section-intro"><span class="backrest">pgBackRest</span> effectue la rotation des sauvegardes mais ne se préoccupe pas de savoir quand les sauvegardes ont été créées. Si deux sauvegardes complètes sont configurées pour être conservées, <span class="backrest">pgBackRest</span> conservera deux sauvegardes complètes, qu'elles aient lieu à deux heures ou à deux semaines d'intervalle.</div><div class="section-body"><div class="section2"><a id="command-expire/category-command"></a><div class="section2-header"><div class="section2-number">6.1</div><div class="section2-title">Command Options</div></div><div class="section-body"><div class="section3"><a id="command-expire/category-command/option-set"></a><div class="section3-header"><div class="section3-number">6.1.1</div><div class="section3-title">Definir (<span class="id">--set</span>)</div></div><div class="section-body"><div class="section-body-text">Definir l'expiration de la sauvegarde.</div><div class="section-body-text">Le jeu de sauvegarde spécifié (c'est-à-dire l'étiquette de sauvegarde fournie et toutes ses sauvegardes dépendantes, le cas échéant) expirera quelles que soient les règles de conservation des sauvegardes, excepté qu'au moins une sauvegarde complète doit rester dans le dépôt. <div class="admonition"><div class="warning">WARNING:</div><div class="warning-text">Utilisez cette option avec une extrême prudence &mdash ; elle supprimera définitivement toutes les sauvegardes et archives non nécessaires pour effectuer une sauvegarde cohérente du dépôt de sauvegarde <span class="backrest">pgBackRest</span> pour le jeu de sauvegarde spécifié. Ce processus peut empêcher l'exécution du PITR. Si les options <span class="br-option">--repo-retention-full</span> et/ou <span class="br-option">--repo-retention-archive</span> sont configurées, alors il est conseillé de remplacer ces options en définissant leurs valeurs au maximum lors de l'exécution de la commande d'expiration.</div></div></div><pre class="code-block">example: --set=20150131-153358F_20150131-153401I</pre></div></div></div></div><div class="section2"><a id="command-expire/category-general"></a><div class="section2-header"><div class="section2-number">6.2</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-expire/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">6.2.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-expire/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">6.2.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-expire/category-general/option-config"></a><div class="section3-header"><div class="section3-number">6.2.3</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-expire/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">6.2.4</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-expire/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">6.2.5</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-expire/category-general/option-dry-run"></a><div class="section3-header"><div class="section3-number">6.2.6</div><div class="section3-title">Dry Run (<span class="id">--dry-run</span>)</div></div><div class="section-body"><div class="section-body-text">Executer une commande en mode essai (dry-run).</div><div class="section-body-text">L'option <span class="br-option">--dry-run</span> est une option utilisable uniquement en ligne de commande et peut être utilisée lorsqu'il est nécessaire de déterminer les modifications qui seront apportées par la commande sans que celle-ci n'apporte réellement de modifications.</div><pre class="code-block">default: n
example: --dry-run</pre></div></div><div class="section3"><a id="command-expire/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">6.2.7</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-expire/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number">6.2.8</div><div class="section3-title">Chemin fichier de verrouillage (<span class="id">--lock-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockés les fichiers de verrouillage.</div><div class="section-body-text">Le chemin de verrouillage fournit l'emplacement à <span class="backrest">pgBackRest</span> pour créer des fichiers de verrouillage afin d'éviter que des opérations en conflictuelles ne soient exécutées simultanément.</div><pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre></div></div><div class="section3"><a id="command-expire/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">6.2.9</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-expire/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">6.2.10</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-expire/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">6.2.11</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-expire/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">6.2.12</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-expire/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">6.2.13</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-expire/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">6.2.14</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-expire/category-log"></a><div class="section2-header"><div class="section2-number">6.3</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-expire/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">6.3.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-expire/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">6.3.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-expire/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">6.3.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-expire/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">6.3.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-expire/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">6.3.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-expire/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">6.3.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-expire/category-repository"></a><div class="section2-header"><div class="section2-number">6.4</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-expire/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">6.4.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">6.4.2</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-retention-archive"></a><div class="section3-header"><div class="section3-number">6.4.3</div><div class="section3-title">Rétention d'Archive (<span class="id">--repo-retention-archive</span>)</div></div><div class="section-body"><div class="section-body-text">Nombre de sauvegardes correspondant à la valeur de WAL continue à conserver.</div><div class="section-body-text"><div class="admonition"><div class="note">NOTE:</div><div class="note-text">Les segments WAL nécessaires pour rendre une sauvegarde cohérente sont toujours conservés jusqu'à l'expiration de la sauvegarde, quelle que soit la configuration de cette option.</div></div> Si cette configuration n'est pas définie et que <span class="br-setting">repo-retention-full-type</span> est positionné sur <span class="br-setting">count</span> (valeur par défaut), alors l'expiration de l'archive sera par défaut à la valeur de <span class="br-setting">repo-retention-full</span> si <span class="br-setting">repo-retention-archive-type</span> est définit à <span class="br-setting">full</span> (ou à <span class="br-setting">repo-retention-diff</span> si <span class="br-setting">repo-retention-archive-type</span> est définit à <span class="br-setting">diff</span> ). Cela permet de garantir que le WAL n'expirera que pour les sauvegardes ayant déjà expirées. Si <span class="br-setting">repo-retention-full-type</span> est positionné sur <span class="br-setting">time</span>, avec cette valeur, par défaut, les archives qui sont antérieures à la plus ancienne sauvegarde complète conservée et satisfaisant au paramètre <span class="br-setting">repo-retention-full</span> seront supprimés.<br/>
<br/>
Cette option doit être définie si <span class="br-setting">repo-retention-archive-type</span> est positionné sur <span class="br-setting">incr</span>. Si l'espace disque est insuffisant, ce paramètre, associé à <span class="br-setting">repo-retention-archive-type</span>, peut être utilisé pour faire expirer de manière agressive les segments WAL. Toutefois, cela annule la possibilité d'effectuer un PITR à partir des sauvegardes avec les WAL expirés et donc <b>n'est pas</b> recommandé.</div><pre class="code-block">allowed: 1-9999999
example: --repo1-retention-archive=2</pre><div class="section-body-text">Nom obsolète: retention-archive</div></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-retention-archive-type"></a><div class="section3-header"><div class="section3-number">6.4.4</div><div class="section3-title">Type Rétention Archive (<span class="id">--repo-retention-archive-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de sauvegarde pour la conservation des journaux de transaction (WAL).</div><div class="section-body-text">Lorsque <span class="br-setting">repo-retention-archive-type</span> est positionné sur <span class="br-setting">full</span> <span class="backrest">pgBackRest</span> conservera les journaux de trasnaction (WAL) pour le nombre de sauvegardes complètes défini par <span class="br-setting">repo-retention-archive</span>. S'il est positionné sur <span class="br-setting">diff</span> (différentiel) <span class="backrest">pgBackRest</span> conservera les journaux de trasnaction (WAL) pour le nombre de sauvegardes complètes et différentielles défini par <span class="br-setting">repo-retention-archive</span>, ce qui signifie que si la dernière sauvegarde effectuée était une sauvegarde complète, elle sera comptée comme un différentiel pour les besoins de la retention du dépôt. S'il est positionné sur <span class="br-setting">incr</span> (incrémental) <span class="backrest">pgBackRest</span> conservera les journaux de trasnaction (WAL) pour le nombre de sauvegardes complètes, différentielles et incrémentielles défini par <span class="br-setting">repo-retention-archive</span>. Il est recommandé de ne pas modifier ce paramètre par rapport à la valeur par défaut : expiration que lorsque les sauvegardes complètes auront expiré.</div><pre class="code-block">default: full
example: --repo1-retention-archive-type=diff</pre><div class="section-body-text">Nom obsolète: retention-archive-type</div></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-retention-diff"></a><div class="section3-header"><div class="section3-number">6.4.5</div><div class="section3-title">Rétention Différentielle (<span class="id">--repo-retention-diff</span>)</div></div><div class="section-body"><div class="section-body-text">Nombre de sauvegardes différentielles à conserver.</div><div class="section-body-text">Lorsqu'une sauvegarde différentielle expire, toutes les sauvegardes incrémentales associées à la sauvegarde différentielle expirent également. Lorsqu'elles ne sont pas définies, toutes les sauvegardes différentielles seront conservées jusqu'à ce que les sauvegardes complètes dont elles dépendent expirent.</div><pre class="code-block">allowed: 1-9999999
example: --repo1-retention-diff=3</pre><div class="section-body-text">Nom obsolète: retention-diff</div></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-retention-full"></a><div class="section3-header"><div class="section3-number">6.4.6</div><div class="section3-title">Rétention Complète (<span class="id">--repo-retention-full</span>)</div></div><div class="section-body"><div class="section-body-text">Nombre ou temps de sauvegardes complètes à conserver.</div><div class="section-body-text">Lorsqu'une sauvegarde complète expire, toutes les sauvegardes différentielles et incrémentielles associées à la sauvegarde complète expirent également. Lorsque l'option n'est pas définie, un avertissement sera émis. Si une conservation indéfinie est souhaitée, il faut alors définir l'option à la valeur maximale.</div><pre class="code-block">allowed: 1-9999999
example: --repo1-retention-full=2</pre><div class="section-body-text">Nom obsolète: retention-full</div></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-retention-full-type"></a><div class="section3-header"><div class="section3-number">6.4.7</div><div class="section3-title">Type de rétention Complète (<span class="id">--repo-retention-full-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de conservation pour les sauvegardes complètes.</div><div class="section-body-text">Détermine si le paramètre <span class="br-setting">repo-retention-full</span> représente une période de temps (jours) ou le nombre de sauvegardes complètes à conserver. Si le paramètre est réglé sur <span class="br-setting">time</span> les sauvegardes complètes plus anciennes que le paramètre <span class="br-setting">repo-retention-full</span> seront supprimées du dépôt si au moins une sauvegarde est égale ou supérieure au paramètre <span class="br-setting">repo-retention-full</span>. Par exemple, si <span class="br-setting">repo-retention-full</span> est de 30 (jours) et qu'il y a 2 sauvegardes complètes : une de 25 jours et une de 35 jours, aucune sauvegarde complète n'expirera puisque l'expiration de la sauvegarde de 35 jours ne laisserait que la sauvegarde de 25 jours; ce qui violerait la politique de conservation de 30 jours : à savoir, avoir au moins une sauvegarde de 30 jours avant qu'une plus ancienne puisse expirer. Les journaux de transactions archivés (WAL) plus anciennes que la sauvegarde complète la plus ancienne restante seront automatiquement expirées, à moins que les paramètres <span class="br-setting">repo-retention-archive-type</span> et <span class="br-setting">repo-retention-archive</span> ne soient explicitement définis.</div><pre class="code-block">default: count
example: --repo1-retention-full-type=30</pre></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">6.4.8</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">6.4.9</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">6.4.10</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">6.4.11</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">6.4.12</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">6.4.13</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">6.4.14</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">6.4.15</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">6.4.16</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-expire/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">6.4.17</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div><div class="section2"><a id="command-expire/category-stanza"></a><div class="section2-header"><div class="section2-number">6.5</div><div class="section2-title">Stanza Options</div></div><div class="section-body"><div class="section3"><a id="command-expire/category-stanza/option-pg-host"></a><div class="section3-header"><div class="section3-number">6.5.1</div><div class="section3-title">Hôte PostgreSQL (<span class="id">--pg-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte <span class="postgres">PostgreSQL</span> pour les opérations à distance via SSH.</div><div class="section-body-text">Utilisé pour les sauvegardes lorsque l'hôte <span class="postgres">PostgreSQL</span> est différent de l'hôte du dépôt.</div><pre class="code-block">example: --pg1-host=db.domain.com</pre><div class="section-body-text">Nom obsolète: db-host</div></div></div><div class="section3"><a id="command-expire/category-stanza/option-pg-host-cmd"></a><div class="section3-header"><div class="section3-number">6.5.2</div><div class="section3-title">Hôte PostgreSQL Commande (<span class="id">--pg-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des exécutable <span class="backrest">pgBackRest</span> sur l'hôte <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Uniquement requis si le chemin vers <span class="file">pgbackrest</span> est différent sur le serveur local et <span class="postgres">PostgreSQL</span>. S'il n'est pas défini, le chemin de l'<span class="file">pgbackrest</span> de l'hôte de la base de données sera le même que le chemin de l'<span class="file">pgbackrest</span> local.</div><pre class="code-block">example: --pg1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: db-cmd</div></div></div><div class="section3"><a id="command-expire/category-stanza/option-pg-host-config"></a><div class="section3-header"><div class="section3-number">6.5.3</div><div class="section3-title">Hôte PostgreSQL Configuration (<span class="id">--pg-host-config</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="backrest">pgBackRest</span> database host configuration file.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le fichier de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --pg1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: db-config</div></div></div><div class="section3"><a id="command-expire/category-stanza/option-pg-host-config-include-path"></a><div class="section3-header"><div class="section3-number">6.5.4</div><div class="section3-title">Hôte PostgreSQL Chemin inclusion Configuration (<span class="id">--pg-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion de la configuration <span class="backrest">pgBackRest</span> sur l'hôte.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin d'inclusion de la configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --pg1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-expire/category-stanza/option-pg-host-config-path"></a><div class="section3-header"><div class="section3-number">6.5.5</div><div class="section3-title">Hôte PostgreSQL Chemin Configuration (<span class="id">--pg-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte de base de données.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --pg1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-expire/category-stanza/option-pg-host-port"></a><div class="section3-header"><div class="section3-number">6.5.6</div><div class="section3-title">Hôte PostgreSQL Port (<span class="id">--pg-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est configuré.</div><div class="section-body-text">Utiliser cette option pour spécifier un port non par défaut pour le protocole hôte <span class="postgres">PostgreSQL</span>. Actuellement, seul le protocole SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --pg1-host-port=25</pre><div class="section-body-text">Nom obsolète: db-ssh-port</div></div></div><div class="section3"><a id="command-expire/category-stanza/option-pg-host-user"></a><div class="section3-header"><div class="section3-number">6.5.7</div><div class="section3-title">Hôte PostgreSQL Utilisateur (<span class="id">--pg-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de connexion <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est défini.</div><div class="section-body-text">Cet utilisateur sera également propriétaire du processus distant <span class="backrest">pgBackRest</span> et initiera les connexions à <span class="postgres">PostgreSQL</span>. Pour que cela puisse fonctionner correctement, l'utilisateur doit être le propriétaire de l'instance de base de données <span class="postgres">PostgreSQL</span>, qui est généralement par défaut <span class="id">postgres</span>.</div><pre class="code-block">default: postgres
example: --pg1-host-user=db_owner</pre><div class="section-body-text">Nom obsolète: db-user</div></div></div></div></div></div></div><div class="section1"><a id="command-help"></a><div class="section1-header"><div class="section1-number">7</div><div class="section1-title">Commande Aide (<span class="id">help</span>)</div></div><div class="section-intro">Trois niveaux d'aide sont disponible. Si aucune commande n'est spécifiée, l'aide générale sera affichée. Si une commande est spécifiée, une description complète de la commande sera affichée ainsi qu'une liste des options valides, enfin si une option est spécifiée en plus de la commande, une description complète de l'option en question s'affichera.</div><div class="section-body"></div></div><div class="section1"><a id="command-info"></a><div class="section1-header"><div class="section1-number">8</div><div class="section1-title">Commande Info (<span class="id">info</span>)</div></div><div class="section-intro">La commande <span class="cmd">info</span> fonctionne sur un ou plusieurs stanza. La sortie texte est la valeur par défaut et donne un résumé lisible par l'utilisateur des sauvegardes pour le ou les stanza demandées. Ce format est susceptible de changer à chaque version.<br/>
<br/>
Pour une sortie lisible par machine (programme), utiliser l'option <span class="br-setting">--output=json</span>. La sortie JSON contient beaucoup plus d'informations que la sortie texte; elle reste stable à chaque version, à moins qu'un bogue ne soit trouvé.</div><div class="section-body"><div class="section2"><a id="command-info/category-command"></a><div class="section2-header"><div class="section2-number">8.1</div><div class="section2-title">Command Options</div></div><div class="section-body"><div class="section3"><a id="command-info/category-command/option-output"></a><div class="section3-header"><div class="section3-number">8.1.1</div><div class="section3-title">Sortie (<span class="id">--output</span>)</div></div><div class="section-body"><div class="section-body-text">Format de sortie.</div><div class="section-body-text">Les sorties suivantes sont prises en charge:<br/>
<ul><li><span class="id">text</span> - Résumé des informations de sauvegarde lisible par l'utilisateur.</li><li><span class="id">json</span> - Informations exhaustives sur les sauvegardes au format JSON à destination de machine.</li></ul></div><pre class="code-block">default: text
example: --output=json</pre></div></div><div class="section3"><a id="command-info/category-command/option-set"></a><div class="section3-header"><div class="section3-number">8.1.2</div><div class="section3-title">Jeu (<span class="id">--set</span>)</div></div><div class="section-body"><div class="section-body-text">Détail du jeu de sauvegarde.</div><div class="section-body-text">Les détails comportent une liste des bases de données (avec leurs OID) dans le jeu de sauvegarde (à l'exclusion des bases de données modèles), les tablespaces (avec leurs OID) avec la destination où ils seront restaurés par défaut, et les liens symboliques avec la destination où ils seront restaurés lorsque <span class="br-setting">--link-all</span> est spécifié.</div><pre class="code-block">example: --set=20150131-153358F_20150131-153401I</pre></div></div></div></div><div class="section2"><a id="command-info/category-general"></a><div class="section2-header"><div class="section2-number">8.2</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-info/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">8.2.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-info/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">8.2.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-info/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number">8.2.3</div><div class="section3-title">Niveau de compression réseau (<span class="id">--compress-level-network</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de compression du réseau.</div><div class="section-body-text">Définit le niveau de compression sur le réseau, lorsque <span class="br-setting">compress-type=none</span> et que la commande n'est pas exécutée sur le même hôte que le dépôt. La compression est utilisée pour réduire le trafic réseau mais peut être désactivée en définissant <span class="br-setting">compress-level-network=0</span>. Lorsque <span class="br-setting">compress-type</span> n'est pas égal à <span class="id">none</span>, le paramètre <span class="br-setting">compress-level-network</span> est ignoré et <span class="br-setting">compress-level</span> est utilisé à la place de sorte que le fichier ne soit compressé qu'une seule fois. La compression SSH est toujours désactivée.</div><pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre></div></div><div class="section3"><a id="command-info/category-general/option-config"></a><div class="section3-header"><div class="section3-number">8.2.4</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-info/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">8.2.5</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-info/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">8.2.6</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-info/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">8.2.7</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-info/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number">8.2.8</div><div class="section3-title">Chemin fichier de verrouillage (<span class="id">--lock-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockés les fichiers de verrouillage.</div><div class="section-body-text">Le chemin de verrouillage fournit l'emplacement à <span class="backrest">pgBackRest</span> pour créer des fichiers de verrouillage afin d'éviter que des opérations en conflictuelles ne soient exécutées simultanément.</div><pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre></div></div><div class="section3"><a id="command-info/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number">8.2.9</div><div class="section3-title">Délai d'attente au niveau Protocole (<span class="id">--protocol-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente du protocole.</div><div class="section-body-text">Définit le délai, en secondes, durant lequel le processus local ou distant attendra qu'un nouveau message soit reçu au niveau de la couche protocole. Cela permet d'éviter que les processus n'attendent indéfiniment un message. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">protocol-timeout</span> doit être supérieure à celle de <span class="br-option">db-timeout</span> option.</div></div></div><pre class="code-block">default: 1830
allowed: 0.1-604800
example: --protocol-timeout=630</pre></div></div><div class="section3"><a id="command-info/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">8.2.10</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-info/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">8.2.11</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-info/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">8.2.12</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-info/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">8.2.13</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-info/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">8.2.14</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-info/category-log"></a><div class="section2-header"><div class="section2-number">8.3</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-info/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">8.3.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-info/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">8.3.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-info/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">8.3.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-info/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">8.3.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-info/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">8.3.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-info/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">8.3.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-info/category-repository"></a><div class="section2-header"><div class="section2-number">8.4</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-info/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">8.4.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-info/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number">8.4.2</div><div class="section3-title">Hôte du dépot (<span class="id">--repo-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte de dépôt dans le cas d'un fonctionnement à distance via SSH.</div><div class="section-body-text">Assurez-vous que l'authentification SSH soit correctement approuvé entre l'hôte <span class="postgres">PostgreSQL</span> et l'hôte du référentiel.<br/>
<br/>
Ce paramètre n'est pas nécessaire pour la sauvegarde et l'archivage sur un système de fichiers monté localement.</div><pre class="code-block">example: --repo1-host=repo1.domain.com</pre><div class="section-body-text">Nom obsolète: backup-host</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number">8.4.3</div><div class="section3-title">Chemin des binaires (<span class="id">--repo-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin des binaires <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Nécessaire uniquement si le chemin d'accès à <span class="file">pgbackrest</span> est différent entre les hôtes locaux et l'hote du dépôt. S'il n'est pas défini, le chemin des binaires sur l'hôte du dépôt sera le même que le chemin des binaires locaux.</div><pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: backup-cmd</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number">8.4.4</div><div class="section3-title">Emplacement du fichier de configuration (<span class="id">--repo-host-config</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du fichier de configuration <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le fichier de configuration de l'hôte du dépôt se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: backup-config</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number">8.4.5</div><div class="section3-title">Chemin d'inclusion de la configuration (<span class="id">--repo-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion <span class="backrest">pgBackRest</span> de la configuration de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin d'inclusion de la configuration de l'hôte du dépôt se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number">8.4.6</div><div class="section3-title">Chemin de configuration (<span class="id">--repo-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin de configuration de l'hôte du référentiel se trouve à un endroit différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --repo1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number">8.4.7</div><div class="section3-title">Port de l'hôte du dépôt (<span class="id">--repo-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Utilisez cette option pour spécifier un port non par défaut pour le protocole d'accès à l'hôte du dépôt. Actuellement, seul SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre><div class="section-body-text">Nom obsolète: backup-ssh-port</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number">8.4.8</div><div class="section3-title">Utilisateur de l'hôte du dépôt (<span class="id">--repo-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Définit l'utilisateur qui sera utilisé pour les opérations sur l'hôte du dépôt. De préférence, il ne s'agit pas de l'utilisateur <span class="id">postgres</span> mais plutôt d'un autre utilisateur comme <span class="id">pgbackrest</span>. Si <span class="postgres">PostgreSQL</span> fonctionne sur l'hôte du dépôt, l'utilisateur <span class="id">postgres</span> peut être placé dans le groupe <span class="id">pgbackrest</span> afin qu'il ait les autorisations de lecture sur le dépôt sans pouvoir en endommager le contenu accidentellement.</div><pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre><div class="section-body-text">Nom obsolète: backup-user</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">8.4.9</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">8.4.10</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">8.4.11</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">8.4.12</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">8.4.13</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">8.4.14</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">8.4.15</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">8.4.16</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">8.4.17</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-info/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">8.4.18</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-info/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">8.4.19</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div></div></div><div class="section1"><a id="command-repo-create"></a><div class="section1-header"><div class="section1-number">9</div><div class="section1-title">Commande Création dépôt (<span class="id">repo-create</span>)</div></div><div class="section-intro">Création du bucket si l'option <span class="br-setting">repo-type=s3</span>.<br/>
<br/>
<b>POUR UN USAGE INTERNE UNIQUEMENT. NE PAS UTILISER EN PRODUCTION.</b></div><div class="section-body"><div class="section2"><a id="command-repo-create/category-general"></a><div class="section2-header"><div class="section2-number">9.1</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-create/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">9.1.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-repo-create/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">9.1.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-repo-create/category-general/option-config"></a><div class="section3-header"><div class="section3-number">9.1.3</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-repo-create/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">9.1.4</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-repo-create/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">9.1.5</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-repo-create/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number">9.1.6</div><div class="section3-title">Timeout de la base de données (<span class="id">--db-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente des requêtes à la base de données.</div><div class="section-body-text">Définit le délai d'attente, en secondes, pour les interrogations de la base de données. Cela inclut les fonctions <span class="id">pg_start_backup()</span> et <span class="id">pg_stop_backup()</span> qui peuvent chacune prendre un temps considérable. C'est pourquoi le délai d'attente doit être maintenu à un niveau élevé, sauf si vous savez que ces fonctions retourneront rapidement (c'est-à-dire si vous avez défini <span class="br-setting">startfast=y</span> et que vous savez que l'instance de base de données ne générera pas beaucoup de segments WAL pendant la sauvegarde). <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">db-timeout</span> doit être inférieure à l'option <span class="br-option">protocol-timeout</span>.</div></div></div><pre class="code-block">default: 1800
allowed: 0.1-604800
example: --db-timeout=600</pre></div></div><div class="section3"><a id="command-repo-create/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">9.1.7</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-repo-create/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">9.1.8</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-repo-create/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number">9.1.9</div><div class="section3-title">Délai d'attente au niveau Protocole (<span class="id">--protocol-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente du protocole.</div><div class="section-body-text">Définit le délai, en secondes, durant lequel le processus local ou distant attendra qu'un nouveau message soit reçu au niveau de la couche protocole. Cela permet d'éviter que les processus n'attendent indéfiniment un message. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">protocol-timeout</span> doit être supérieure à celle de <span class="br-option">db-timeout</span> option.</div></div></div><pre class="code-block">default: 1830
allowed: 0.1-604800
example: --protocol-timeout=630</pre></div></div><div class="section3"><a id="command-repo-create/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">9.1.10</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-repo-create/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">9.1.11</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-repo-create/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">9.1.12</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-repo-create/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">9.1.13</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-repo-create/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">9.1.14</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-repo-create/category-log"></a><div class="section2-header"><div class="section2-number">9.2</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-create/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">9.2.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-repo-create/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">9.2.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-repo-create/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">9.2.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-repo-create/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">9.2.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-repo-create/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">9.2.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-repo-create/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">9.2.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-repo-create/category-repository"></a><div class="section2-header"><div class="section2-number">9.3</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-create/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">9.3.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number">9.3.2</div><div class="section3-title">Hôte du dépot (<span class="id">--repo-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte de dépôt dans le cas d'un fonctionnement à distance via SSH.</div><div class="section-body-text">Assurez-vous que l'authentification SSH soit correctement approuvé entre l'hôte <span class="postgres">PostgreSQL</span> et l'hôte du référentiel.<br/>
<br/>
Ce paramètre n'est pas nécessaire pour la sauvegarde et l'archivage sur un système de fichiers monté localement.</div><pre class="code-block">example: --repo1-host=repo1.domain.com</pre><div class="section-body-text">Nom obsolète: backup-host</div></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number">9.3.3</div><div class="section3-title">Chemin des binaires (<span class="id">--repo-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin des binaires <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Nécessaire uniquement si le chemin d'accès à <span class="file">pgbackrest</span> est différent entre les hôtes locaux et l'hote du dépôt. S'il n'est pas défini, le chemin des binaires sur l'hôte du dépôt sera le même que le chemin des binaires locaux.</div><pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: backup-cmd</div></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number">9.3.4</div><div class="section3-title">Emplacement du fichier de configuration (<span class="id">--repo-host-config</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du fichier de configuration <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le fichier de configuration de l'hôte du dépôt se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: backup-config</div></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number">9.3.5</div><div class="section3-title">Chemin d'inclusion de la configuration (<span class="id">--repo-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion <span class="backrest">pgBackRest</span> de la configuration de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin d'inclusion de la configuration de l'hôte du dépôt se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number">9.3.6</div><div class="section3-title">Chemin de configuration (<span class="id">--repo-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin de configuration de l'hôte du référentiel se trouve à un endroit différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --repo1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number">9.3.7</div><div class="section3-title">Port de l'hôte du dépôt (<span class="id">--repo-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Utilisez cette option pour spécifier un port non par défaut pour le protocole d'accès à l'hôte du dépôt. Actuellement, seul SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre><div class="section-body-text">Nom obsolète: backup-ssh-port</div></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number">9.3.8</div><div class="section3-title">Utilisateur de l'hôte du dépôt (<span class="id">--repo-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Définit l'utilisateur qui sera utilisé pour les opérations sur l'hôte du dépôt. De préférence, il ne s'agit pas de l'utilisateur <span class="id">postgres</span> mais plutôt d'un autre utilisateur comme <span class="id">pgbackrest</span>. Si <span class="postgres">PostgreSQL</span> fonctionne sur l'hôte du dépôt, l'utilisateur <span class="id">postgres</span> peut être placé dans le groupe <span class="id">pgbackrest</span> afin qu'il ait les autorisations de lecture sur le dépôt sans pouvoir en endommager le contenu accidentellement.</div><pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre><div class="section-body-text">Nom obsolète: backup-user</div></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">9.3.9</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">9.3.10</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">9.3.11</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">9.3.12</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">9.3.13</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">9.3.14</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">9.3.15</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">9.3.16</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">9.3.17</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">9.3.18</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-repo-create/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">9.3.19</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div></div></div><div class="section1"><a id="command-repo-get"></a><div class="section1-header"><div class="section1-number">10</div><div class="section1-title">Commande Obtenir un fichier du dépôt (<span class="id">repo-get</span>)</div></div><div class="section-intro">Similaire à la commande unix <span class="cmd">cat</span> mais les options sont différentes.</div><div class="section-body"><div class="section2"><a id="command-repo-get/category-command"></a><div class="section2-header"><div class="section2-number">10.1</div><div class="section2-title">Command Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-get/category-command/option-ignore-missing"></a><div class="section3-header"><div class="section3-number">10.1.1</div><div class="section3-title">Ignorer les manquants (<span class="id">--ignore-missing</span>)</div></div><div class="section-body"><div class="section-body-text">Ignorer le fichier source manquant.</div><div class="section-body-text">Se termine avec un code de sortie à 1 si le fichier source est manquant mais n'affiche pas d'erreur.</div><pre class="code-block">default: n
example: --ignore-missing</pre></div></div></div></div><div class="section2"><a id="command-repo-get/category-general"></a><div class="section2-header"><div class="section2-number">10.2</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-get/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">10.2.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">10.2.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number">10.2.3</div><div class="section3-title">Niveau de compression réseau (<span class="id">--compress-level-network</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de compression du réseau.</div><div class="section-body-text">Définit le niveau de compression sur le réseau, lorsque <span class="br-setting">compress-type=none</span> et que la commande n'est pas exécutée sur le même hôte que le dépôt. La compression est utilisée pour réduire le trafic réseau mais peut être désactivée en définissant <span class="br-setting">compress-level-network=0</span>. Lorsque <span class="br-setting">compress-type</span> n'est pas égal à <span class="id">none</span>, le paramètre <span class="br-setting">compress-level-network</span> est ignoré et <span class="br-setting">compress-level</span> est utilisé à la place de sorte que le fichier ne soit compressé qu'une seule fois. La compression SSH est toujours désactivée.</div><pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-config"></a><div class="section3-header"><div class="section3-number">10.2.4</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">10.2.5</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">10.2.6</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number">10.2.7</div><div class="section3-title">Timeout de la base de données (<span class="id">--db-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente des requêtes à la base de données.</div><div class="section-body-text">Définit le délai d'attente, en secondes, pour les interrogations de la base de données. Cela inclut les fonctions <span class="id">pg_start_backup()</span> et <span class="id">pg_stop_backup()</span> qui peuvent chacune prendre un temps considérable. C'est pourquoi le délai d'attente doit être maintenu à un niveau élevé, sauf si vous savez que ces fonctions retourneront rapidement (c'est-à-dire si vous avez défini <span class="br-setting">startfast=y</span> et que vous savez que l'instance de base de données ne générera pas beaucoup de segments WAL pendant la sauvegarde). <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">db-timeout</span> doit être inférieure à l'option <span class="br-option">protocol-timeout</span>.</div></div></div><pre class="code-block">default: 1800
allowed: 0.1-604800
example: --db-timeout=600</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">10.2.8</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">10.2.9</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number">10.2.10</div><div class="section3-title">Délai d'attente au niveau Protocole (<span class="id">--protocol-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente du protocole.</div><div class="section-body-text">Définit le délai, en secondes, durant lequel le processus local ou distant attendra qu'un nouveau message soit reçu au niveau de la couche protocole. Cela permet d'éviter que les processus n'attendent indéfiniment un message. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">protocol-timeout</span> doit être supérieure à celle de <span class="br-option">db-timeout</span> option.</div></div></div><pre class="code-block">default: 1830
allowed: 0.1-604800
example: --protocol-timeout=630</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-raw"></a><div class="section3-header"><div class="section3-number">10.2.11</div><div class="section3-title">Données brutes Raw Data (<span class="id">--raw</span>)</div></div><div class="section-body"><div class="section-body-text">Ne pas transformer les données.</div><div class="section-body-text">Ne pas transformer (c'est-à-dire crypter, décompresser, etc.) les données pour la commande en cours.</div><pre class="code-block">default: n
example: --raw</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">10.2.12</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">10.2.13</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">10.2.14</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">10.2.15</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-repo-get/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">10.2.16</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-repo-get/category-log"></a><div class="section2-header"><div class="section2-number">10.3</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-get/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">10.3.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-repo-get/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">10.3.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-repo-get/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">10.3.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-repo-get/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">10.3.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-repo-get/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">10.3.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-repo-get/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">10.3.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-repo-get/category-repository"></a><div class="section2-header"><div class="section2-number">10.4</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-get/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">10.4.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number">10.4.2</div><div class="section3-title">Hôte du dépot (<span class="id">--repo-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte de dépôt dans le cas d'un fonctionnement à distance via SSH.</div><div class="section-body-text">Assurez-vous que l'authentification SSH soit correctement approuvé entre l'hôte <span class="postgres">PostgreSQL</span> et l'hôte du référentiel.<br/>
<br/>
Ce paramètre n'est pas nécessaire pour la sauvegarde et l'archivage sur un système de fichiers monté localement.</div><pre class="code-block">example: --repo1-host=repo1.domain.com</pre><div class="section-body-text">Nom obsolète: backup-host</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number">10.4.3</div><div class="section3-title">Chemin des binaires (<span class="id">--repo-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin des binaires <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Nécessaire uniquement si le chemin d'accès à <span class="file">pgbackrest</span> est différent entre les hôtes locaux et l'hote du dépôt. S'il n'est pas défini, le chemin des binaires sur l'hôte du dépôt sera le même que le chemin des binaires locaux.</div><pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: backup-cmd</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number">10.4.4</div><div class="section3-title">Emplacement du fichier de configuration (<span class="id">--repo-host-config</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du fichier de configuration <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le fichier de configuration de l'hôte du dépôt se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: backup-config</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number">10.4.5</div><div class="section3-title">Chemin d'inclusion de la configuration (<span class="id">--repo-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion <span class="backrest">pgBackRest</span> de la configuration de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin d'inclusion de la configuration de l'hôte du dépôt se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number">10.4.6</div><div class="section3-title">Chemin de configuration (<span class="id">--repo-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin de configuration de l'hôte du référentiel se trouve à un endroit différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --repo1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number">10.4.7</div><div class="section3-title">Port de l'hôte du dépôt (<span class="id">--repo-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Utilisez cette option pour spécifier un port non par défaut pour le protocole d'accès à l'hôte du dépôt. Actuellement, seul SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre><div class="section-body-text">Nom obsolète: backup-ssh-port</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number">10.4.8</div><div class="section3-title">Utilisateur de l'hôte du dépôt (<span class="id">--repo-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Définit l'utilisateur qui sera utilisé pour les opérations sur l'hôte du dépôt. De préférence, il ne s'agit pas de l'utilisateur <span class="id">postgres</span> mais plutôt d'un autre utilisateur comme <span class="id">pgbackrest</span>. Si <span class="postgres">PostgreSQL</span> fonctionne sur l'hôte du dépôt, l'utilisateur <span class="id">postgres</span> peut être placé dans le groupe <span class="id">pgbackrest</span> afin qu'il ait les autorisations de lecture sur le dépôt sans pouvoir en endommager le contenu accidentellement.</div><pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre><div class="section-body-text">Nom obsolète: backup-user</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">10.4.9</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">10.4.10</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">10.4.11</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">10.4.12</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">10.4.13</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">10.4.14</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">10.4.15</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">10.4.16</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">10.4.17</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">10.4.18</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-repo-get/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">10.4.19</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div></div></div><div class="section1"><a id="command-repo-ls"></a><div class="section1-header"><div class="section1-number">11</div><div class="section1-title">Commande Liste des chemins/dossiers du dépôt (<span class="id">repo-ls</span>)</div></div><div class="section-intro">Similaire à la commande unix <span class="cmd">ls</span> mais les options et la sortie sont différentes. Seules les informations fournies par les pilotes de stockage du référentiel sont disponibles : <span class="id">name</span> (nom), <span class="id">type</span>(type), <span class="id">size</span> (taille), <span class="id">time</span> (date de modification), et <span class="id">destination</span> (destination sur les système prennent en charge les liens).</div><div class="section-body"><div class="section2"><a id="command-repo-ls/category-command"></a><div class="section2-header"><div class="section2-number">11.1</div><div class="section2-title">Command Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-ls/category-command/option-filter"></a><div class="section3-header"><div class="section3-number">11.1.1</div><div class="section3-title">Filtre de sortie (<span class="id">--filter</span>)</div></div><div class="section-body"><div class="section-body-text">Filtrer la sortie avec une expression régulière.</div><div class="section-body-text">Le filtre est appliqué sur les noms de fichiers/chemins d'accès avant l'affichage sur la sortie.</div><pre class="code-block">example: --filter=(F|D|I)$</pre></div></div><div class="section3"><a id="command-repo-ls/category-command/option-output"></a><div class="section3-header"><div class="section3-number">11.1.2</div><div class="section3-title">Sortie (<span class="id">--output</span>)</div></div><div class="section-body"><div class="section-body-text">Format de sortie.</div><div class="section-body-text">Les types de sortie suivants sont pris en charge:<br/>
<ul><li><span class="id">text</span> - Liste simple avec un nom de fichier/lien/chemin sur chaque ligne.</li><li><span class="id">json</span> - Informations détaillées sur les fichier/lien/dossier au format JSON.</li></ul></div><pre class="code-block">default: text
example: --output=json</pre></div></div><div class="section3"><a id="command-repo-ls/category-command/option-recurse"></a><div class="section3-header"><div class="section3-number">11.1.3</div><div class="section3-title">Récursivité des sous-chemins (<span class="id">--recurse</span>)</div></div><div class="section-body"><div class="section-body-text">Inclure tous les sous-chemins dans la sortie.</div><div class="section-body-text">Tous les sous-chemins et leurs fichiers seront inclus dans le résultat.</div><pre class="code-block">default: n
example: --recurse</pre></div></div><div class="section3"><a id="command-repo-ls/category-command/option-sort"></a><div class="section3-header"><div class="section3-number">11.1.4</div><div class="section3-title">Tri de sortie (<span class="id">--sort</span>)</div></div><div class="section-body"><div class="section-body-text">Trier la sortie par ordre croissant, décroissant ou aucun.</div><div class="section-body-text">Les types de tri suivants sont pris en charge:<br/>
<ul><li><span class="id">asc</span> - tri croissant.</li><li><span class="id">desc</span> - tri décroissant.</li><li><span class="id">none</span> - pas de tri.</li></ul></div><pre class="code-block">default: asc
example: --sort=desc</pre></div></div></div></div><div class="section2"><a id="command-repo-ls/category-general"></a><div class="section2-header"><div class="section2-number">11.2</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-ls/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">11.2.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-repo-ls/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">11.2.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-repo-ls/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number">11.2.3</div><div class="section3-title">Niveau de compression réseau (<span class="id">--compress-level-network</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de compression du réseau.</div><div class="section-body-text">Définit le niveau de compression sur le réseau, lorsque <span class="br-setting">compress-type=none</span> et que la commande n'est pas exécutée sur le même hôte que le dépôt. La compression est utilisée pour réduire le trafic réseau mais peut être désactivée en définissant <span class="br-setting">compress-level-network=0</span>. Lorsque <span class="br-setting">compress-type</span> n'est pas égal à <span class="id">none</span>, le paramètre <span class="br-setting">compress-level-network</span> est ignoré et <span class="br-setting">compress-level</span> est utilisé à la place de sorte que le fichier ne soit compressé qu'une seule fois. La compression SSH est toujours désactivée.</div><pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre></div></div><div class="section3"><a id="command-repo-ls/category-general/option-config"></a><div class="section3-header"><div class="section3-number">11.2.4</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-repo-ls/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">11.2.5</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-repo-ls/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">11.2.6</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-repo-ls/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number">11.2.7</div><div class="section3-title">Timeout de la base de données (<span class="id">--db-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente des requêtes à la base de données.</div><div class="section-body-text">Définit le délai d'attente, en secondes, pour les interrogations de la base de données. Cela inclut les fonctions <span class="id">pg_start_backup()</span> et <span class="id">pg_stop_backup()</span> qui peuvent chacune prendre un temps considérable. C'est pourquoi le délai d'attente doit être maintenu à un niveau élevé, sauf si vous savez que ces fonctions retourneront rapidement (c'est-à-dire si vous avez défini <span class="br-setting">startfast=y</span> et que vous savez que l'instance de base de données ne générera pas beaucoup de segments WAL pendant la sauvegarde). <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">db-timeout</span> doit être inférieure à l'option <span class="br-option">protocol-timeout</span>.</div></div></div><pre class="code-block">default: 1800
allowed: 0.1-604800
example: --db-timeout=600</pre></div></div><div class="section3"><a id="command-repo-ls/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">11.2.8</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-repo-ls/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">11.2.9</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-repo-ls/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number">11.2.10</div><div class="section3-title">Délai d'attente au niveau Protocole (<span class="id">--protocol-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente du protocole.</div><div class="section-body-text">Définit le délai, en secondes, durant lequel le processus local ou distant attendra qu'un nouveau message soit reçu au niveau de la couche protocole. Cela permet d'éviter que les processus n'attendent indéfiniment un message. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">protocol-timeout</span> doit être supérieure à celle de <span class="br-option">db-timeout</span> option.</div></div></div><pre class="code-block">default: 1830
allowed: 0.1-604800
example: --protocol-timeout=630</pre></div></div><div class="section3"><a id="command-repo-ls/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">11.2.11</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-repo-ls/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">11.2.12</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-repo-ls/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">11.2.13</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-repo-ls/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">11.2.14</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-repo-ls/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">11.2.15</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-repo-ls/category-log"></a><div class="section2-header"><div class="section2-number">11.3</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-ls/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">11.3.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-repo-ls/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">11.3.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-repo-ls/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">11.3.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-repo-ls/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">11.3.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-repo-ls/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">11.3.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-repo-ls/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">11.3.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-repo-ls/category-repository"></a><div class="section2-header"><div class="section2-number">11.4</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-ls/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">11.4.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number">11.4.2</div><div class="section3-title">Hôte du dépot (<span class="id">--repo-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte de dépôt dans le cas d'un fonctionnement à distance via SSH.</div><div class="section-body-text">Assurez-vous que l'authentification SSH soit correctement approuvé entre l'hôte <span class="postgres">PostgreSQL</span> et l'hôte du référentiel.<br/>
<br/>
Ce paramètre n'est pas nécessaire pour la sauvegarde et l'archivage sur un système de fichiers monté localement.</div><pre class="code-block">example: --repo1-host=repo1.domain.com</pre><div class="section-body-text">Nom obsolète: backup-host</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number">11.4.3</div><div class="section3-title">Chemin des binaires (<span class="id">--repo-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin des binaires <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Nécessaire uniquement si le chemin d'accès à <span class="file">pgbackrest</span> est différent entre les hôtes locaux et l'hote du dépôt. S'il n'est pas défini, le chemin des binaires sur l'hôte du dépôt sera le même que le chemin des binaires locaux.</div><pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: backup-cmd</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number">11.4.4</div><div class="section3-title">Emplacement du fichier de configuration (<span class="id">--repo-host-config</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du fichier de configuration <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le fichier de configuration de l'hôte du dépôt se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: backup-config</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number">11.4.5</div><div class="section3-title">Chemin d'inclusion de la configuration (<span class="id">--repo-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion <span class="backrest">pgBackRest</span> de la configuration de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin d'inclusion de la configuration de l'hôte du dépôt se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number">11.4.6</div><div class="section3-title">Chemin de configuration (<span class="id">--repo-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin de configuration de l'hôte du référentiel se trouve à un endroit différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --repo1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number">11.4.7</div><div class="section3-title">Port de l'hôte du dépôt (<span class="id">--repo-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Utilisez cette option pour spécifier un port non par défaut pour le protocole d'accès à l'hôte du dépôt. Actuellement, seul SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre><div class="section-body-text">Nom obsolète: backup-ssh-port</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number">11.4.8</div><div class="section3-title">Utilisateur de l'hôte du dépôt (<span class="id">--repo-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Définit l'utilisateur qui sera utilisé pour les opérations sur l'hôte du dépôt. De préférence, il ne s'agit pas de l'utilisateur <span class="id">postgres</span> mais plutôt d'un autre utilisateur comme <span class="id">pgbackrest</span>. Si <span class="postgres">PostgreSQL</span> fonctionne sur l'hôte du dépôt, l'utilisateur <span class="id">postgres</span> peut être placé dans le groupe <span class="id">pgbackrest</span> afin qu'il ait les autorisations de lecture sur le dépôt sans pouvoir en endommager le contenu accidentellement.</div><pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre><div class="section-body-text">Nom obsolète: backup-user</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">11.4.9</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">11.4.10</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">11.4.11</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">11.4.12</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">11.4.13</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">11.4.14</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">11.4.15</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">11.4.16</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">11.4.17</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">11.4.18</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-repo-ls/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">11.4.19</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div></div></div><div class="section1"><a id="command-repo-put"></a><div class="section1-header"><div class="section1-number">12</div><div class="section1-title">Commande Déposer un ficher (<span class="id">repo-put</span>)</div></div><div class="section-intro">Similaire à la commande unix <span class="cmd">tee</span> mais avec des options différentes.<br/>
<br/>
<b>POUR UN USAGE INTERNE UNIQUEMENT. NE PAS UTILISER EN PRODUCTION.</b></div><div class="section-body"><div class="section2"><a id="command-repo-put/category-general"></a><div class="section2-header"><div class="section2-number">12.1</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-put/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">12.1.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">12.1.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number">12.1.3</div><div class="section3-title">Niveau de compression réseau (<span class="id">--compress-level-network</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de compression du réseau.</div><div class="section-body-text">Définit le niveau de compression sur le réseau, lorsque <span class="br-setting">compress-type=none</span> et que la commande n'est pas exécutée sur le même hôte que le dépôt. La compression est utilisée pour réduire le trafic réseau mais peut être désactivée en définissant <span class="br-setting">compress-level-network=0</span>. Lorsque <span class="br-setting">compress-type</span> n'est pas égal à <span class="id">none</span>, le paramètre <span class="br-setting">compress-level-network</span> est ignoré et <span class="br-setting">compress-level</span> est utilisé à la place de sorte que le fichier ne soit compressé qu'une seule fois. La compression SSH est toujours désactivée.</div><pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-config"></a><div class="section3-header"><div class="section3-number">12.1.4</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">12.1.5</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">12.1.6</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number">12.1.7</div><div class="section3-title">Timeout de la base de données (<span class="id">--db-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente des requêtes à la base de données.</div><div class="section-body-text">Définit le délai d'attente, en secondes, pour les interrogations de la base de données. Cela inclut les fonctions <span class="id">pg_start_backup()</span> et <span class="id">pg_stop_backup()</span> qui peuvent chacune prendre un temps considérable. C'est pourquoi le délai d'attente doit être maintenu à un niveau élevé, sauf si vous savez que ces fonctions retourneront rapidement (c'est-à-dire si vous avez défini <span class="br-setting">startfast=y</span> et que vous savez que l'instance de base de données ne générera pas beaucoup de segments WAL pendant la sauvegarde). <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">db-timeout</span> doit être inférieure à l'option <span class="br-option">protocol-timeout</span>.</div></div></div><pre class="code-block">default: 1800
allowed: 0.1-604800
example: --db-timeout=600</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">12.1.8</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">12.1.9</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number">12.1.10</div><div class="section3-title">Délai d'attente au niveau Protocole (<span class="id">--protocol-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente du protocole.</div><div class="section-body-text">Définit le délai, en secondes, durant lequel le processus local ou distant attendra qu'un nouveau message soit reçu au niveau de la couche protocole. Cela permet d'éviter que les processus n'attendent indéfiniment un message. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">protocol-timeout</span> doit être supérieure à celle de <span class="br-option">db-timeout</span> option.</div></div></div><pre class="code-block">default: 1830
allowed: 0.1-604800
example: --protocol-timeout=630</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-raw"></a><div class="section3-header"><div class="section3-number">12.1.11</div><div class="section3-title">Données brutes Raw Data (<span class="id">--raw</span>)</div></div><div class="section-body"><div class="section-body-text">Ne pas transformer les données.</div><div class="section-body-text">Ne pas transformer (c'est-à-dire crypter, décompresser, etc.) les données pour la commande en cours.</div><pre class="code-block">default: n
example: --raw</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">12.1.12</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">12.1.13</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">12.1.14</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">12.1.15</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-repo-put/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">12.1.16</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-repo-put/category-log"></a><div class="section2-header"><div class="section2-number">12.2</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-put/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">12.2.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-repo-put/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">12.2.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-repo-put/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">12.2.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-repo-put/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">12.2.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-repo-put/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">12.2.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-repo-put/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">12.2.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-repo-put/category-repository"></a><div class="section2-header"><div class="section2-number">12.3</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-put/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">12.3.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number">12.3.2</div><div class="section3-title">Hôte du dépot (<span class="id">--repo-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte de dépôt dans le cas d'un fonctionnement à distance via SSH.</div><div class="section-body-text">Assurez-vous que l'authentification SSH soit correctement approuvé entre l'hôte <span class="postgres">PostgreSQL</span> et l'hôte du référentiel.<br/>
<br/>
Ce paramètre n'est pas nécessaire pour la sauvegarde et l'archivage sur un système de fichiers monté localement.</div><pre class="code-block">example: --repo1-host=repo1.domain.com</pre><div class="section-body-text">Nom obsolète: backup-host</div></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number">12.3.3</div><div class="section3-title">Chemin des binaires (<span class="id">--repo-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin des binaires <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Nécessaire uniquement si le chemin d'accès à <span class="file">pgbackrest</span> est différent entre les hôtes locaux et l'hote du dépôt. S'il n'est pas défini, le chemin des binaires sur l'hôte du dépôt sera le même que le chemin des binaires locaux.</div><pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: backup-cmd</div></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number">12.3.4</div><div class="section3-title">Emplacement du fichier de configuration (<span class="id">--repo-host-config</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du fichier de configuration <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le fichier de configuration de l'hôte du dépôt se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: backup-config</div></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number">12.3.5</div><div class="section3-title">Chemin d'inclusion de la configuration (<span class="id">--repo-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion <span class="backrest">pgBackRest</span> de la configuration de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin d'inclusion de la configuration de l'hôte du dépôt se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number">12.3.6</div><div class="section3-title">Chemin de configuration (<span class="id">--repo-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin de configuration de l'hôte du référentiel se trouve à un endroit différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --repo1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number">12.3.7</div><div class="section3-title">Port de l'hôte du dépôt (<span class="id">--repo-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Utilisez cette option pour spécifier un port non par défaut pour le protocole d'accès à l'hôte du dépôt. Actuellement, seul SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre><div class="section-body-text">Nom obsolète: backup-ssh-port</div></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number">12.3.8</div><div class="section3-title">Utilisateur de l'hôte du dépôt (<span class="id">--repo-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Définit l'utilisateur qui sera utilisé pour les opérations sur l'hôte du dépôt. De préférence, il ne s'agit pas de l'utilisateur <span class="id">postgres</span> mais plutôt d'un autre utilisateur comme <span class="id">pgbackrest</span>. Si <span class="postgres">PostgreSQL</span> fonctionne sur l'hôte du dépôt, l'utilisateur <span class="id">postgres</span> peut être placé dans le groupe <span class="id">pgbackrest</span> afin qu'il ait les autorisations de lecture sur le dépôt sans pouvoir en endommager le contenu accidentellement.</div><pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre><div class="section-body-text">Nom obsolète: backup-user</div></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">12.3.9</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">12.3.10</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">12.3.11</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">12.3.12</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">12.3.13</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">12.3.14</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">12.3.15</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">12.3.16</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">12.3.17</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">12.3.18</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-repo-put/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">12.3.19</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div></div></div><div class="section1"><a id="command-repo-rm"></a><div class="section1-header"><div class="section1-number">13</div><div class="section1-title">Commande Supprimer les chemins/dossiers du dépôt (<span class="id">repo-rm</span>)</div></div><div class="section-intro">Similaire à la commande unix <span class="cmd">rm</span> mais avec des options différentes.<br/>
<br/>
<b>POUR UN USAGE INTERNE UNIQUEMENT. NE PAS UTILISER EN PRODUCTION.</b></div><div class="section-body"><div class="section2"><a id="command-repo-rm/category-command"></a><div class="section2-header"><div class="section2-number">13.1</div><div class="section2-title">Command Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-rm/category-command/option-recurse"></a><div class="section3-header"><div class="section3-number">13.1.1</div><div class="section3-title">Récursivité des sous-chemins (<span class="id">--recurse</span>)</div></div><div class="section-body"><div class="section-body-text">Supprimer tous les sous-fichiers/répertoire</div><div class="section-body-text">Tous les sous-chemins et leurs fichiers seront supprimés.</div><pre class="code-block">default: n
example: --recurse</pre></div></div></div></div><div class="section2"><a id="command-repo-rm/category-general"></a><div class="section2-header"><div class="section2-number">13.2</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-rm/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">13.2.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-repo-rm/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">13.2.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-repo-rm/category-general/option-config"></a><div class="section3-header"><div class="section3-number">13.2.3</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-repo-rm/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">13.2.4</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-repo-rm/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">13.2.5</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-repo-rm/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number">13.2.6</div><div class="section3-title">Timeout de la base de données (<span class="id">--db-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente des requêtes à la base de données.</div><div class="section-body-text">Définit le délai d'attente, en secondes, pour les interrogations de la base de données. Cela inclut les fonctions <span class="id">pg_start_backup()</span> et <span class="id">pg_stop_backup()</span> qui peuvent chacune prendre un temps considérable. C'est pourquoi le délai d'attente doit être maintenu à un niveau élevé, sauf si vous savez que ces fonctions retourneront rapidement (c'est-à-dire si vous avez défini <span class="br-setting">startfast=y</span> et que vous savez que l'instance de base de données ne générera pas beaucoup de segments WAL pendant la sauvegarde). <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">db-timeout</span> doit être inférieure à l'option <span class="br-option">protocol-timeout</span>.</div></div></div><pre class="code-block">default: 1800
allowed: 0.1-604800
example: --db-timeout=600</pre></div></div><div class="section3"><a id="command-repo-rm/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">13.2.7</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-repo-rm/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">13.2.8</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-repo-rm/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number">13.2.9</div><div class="section3-title">Délai d'attente au niveau Protocole (<span class="id">--protocol-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente du protocole.</div><div class="section-body-text">Définit le délai, en secondes, durant lequel le processus local ou distant attendra qu'un nouveau message soit reçu au niveau de la couche protocole. Cela permet d'éviter que les processus n'attendent indéfiniment un message. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">protocol-timeout</span> doit être supérieure à celle de <span class="br-option">db-timeout</span> option.</div></div></div><pre class="code-block">default: 1830
allowed: 0.1-604800
example: --protocol-timeout=630</pre></div></div><div class="section3"><a id="command-repo-rm/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">13.2.10</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-repo-rm/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">13.2.11</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-repo-rm/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">13.2.12</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-repo-rm/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">13.2.13</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-repo-rm/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">13.2.14</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-repo-rm/category-log"></a><div class="section2-header"><div class="section2-number">13.3</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-rm/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">13.3.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-repo-rm/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">13.3.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-repo-rm/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">13.3.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-repo-rm/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">13.3.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-repo-rm/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">13.3.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-repo-rm/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">13.3.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-repo-rm/category-repository"></a><div class="section2-header"><div class="section2-number">13.4</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-repo-rm/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">13.4.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number">13.4.2</div><div class="section3-title">Hôte du dépot (<span class="id">--repo-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte de dépôt dans le cas d'un fonctionnement à distance via SSH.</div><div class="section-body-text">Assurez-vous que l'authentification SSH soit correctement approuvé entre l'hôte <span class="postgres">PostgreSQL</span> et l'hôte du référentiel.<br/>
<br/>
Ce paramètre n'est pas nécessaire pour la sauvegarde et l'archivage sur un système de fichiers monté localement.</div><pre class="code-block">example: --repo1-host=repo1.domain.com</pre><div class="section-body-text">Nom obsolète: backup-host</div></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number">13.4.3</div><div class="section3-title">Chemin des binaires (<span class="id">--repo-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin des binaires <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Nécessaire uniquement si le chemin d'accès à <span class="file">pgbackrest</span> est différent entre les hôtes locaux et l'hote du dépôt. S'il n'est pas défini, le chemin des binaires sur l'hôte du dépôt sera le même que le chemin des binaires locaux.</div><pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: backup-cmd</div></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number">13.4.4</div><div class="section3-title">Emplacement du fichier de configuration (<span class="id">--repo-host-config</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du fichier de configuration <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le fichier de configuration de l'hôte du dépôt se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: backup-config</div></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number">13.4.5</div><div class="section3-title">Chemin d'inclusion de la configuration (<span class="id">--repo-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion <span class="backrest">pgBackRest</span> de la configuration de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin d'inclusion de la configuration de l'hôte du dépôt se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number">13.4.6</div><div class="section3-title">Chemin de configuration (<span class="id">--repo-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin de configuration de l'hôte du référentiel se trouve à un endroit différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --repo1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number">13.4.7</div><div class="section3-title">Port de l'hôte du dépôt (<span class="id">--repo-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Utilisez cette option pour spécifier un port non par défaut pour le protocole d'accès à l'hôte du dépôt. Actuellement, seul SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre><div class="section-body-text">Nom obsolète: backup-ssh-port</div></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number">13.4.8</div><div class="section3-title">Utilisateur de l'hôte du dépôt (<span class="id">--repo-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Définit l'utilisateur qui sera utilisé pour les opérations sur l'hôte du dépôt. De préférence, il ne s'agit pas de l'utilisateur <span class="id">postgres</span> mais plutôt d'un autre utilisateur comme <span class="id">pgbackrest</span>. Si <span class="postgres">PostgreSQL</span> fonctionne sur l'hôte du dépôt, l'utilisateur <span class="id">postgres</span> peut être placé dans le groupe <span class="id">pgbackrest</span> afin qu'il ait les autorisations de lecture sur le dépôt sans pouvoir en endommager le contenu accidentellement.</div><pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre><div class="section-body-text">Nom obsolète: backup-user</div></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">13.4.9</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">13.4.10</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">13.4.11</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">13.4.12</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">13.4.13</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">13.4.14</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">13.4.15</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">13.4.16</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">13.4.17</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">13.4.18</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-repo-rm/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">13.4.19</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div></div></div><div class="section1"><a id="command-restore"></a><div class="section1-header"><div class="section1-number">14</div><div class="section1-title">Commande Restauration (<span class="id">restore</span>)</div></div><div class="section-intro">This command is generally run manually, but there are instances where it might be automated.</div><div class="section-body"><div class="section2"><a id="command-restore/category-command"></a><div class="section2-header"><div class="section2-number">14.1</div><div class="section2-title">Command Options</div></div><div class="section-body"><div class="section3"><a id="command-restore/category-command/option-db-include"></a><div class="section3-header"><div class="section3-number">14.1.1</div><div class="section3-title">Inclure la base de données (<span class="id">--db-include</span>)</div></div><div class="section-body"><div class="section-body-text">Restaurer uniquement des bases de données spécifiques.</div><div class="section-body-text">Cette fonctionnalité permet de ne restaurer que certaines bases de données. Les bases de données qui ne sont pas spécifiquement sélectionnées seront restaurées sous la forme de fichiers épars et mis à zéro afin d'économiser de l'espace, tout en permettant à <span class="postgres">PostgreSQL</span> d'effectuer la restauration. Après la récupération, les bases de données qui n'ont pas été incluses ne seront pas accessibles mais peuvent être supprimées avec la commande <span class="id">drop database</span>. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">Les bases de données intégrées (<span class="id">template0</span>, <span class="id">template1</span>, et <span class="id">postgres</span>) sont toujours restaurées.</div></div>L'option <span class="br-setting">--db-include</span> peut être passée plusieurs fois pour spécifier plus d'une base de données à inclure.</div><pre class="code-block">example: --db-include=db_main</pre></div></div><div class="section3"><a id="command-restore/category-command/option-force"></a><div class="section3-header"><div class="section3-number">14.1.2</div><div class="section3-title">Force (<span class="id">--force</span>)</div></div><div class="section-body"><div class="section-body-text">Forcer une restauration.</div><div class="section-body-text">En soi, cette option écrase complètement les chemins des données et des tablespaces de <span class="postgres">PostgreSQL</span>. En association avec <span class="br-option">--delta</span>, un delta sera effectué en se basant sur l'horodatage et la taille au lieu des sommes de contrôle.</div><pre class="code-block">default: n
example: --force</pre></div></div><div class="section3"><a id="command-restore/category-command/option-link-all"></a><div class="section3-header"><div class="section3-number">14.1.3</div><div class="section3-title">Tous Liens synboliques (<span class="id">--link-all</span>)</div></div><div class="section-body"><div class="section-body-text">Restaurer tous les liens symboliques</div><div class="section-body-text">Par défaut, les liens symboliques qu'ils soient répertoires ou fichiers sont restaurés comme des répertoires et fichiers standards dans $PGDATA. En effet, il peut être dangereux de restaurer des liens symboliques vers leur destination d'origine sur un système autre que celui où la sauvegarde d'origine a été effectuée. Cette option restaure tous les liens symboliques tels qu'ils étaient sur le système d'origine où la sauvegarde a été effectuée.</div><pre class="code-block">default: n
example: --link-all</pre></div></div><div class="section3"><a id="command-restore/category-command/option-link-map"></a><div class="section3-header"><div class="section3-number">14.1.4</div><div class="section3-title">Mappage liens symboliques (<span class="id">--link-map</span>)</div></div><div class="section-body"><div class="section-body-text">Modification de la destination d'un lien symbolique.</div><div class="section-body-text">Permet de modifier la destination du fichier ou du répertoire d'un lien symbolique lors de la restauration. Ceci est utile lors de la restauration sur un sytèmes avec une configuration du stockage différente de celle du système d'origine (là où la sauvegarde a été réalisée).</div><pre class="code-block">example: --link-map=pg_xlog=/data/xlog</pre></div></div><div class="section3"><a id="command-restore/category-command/option-recovery-option"></a><div class="section3-header"><div class="section3-number">14.1.5</div><div class="section3-title">Option Récuperation (<span class="id">--recovery-option</span>)</div></div><div class="section-body"><div class="section-body-text">Définissez une option dans <span class="file">recovery.conf</span>.</div><div class="section-body-text">Consultez http://www.postgresql.org/docs/X.X/static/recovery-config.html pour plus de détails sur les options de recovery.conf (remplacez X.X par votre <span class="postgres">PostgreSQL</span> version). Cette option peut être utilisée plusieurs fois.<div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-setting">restore_command</span> sera générée automatiquement mais peut être écrasée avec cette option. Faites attention à bien spécifier votre propre <span class="br-setting">restore_command</span> car <span class="backrest">pgBackRest</span> est conçu pour gérer cela pour vous. Les options Target Recovery (recovery_target_name, recovery_target_time, etc.) sont générées automatiquement par <span class="backrest">pgBackRest</span> et ne doivent pas être définies avec cette option.</div></div>Dans la mesure où <span class="backrest">pgBackRest</span> ne démarre pas <span class="postgres">PostgreSQL</span> après avoir écrit le fichier <span class="file">recovery.conf</span>, il est toujours possible de modifier/contrôler <span class="file">recovery.conf</span> avant de redémarrer manuellement.</div><pre class="code-block">example: --recovery-option=primary_conninfo=db.mydomain.com</pre></div></div><div class="section3"><a id="command-restore/category-command/option-set"></a><div class="section3-header"><div class="section3-number">14.1.6</div><div class="section3-title">Jeu (<span class="id">--set</span>)</div></div><div class="section-body"><div class="section-body-text">Jeu de sauvegarde à restaurer.</div><div class="section-body-text">Le jeu de sauvegarde à restaurer : <span class="id">latest</span> restaurera la dernière sauvegarde, autrement fournir le nom de la sauvegarde à restaurer</div><pre class="code-block">default: latest
example: --set=20150131-153358F_20150131-153401I</pre></div></div><div class="section3"><a id="command-restore/category-command/option-tablespace-map"></a><div class="section3-header"><div class="section3-number">14.1.7</div><div class="section3-title">Mappage Tablespace (<span class="id">--tablespace-map</span>)</div></div><div class="section-body"><div class="section-body-text">Restaurer un tablespace dans un répertoire spécifique.</div><div class="section-body-text">Déplace un tablespace vers un nouvel emplacement pendant la restauration. Cela est utile lorsque les emplacements des tablespaces ne sont pas les mêmes sur un secondaire en réplication, ou lorsqu'un système a des points de montage différents après une mis à niveau.<br/>
<br/>
Depuis la version <span class="postgres">PostgreSQL</span> 9.2, les emplacements des tablespaces ne sont pas stockés dans pg_tablespace, donc le déplacement des tablespaces peut se faire en toute tranquillité. Cependant, le déplacement d'un tablespace vers le <span class="br-setting">data_directory</span> n'est pas recommandé et peut causer des problèmes. Pour plus d'informations sur le déplacement des tablespaces, http://www.databasesoup.com/2013/11/moving-tablespaces.html est une bonne ressource (en anglais).</div><pre class="code-block">example: --tablespace-map=ts_01=/db/ts_01</pre></div></div><div class="section3"><a id="command-restore/category-command/option-tablespace-map-all"></a><div class="section3-header"><div class="section3-number">14.1.8</div><div class="section3-title">Remappage Tous Tablespaces (<span class="id">--tablespace-map-all</span>)</div></div><div class="section-body"><div class="section-body-text">Restaurez tous les tablespaces dans le répertoire spécifié.</div><div class="section-body-text">Par défaut, les tablespaces sont restaurés à leur emplacement d'origine et, bien que ce comportement puisse être modifié avec l'option <span class="br-setting">tablespace-map</span>, il est parfois souhaitable de remapper tous les tablespaces dans un nouveau répertoire en une seule fois. Ceci est particulièrement utile pour les systèmes de développement ou de mise en place qui peuvent ne pas avoir la même disposition de stockage que le système d'origine où la sauvegarde a été réalisée.<br/>
<br/>
Le chemin spécifié sera le chemin parent utilisé pour créer tous les tablespaces de la sauvegarde lors de la restauration.</div><pre class="code-block">example: --tablespace-map-all=/data/tablespace</pre></div></div><div class="section3"><a id="command-restore/category-command/option-target"></a><div class="section3-header"><div class="section3-number">14.1.9</div><div class="section3-title">Target (<span class="id">--target</span>)</div></div><div class="section-body"><div class="section-body-text">Cible de récupération target.</div><div class="section-body-text">Définit la cible de récupération lorsque <span class="br-option">--type</span> est <span class="id">nom</span>, <span class="id">xid</span>, ou <span class="id">temps</span></div><pre class="code-block">example: --target=2015-01-30 14:15:11 EST</pre></div></div><div class="section3"><a id="command-restore/category-command/option-target-action"></a><div class="section3-header"><div class="section3-number">14.1.10</div><div class="section3-title">Target Action (<span class="id">--target-action</span>)</div></div><div class="section-body"><div class="section-body-text">Action à prendre lorsque la cible de récupération est atteint.</div><div class="section-body-text">Cette option est effective lorsque <span class="br-setting">hot_standby=on</span> est configuré dans <span class="postgres">PostgreSQL</span> (ex : <span class="file">postgresql.conf</span>); sans quoi l'instance sera promu lorsque la cible sera atteinte ou lorsqu'il n'y plus d'autre WAL archivé.<br/>
<br/>
Les actions suivantes sont supportées:<br/>
<ul><li><span class="id">pause</span> - mise en pause lorsque la cible de récupération est atteint. (<span class="postgres">PostgreSQL</span> >= 9.1)</li><li><span class="id">promote</span> - promotion et changement de timeline lorsque la cible de récupération est atteint. (<span class="postgres">PostgreSQL</span> >= 9.1)</li><li><span class="id">shutdown</span> - arrêt du serveur lorsque la cible de récupération est atteint (<span class="postgres">PostgreSQL</span> >= 9.5)</li></ul></div><pre class="code-block">default: pause
example: --target-action=promote</pre></div></div><div class="section3"><a id="command-restore/category-command/option-target-exclusive"></a><div class="section3-header"><div class="section3-number">14.1.11</div><div class="section3-title">Cible Exclusive (<span class="id">--target-exclusive</span>)</div></div><div class="section-body"><div class="section-body-text">S'arrêter juste avant que l'objectif de récupération ne soit atteint.</div><div class="section-body-text">Définit si la cible de récupération est exclusive (la valeur par défaut est inclusive) et n'est valable que lorsque <span class="br-option">--type</span> est <span class="id">time</span> ou <span class="id">xid</span>. Par exemple, l'utilisation de <span class="br-option">--target-exclusive</span> exclurait le contenu de la transaction <span class="id">1007</span> lorsque <span class="br-option">--type=xid</span> et <span class="br-option">--target=1007</span>. Pour plus d'information, consultez dans la documentation de <span class="postgres">PostgreSQL</span> l'option <span class="br-setting">recovery_target_inclusive</span>.</div><pre class="code-block">default: n
example: --no-target-exclusive</pre></div></div><div class="section3"><a id="command-restore/category-command/option-target-timeline"></a><div class="section3-header"><div class="section3-number">14.1.12</div><div class="section3-title">Target Timeline (<span class="id">--target-timeline</span>)</div></div><div class="section-body"><div class="section-body-text">Récupération jusqu'à une timeline.</div><div class="section-body-text">Voir <span class="br-setting">recovery_target_timeline</span> dans la documentation de <span class="postgres">PostgreSQL</span> pour plus d'informations</div><pre class="code-block">example: --target-timeline=3</pre></div></div><div class="section3"><a id="command-restore/category-command/option-type"></a><div class="section3-header"><div class="section3-number">14.1.13</div><div class="section3-title">Type (<span class="id">--type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de récupération.</div><div class="section-body-text">Les types de récupération suivants sont pris en charge:<br/>
<ul><li><span class="id">default</span> - récupération jusqu'à la fin du flux d'archives.</li><li><span class="id">immediate</span> - récupération uniquement jusqu'à ce que la base de données devienne cohérente. Cette option n'est prise en charge que sur <span class="postgres">PostgreSQL</span> >= 9.4.</li><li><span class="id">name</span> - récupération jusqu'au point de restauration spécifié dans <span class="br-option">--target</span>.</li><li><span class="id">xid</span> - récupération jusqu'à l'ID de transaction specifié dans <span class="br-option">--target</span>.</li><li><span class="id">time</span> - se récupération jusqu'au moment spécifié dans <span class="br-option">--target</span>.</li><li><span class="id">preserve</span> - préserver la configuration de la récupération (ex fichier <span class="file">recovery.conf</span>).</li><li><span class="id">standby</span> - ajoute <span class="br-setting">standby_mode=on</span> au option de récupération de <span class="postgres">PostgreSQL</span> (ex: <span class="file">recovery.conf</span>) pour que l'instance démarre en mode standby.</li><li><span class="id">none</span> - Aucune configuration de récupération n'est écrite dans <span class="postgres">PostgreSQL</span> (ex : <span class="file">recovery.conf</span>). <span class="postgres">PostgreSQL</span> tentera d'obtenir une cohérence en utilisant les segments WAL présents dans <span class="path">pg_xlog</span>/<span class="path">pg_wal</span>. Fournissez les segments WAL requis ou utilisez le paramètre <span class="br-setting">archive-copy</span> pour les inclure avec la sauvegarde.</li></ul></div><pre class="code-block">default: default
example: --type=xid</pre></div></div></div></div><div class="section2"><a id="command-restore/category-general"></a><div class="section2-header"><div class="section2-number">14.2</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-restore/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">14.2.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-restore/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">14.2.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-restore/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number">14.2.3</div><div class="section3-title">Niveau de compression réseau (<span class="id">--compress-level-network</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de compression du réseau.</div><div class="section-body-text">Définit le niveau de compression sur le réseau, lorsque <span class="br-setting">compress-type=none</span> et que la commande n'est pas exécutée sur le même hôte que le dépôt. La compression est utilisée pour réduire le trafic réseau mais peut être désactivée en définissant <span class="br-setting">compress-level-network=0</span>. Lorsque <span class="br-setting">compress-type</span> n'est pas égal à <span class="id">none</span>, le paramètre <span class="br-setting">compress-level-network</span> est ignoré et <span class="br-setting">compress-level</span> est utilisé à la place de sorte que le fichier ne soit compressé qu'une seule fois. La compression SSH est toujours désactivée.</div><pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre></div></div><div class="section3"><a id="command-restore/category-general/option-config"></a><div class="section3-header"><div class="section3-number">14.2.4</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-restore/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">14.2.5</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-restore/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">14.2.6</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-restore/category-general/option-delta"></a><div class="section3-header"><div class="section3-number">14.2.7</div><div class="section3-title">Delta (<span class="id">--delta</span>)</div></div><div class="section-body"><div class="section-body-text">Restauration ou sauvegarde à l'aide de sommes de contrôle.</div><div class="section-body-text">Lors d'une restauration, par défaut, les répertoires <span class="postgres">PostgreSQL</span> data et tablespace sont censés être présents mais vides. Cette option effectue une restauration delta en utilisant des sommes de contrôle.<br/>
<br/>
Lors d'une sauvegarde, cette option utilisera les sommes de contrôle au lieu des horodatages pour déterminer si les fichiers devront être copiés.</div><pre class="code-block">default: n
example: --delta</pre></div></div><div class="section3"><a id="command-restore/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">14.2.8</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-restore/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number">14.2.9</div><div class="section3-title">Chemin fichier de verrouillage (<span class="id">--lock-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockés les fichiers de verrouillage.</div><div class="section-body-text">Le chemin de verrouillage fournit l'emplacement à <span class="backrest">pgBackRest</span> pour créer des fichiers de verrouillage afin d'éviter que des opérations en conflictuelles ne soient exécutées simultanément.</div><pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre></div></div><div class="section3"><a id="command-restore/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">14.2.10</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-restore/category-general/option-process-max"></a><div class="section3-header"><div class="section3-number">14.2.11</div><div class="section3-title">Processus Maximum (<span class="id">--process-max</span>)</div></div><div class="section-body"><div class="section-body-text">Nombre de processus maximal lors utilisé lors de la compression et du transfert.</div><div class="section-body-text">Chaque processus effectuera une compression et un transfert pour que la commande s'exécute plus rapidement, mais ne réglez pas <span class="br-setting">process-max</span> à un niveau si élevé que cela affecte les performances de la base de données.</div><pre class="code-block">default: 1
allowed: 1-999
example: --process-max=4</pre></div></div><div class="section3"><a id="command-restore/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number">14.2.12</div><div class="section3-title">Délai d'attente au niveau Protocole (<span class="id">--protocol-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente du protocole.</div><div class="section-body-text">Définit le délai, en secondes, durant lequel le processus local ou distant attendra qu'un nouveau message soit reçu au niveau de la couche protocole. Cela permet d'éviter que les processus n'attendent indéfiniment un message. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">protocol-timeout</span> doit être supérieure à celle de <span class="br-option">db-timeout</span> option.</div></div></div><pre class="code-block">default: 1830
allowed: 0.1-604800
example: --protocol-timeout=630</pre></div></div><div class="section3"><a id="command-restore/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">14.2.13</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-restore/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">14.2.14</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-restore/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">14.2.15</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-restore/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">14.2.16</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-restore/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">14.2.17</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-restore/category-log"></a><div class="section2-header"><div class="section2-number">14.3</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-restore/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">14.3.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-restore/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">14.3.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-restore/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">14.3.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-restore/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">14.3.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-restore/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">14.3.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-restore/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">14.3.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-restore/category-repository"></a><div class="section2-header"><div class="section2-number">14.4</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-restore/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">14.4.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number">14.4.2</div><div class="section3-title">Hôte du dépot (<span class="id">--repo-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte de dépôt dans le cas d'un fonctionnement à distance via SSH.</div><div class="section-body-text">Assurez-vous que l'authentification SSH soit correctement approuvé entre l'hôte <span class="postgres">PostgreSQL</span> et l'hôte du référentiel.<br/>
<br/>
Ce paramètre n'est pas nécessaire pour la sauvegarde et l'archivage sur un système de fichiers monté localement.</div><pre class="code-block">example: --repo1-host=repo1.domain.com</pre><div class="section-body-text">Nom obsolète: backup-host</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number">14.4.3</div><div class="section3-title">Chemin des binaires (<span class="id">--repo-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin des binaires <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Nécessaire uniquement si le chemin d'accès à <span class="file">pgbackrest</span> est différent entre les hôtes locaux et l'hote du dépôt. S'il n'est pas défini, le chemin des binaires sur l'hôte du dépôt sera le même que le chemin des binaires locaux.</div><pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: backup-cmd</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number">14.4.4</div><div class="section3-title">Emplacement du fichier de configuration (<span class="id">--repo-host-config</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du fichier de configuration <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le fichier de configuration de l'hôte du dépôt se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: backup-config</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number">14.4.5</div><div class="section3-title">Chemin d'inclusion de la configuration (<span class="id">--repo-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion <span class="backrest">pgBackRest</span> de la configuration de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin d'inclusion de la configuration de l'hôte du dépôt se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number">14.4.6</div><div class="section3-title">Chemin de configuration (<span class="id">--repo-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin de configuration de l'hôte du référentiel se trouve à un endroit différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --repo1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number">14.4.7</div><div class="section3-title">Port de l'hôte du dépôt (<span class="id">--repo-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Utilisez cette option pour spécifier un port non par défaut pour le protocole d'accès à l'hôte du dépôt. Actuellement, seul SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre><div class="section-body-text">Nom obsolète: backup-ssh-port</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number">14.4.8</div><div class="section3-title">Utilisateur de l'hôte du dépôt (<span class="id">--repo-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Définit l'utilisateur qui sera utilisé pour les opérations sur l'hôte du dépôt. De préférence, il ne s'agit pas de l'utilisateur <span class="id">postgres</span> mais plutôt d'un autre utilisateur comme <span class="id">pgbackrest</span>. Si <span class="postgres">PostgreSQL</span> fonctionne sur l'hôte du dépôt, l'utilisateur <span class="id">postgres</span> peut être placé dans le groupe <span class="id">pgbackrest</span> afin qu'il ait les autorisations de lecture sur le dépôt sans pouvoir en endommager le contenu accidentellement.</div><pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre><div class="section-body-text">Nom obsolète: backup-user</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">14.4.9</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">14.4.10</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">14.4.11</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">14.4.12</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">14.4.13</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">14.4.14</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">14.4.15</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">14.4.16</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">14.4.17</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">14.4.18</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-restore/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">14.4.19</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div><div class="section2"><a id="command-restore/category-stanza"></a><div class="section2-header"><div class="section2-number">14.5</div><div class="section2-title">Stanza Options</div></div><div class="section-body"><div class="section3"><a id="command-restore/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number">14.5.1</div><div class="section3-title">PostgreSQL Chemin (<span class="id">--pg-path</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="postgres">PostgreSQL</span> data directory.</div><div class="section-body-text">Ce paramètre doit être le même que le paramètre <span class="br-setting">data_directory</span> du fichier <span class="file">postgresql.conf</span>. Même si cette valeur peut être lue à partir de <span class="file">postgresql.conf</span> ou <span class="postgres">PostgreSQL</span>, il est conseillé de la définir au cas où ces ressources ne seraient pas disponibles pendant un scénario de restauration ou de sauvegarde hors ligne.<br/>
<br/>
L'option <span class="br-setting">pg-path</span> est testée par rapport à la valeur indiquée par <span class="postgres">PostgreSQL</span> à chaque sauvegarde en ligne, elle doit donc toujours être à jour.</div><pre class="code-block">example: --pg1-path=/data/db</pre><div class="section-body-text">Nom obsolète: db-path</div></div></div></div></div></div></div><div class="section1"><a id="command-stanza-create"></a><div class="section1-header"><div class="section1-number">15</div><div class="section1-title">Commande Création du Stanza (<span class="id">stanza-create</span>)</div></div><div class="section-intro">La commande <span class="cmd">stanza-create</span> doit être exécutée sur l'hôte où se trouve le dépôt après que le stanza ait été configurée dans <span class="file">pgbackrest.conf</span>.</div><div class="section-body"><div class="section2"><a id="command-stanza-create/category-command"></a><div class="section2-header"><div class="section2-number">15.1</div><div class="section2-title">Command Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-create/category-command/option-backup-standby"></a><div class="section3-header"><div class="section3-number">15.1.1</div><div class="section3-title">Sauvegarde à partir du secondaire (<span class="id">--backup-standby</span>)</div></div><div class="section-body"><div class="section-body-text">Sauvegarde depuis l'instance standby secondaire.</div><div class="section-body-text">Activer la sauvegarde depuis le secondaire en standby pour réduire la charge sur l'instance primaire. Cette option nécessite que les hôtes <span class="host">primary</span> (primaire) et <span class="host">standby</span> (secondaire en standby) soit correctement configurés.</div><pre class="code-block">default: n
example: --backup-standby</pre></div></div><div class="section3"><a id="command-stanza-create/category-command/option-online"></a><div class="section3-header"><div class="section3-number">15.1.2</div><div class="section3-title">Online (<span class="id">--online</span>)</div></div><div class="section-body"><div class="section-body-text">Création sur une instance en ligne.</div><div class="section-body-text">Le fait de spécifier <span class="br-option">--no-online</span> empêche <span class="backrest">pgBackRest</span> de se connecter à <span class="postgres">PostgreSQL</span> lors de la création du stanza.</div><pre class="code-block">default: y
example: --no-online</pre></div></div></div></div><div class="section2"><a id="command-stanza-create/category-general"></a><div class="section2-header"><div class="section2-number">15.2</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-create/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">15.2.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">15.2.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number">15.2.3</div><div class="section3-title">Niveau de compression réseau (<span class="id">--compress-level-network</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de compression du réseau.</div><div class="section-body-text">Définit le niveau de compression sur le réseau, lorsque <span class="br-setting">compress-type=none</span> et que la commande n'est pas exécutée sur le même hôte que le dépôt. La compression est utilisée pour réduire le trafic réseau mais peut être désactivée en définissant <span class="br-setting">compress-level-network=0</span>. Lorsque <span class="br-setting">compress-type</span> n'est pas égal à <span class="id">none</span>, le paramètre <span class="br-setting">compress-level-network</span> est ignoré et <span class="br-setting">compress-level</span> est utilisé à la place de sorte que le fichier ne soit compressé qu'une seule fois. La compression SSH est toujours désactivée.</div><pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-config"></a><div class="section3-header"><div class="section3-number">15.2.4</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">15.2.5</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">15.2.6</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number">15.2.7</div><div class="section3-title">Timeout de la base de données (<span class="id">--db-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente des requêtes à la base de données.</div><div class="section-body-text">Définit le délai d'attente, en secondes, pour les interrogations de la base de données. Cela inclut les fonctions <span class="id">pg_start_backup()</span> et <span class="id">pg_stop_backup()</span> qui peuvent chacune prendre un temps considérable. C'est pourquoi le délai d'attente doit être maintenu à un niveau élevé, sauf si vous savez que ces fonctions retourneront rapidement (c'est-à-dire si vous avez défini <span class="br-setting">startfast=y</span> et que vous savez que l'instance de base de données ne générera pas beaucoup de segments WAL pendant la sauvegarde). <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">db-timeout</span> doit être inférieure à l'option <span class="br-option">protocol-timeout</span>.</div></div></div><pre class="code-block">default: 1800
allowed: 0.1-604800
example: --db-timeout=600</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">15.2.8</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number">15.2.9</div><div class="section3-title">Chemin fichier de verrouillage (<span class="id">--lock-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockés les fichiers de verrouillage.</div><div class="section-body-text">Le chemin de verrouillage fournit l'emplacement à <span class="backrest">pgBackRest</span> pour créer des fichiers de verrouillage afin d'éviter que des opérations en conflictuelles ne soient exécutées simultanément.</div><pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">15.2.10</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number">15.2.11</div><div class="section3-title">Délai d'attente au niveau Protocole (<span class="id">--protocol-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente du protocole.</div><div class="section-body-text">Définit le délai, en secondes, durant lequel le processus local ou distant attendra qu'un nouveau message soit reçu au niveau de la couche protocole. Cela permet d'éviter que les processus n'attendent indéfiniment un message. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">protocol-timeout</span> doit être supérieure à celle de <span class="br-option">db-timeout</span> option.</div></div></div><pre class="code-block">default: 1830
allowed: 0.1-604800
example: --protocol-timeout=630</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">15.2.12</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">15.2.13</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">15.2.14</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">15.2.15</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-stanza-create/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">15.2.16</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-stanza-create/category-log"></a><div class="section2-header"><div class="section2-number">15.3</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-create/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">15.3.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-stanza-create/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">15.3.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-stanza-create/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">15.3.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-stanza-create/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">15.3.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-stanza-create/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">15.3.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-stanza-create/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">15.3.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-stanza-create/category-repository"></a><div class="section2-header"><div class="section2-number">15.4</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-create/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">15.4.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">15.4.2</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">15.4.3</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">15.4.4</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">15.4.5</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">15.4.6</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">15.4.7</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">15.4.8</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">15.4.9</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">15.4.10</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">15.4.11</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-stanza-create/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">15.4.12</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div><div class="section2"><a id="command-stanza-create/category-stanza"></a><div class="section2-header"><div class="section2-number">15.5</div><div class="section2-title">Stanza Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host"></a><div class="section3-header"><div class="section3-number">15.5.1</div><div class="section3-title">Hôte PostgreSQL (<span class="id">--pg-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte <span class="postgres">PostgreSQL</span> pour les opérations à distance via SSH.</div><div class="section-body-text">Utilisé pour les sauvegardes lorsque l'hôte <span class="postgres">PostgreSQL</span> est différent de l'hôte du dépôt.</div><pre class="code-block">example: --pg1-host=db.domain.com</pre><div class="section-body-text">Nom obsolète: db-host</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-cmd"></a><div class="section3-header"><div class="section3-number">15.5.2</div><div class="section3-title">Hôte PostgreSQL Commande (<span class="id">--pg-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des exécutable <span class="backrest">pgBackRest</span> sur l'hôte <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Uniquement requis si le chemin vers <span class="file">pgbackrest</span> est différent sur le serveur local et <span class="postgres">PostgreSQL</span>. S'il n'est pas défini, le chemin de l'<span class="file">pgbackrest</span> de l'hôte de la base de données sera le même que le chemin de l'<span class="file">pgbackrest</span> local.</div><pre class="code-block">example: --pg1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: db-cmd</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-config"></a><div class="section3-header"><div class="section3-number">15.5.3</div><div class="section3-title">Hôte PostgreSQL Configuration (<span class="id">--pg-host-config</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="backrest">pgBackRest</span> database host configuration file.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le fichier de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --pg1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: db-config</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-config-include-path"></a><div class="section3-header"><div class="section3-number">15.5.4</div><div class="section3-title">Hôte PostgreSQL Chemin inclusion Configuration (<span class="id">--pg-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion de la configuration <span class="backrest">pgBackRest</span> sur l'hôte.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin d'inclusion de la configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --pg1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-config-path"></a><div class="section3-header"><div class="section3-number">15.5.5</div><div class="section3-title">Hôte PostgreSQL Chemin Configuration (<span class="id">--pg-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte de base de données.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --pg1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-port"></a><div class="section3-header"><div class="section3-number">15.5.6</div><div class="section3-title">Hôte PostgreSQL Port (<span class="id">--pg-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est configuré.</div><div class="section-body-text">Utiliser cette option pour spécifier un port non par défaut pour le protocole hôte <span class="postgres">PostgreSQL</span>. Actuellement, seul le protocole SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --pg1-host-port=25</pre><div class="section-body-text">Nom obsolète: db-ssh-port</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-host-user"></a><div class="section3-header"><div class="section3-number">15.5.7</div><div class="section3-title">Hôte PostgreSQL Utilisateur (<span class="id">--pg-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de connexion <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est défini.</div><div class="section-body-text">Cet utilisateur sera également propriétaire du processus distant <span class="backrest">pgBackRest</span> et initiera les connexions à <span class="postgres">PostgreSQL</span>. Pour que cela puisse fonctionner correctement, l'utilisateur doit être le propriétaire de l'instance de base de données <span class="postgres">PostgreSQL</span>, qui est généralement par défaut <span class="id">postgres</span>.</div><pre class="code-block">default: postgres
example: --pg1-host-user=db_owner</pre><div class="section-body-text">Nom obsolète: db-user</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number">15.5.8</div><div class="section3-title">PostgreSQL Chemin (<span class="id">--pg-path</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="postgres">PostgreSQL</span> data directory.</div><div class="section-body-text">Ce paramètre doit être le même que le paramètre <span class="br-setting">data_directory</span> du fichier <span class="file">postgresql.conf</span>. Même si cette valeur peut être lue à partir de <span class="file">postgresql.conf</span> ou <span class="postgres">PostgreSQL</span>, il est conseillé de la définir au cas où ces ressources ne seraient pas disponibles pendant un scénario de restauration ou de sauvegarde hors ligne.<br/>
<br/>
L'option <span class="br-setting">pg-path</span> est testée par rapport à la valeur indiquée par <span class="postgres">PostgreSQL</span> à chaque sauvegarde en ligne, elle doit donc toujours être à jour.</div><pre class="code-block">example: --pg1-path=/data/db</pre><div class="section-body-text">Nom obsolète: db-path</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-port"></a><div class="section3-header"><div class="section3-number">15.5.9</div><div class="section3-title">PostgreSQL Port (<span class="id">--pg-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Port sur lequel <span class="postgres">PostgreSQL</span> écoute. Il n'est généralement pas nécessaire de le préciser car la plupart des instances <span class="postgres">PostgreSQL</span> fonctionnent sur le port par défaut.</div><pre class="code-block">default: 5432
allowed: 0-65535
example: --pg1-port=6543</pre><div class="section-body-text">Nom obsolète: db-port</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-socket-path"></a><div class="section3-header"><div class="section3-number">15.5.10</div><div class="section3-title">PostgreSQL Emplacement Socket Unix (<span class="id">--pg-socket-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement socket unix <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Le répertoire de la socket unix qui a été spécifié au démarrage de <span class="postgres">PostgreSQL</span>. <span class="backrest">pgBackRest</span> trouvera automatiquement l'emplacement standard pour votre système d'exploitation, il n'est donc généralement pas nécessaire de spécifier ce paramètre, sauf si le répertoire des sockets a été explicitement modifié avec le paramètre <span class="br-setting">unix_socket_directory</span> dans <span class="file">postgresql.conf</span>.</div><pre class="code-block">allowed: 0-65535
example: --pg1-socket-path=/var/run/postgresql</pre><div class="section-body-text">Nom obsolète: db-socket-path</div></div></div><div class="section3"><a id="command-stanza-create/category-stanza/option-pg-user"></a><div class="section3-header"><div class="section3-number">15.5.11</div><div class="section3-title">PostgreSQL Utilisateur Base de données (<span class="id">--pg-user</span>)</div></div><div class="section-body"><div class="section-body-text">Nom d'utilisateur de base de données <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Le nom d'utilisateur de la base de données utilisé lors de la connexion à <span class="postgres">PostgreSQL</span>. S'il n'est pas spécifié, <span class="backrest">pgBackRest</span> se connectera avec l'utilisateur du système d'exploitation local ou <span class="id">PGUSER</span>.</div><pre class="code-block">example: --pg1-user=backupuser</pre></div></div></div></div></div></div><div class="section1"><a id="command-stanza-delete"></a><div class="section1-header"><div class="section1-number">16</div><div class="section1-title">Commande suppression du Stanza (<span class="id">stanza-delete</span>)</div></div><div class="section-intro">La commande <span class="cmd">stanza-delete</span> supprime les données du dépôt associé au stanza.<div class="admonition"><div class="warning">WARNING:</div><div class="warning-text">Utilisez cette commande avec précaution &mdash; elle supprimera définitivement toutes les sauvegardes et archives du dépôt <span class="backrest">pgBackRest</span> pour la stanza spécifiée.</div></div><br/>
Pour supprimer un stanza:<br/>
<ul><li>Arrêter l'instance <span class="postgres">PostgreSQL</span> associé au stanza (ou utiliser l'option <span class="br-option">--force</span> pour passer outre).</li><li>Exécuter la commande <span class="cmd">stop</span> sur l'hôte du dépôt.</li><li>Exécuter la commande <span class="cmd">stanza-delete</span> sur l'hôte du dépôt.</li></ul>Une fois la commande terminée avec succès, il incombe à l'utilisateur de supprimer de la configuration <span class="backrest">pgBackRest</span> le stanza.</div><div class="section-body"><div class="section2"><a id="command-stanza-delete/category-command"></a><div class="section2-header"><div class="section2-number">16.1</div><div class="section2-title">Command Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-delete/category-command/option-force"></a><div class="section3-header"><div class="section3-number">16.1.1</div><div class="section3-title">Force (<span class="id">--force</span>)</div></div><div class="section-body"><div class="section-body-text">Forcer la suppression du stanzadu réferentiel.</div><div class="section-body-text">Si <span class="postgres">PostgreSQL</span> est toujours en cours d'exécution pour le stanza, alors cette option peut être utilisée pour forcer sa suppression du référentiel.</div><pre class="code-block">default: n
example: --no-force</pre></div></div></div></div><div class="section2"><a id="command-stanza-delete/category-general"></a><div class="section2-header"><div class="section2-number">16.2</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-delete/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">16.2.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">16.2.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number">16.2.3</div><div class="section3-title">Niveau de compression réseau (<span class="id">--compress-level-network</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de compression du réseau.</div><div class="section-body-text">Définit le niveau de compression sur le réseau, lorsque <span class="br-setting">compress-type=none</span> et que la commande n'est pas exécutée sur le même hôte que le dépôt. La compression est utilisée pour réduire le trafic réseau mais peut être désactivée en définissant <span class="br-setting">compress-level-network=0</span>. Lorsque <span class="br-setting">compress-type</span> n'est pas égal à <span class="id">none</span>, le paramètre <span class="br-setting">compress-level-network</span> est ignoré et <span class="br-setting">compress-level</span> est utilisé à la place de sorte que le fichier ne soit compressé qu'une seule fois. La compression SSH est toujours désactivée.</div><pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-config"></a><div class="section3-header"><div class="section3-number">16.2.4</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">16.2.5</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">16.2.6</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number">16.2.7</div><div class="section3-title">Timeout de la base de données (<span class="id">--db-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente des requêtes à la base de données.</div><div class="section-body-text">Définit le délai d'attente, en secondes, pour les interrogations de la base de données. Cela inclut les fonctions <span class="id">pg_start_backup()</span> et <span class="id">pg_stop_backup()</span> qui peuvent chacune prendre un temps considérable. C'est pourquoi le délai d'attente doit être maintenu à un niveau élevé, sauf si vous savez que ces fonctions retourneront rapidement (c'est-à-dire si vous avez défini <span class="br-setting">startfast=y</span> et que vous savez que l'instance de base de données ne générera pas beaucoup de segments WAL pendant la sauvegarde). <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">db-timeout</span> doit être inférieure à l'option <span class="br-option">protocol-timeout</span>.</div></div></div><pre class="code-block">default: 1800
allowed: 0.1-604800
example: --db-timeout=600</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">16.2.8</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number">16.2.9</div><div class="section3-title">Chemin fichier de verrouillage (<span class="id">--lock-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockés les fichiers de verrouillage.</div><div class="section-body-text">Le chemin de verrouillage fournit l'emplacement à <span class="backrest">pgBackRest</span> pour créer des fichiers de verrouillage afin d'éviter que des opérations en conflictuelles ne soient exécutées simultanément.</div><pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">16.2.10</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number">16.2.11</div><div class="section3-title">Délai d'attente au niveau Protocole (<span class="id">--protocol-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente du protocole.</div><div class="section-body-text">Définit le délai, en secondes, durant lequel le processus local ou distant attendra qu'un nouveau message soit reçu au niveau de la couche protocole. Cela permet d'éviter que les processus n'attendent indéfiniment un message. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">protocol-timeout</span> doit être supérieure à celle de <span class="br-option">db-timeout</span> option.</div></div></div><pre class="code-block">default: 1830
allowed: 0.1-604800
example: --protocol-timeout=630</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">16.2.12</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">16.2.13</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">16.2.14</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">16.2.15</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-stanza-delete/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">16.2.16</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-stanza-delete/category-log"></a><div class="section2-header"><div class="section2-number">16.3</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-delete/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">16.3.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-stanza-delete/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">16.3.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-stanza-delete/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">16.3.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-stanza-delete/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">16.3.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-stanza-delete/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">16.3.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-stanza-delete/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">16.3.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-stanza-delete/category-repository"></a><div class="section2-header"><div class="section2-number">16.4</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">16.4.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">16.4.2</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">16.4.3</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">16.4.4</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">16.4.5</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">16.4.6</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">16.4.7</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">16.4.8</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">16.4.9</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">16.4.10</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">16.4.11</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-stanza-delete/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">16.4.12</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div><div class="section2"><a id="command-stanza-delete/category-stanza"></a><div class="section2-header"><div class="section2-number">16.5</div><div class="section2-title">Stanza Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host"></a><div class="section3-header"><div class="section3-number">16.5.1</div><div class="section3-title">Hôte PostgreSQL (<span class="id">--pg-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte <span class="postgres">PostgreSQL</span> pour les opérations à distance via SSH.</div><div class="section-body-text">Utilisé pour les sauvegardes lorsque l'hôte <span class="postgres">PostgreSQL</span> est différent de l'hôte du dépôt.</div><pre class="code-block">example: --pg1-host=db.domain.com</pre><div class="section-body-text">Nom obsolète: db-host</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-cmd"></a><div class="section3-header"><div class="section3-number">16.5.2</div><div class="section3-title">Hôte PostgreSQL Commande (<span class="id">--pg-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des exécutable <span class="backrest">pgBackRest</span> sur l'hôte <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Uniquement requis si le chemin vers <span class="file">pgbackrest</span> est différent sur le serveur local et <span class="postgres">PostgreSQL</span>. S'il n'est pas défini, le chemin de l'<span class="file">pgbackrest</span> de l'hôte de la base de données sera le même que le chemin de l'<span class="file">pgbackrest</span> local.</div><pre class="code-block">example: --pg1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: db-cmd</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-config"></a><div class="section3-header"><div class="section3-number">16.5.3</div><div class="section3-title">Hôte PostgreSQL Configuration (<span class="id">--pg-host-config</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="backrest">pgBackRest</span> database host configuration file.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le fichier de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --pg1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: db-config</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-config-include-path"></a><div class="section3-header"><div class="section3-number">16.5.4</div><div class="section3-title">Hôte PostgreSQL Chemin inclusion Configuration (<span class="id">--pg-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion de la configuration <span class="backrest">pgBackRest</span> sur l'hôte.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin d'inclusion de la configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --pg1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-config-path"></a><div class="section3-header"><div class="section3-number">16.5.5</div><div class="section3-title">Hôte PostgreSQL Chemin Configuration (<span class="id">--pg-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte de base de données.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --pg1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-port"></a><div class="section3-header"><div class="section3-number">16.5.6</div><div class="section3-title">Hôte PostgreSQL Port (<span class="id">--pg-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est configuré.</div><div class="section-body-text">Utiliser cette option pour spécifier un port non par défaut pour le protocole hôte <span class="postgres">PostgreSQL</span>. Actuellement, seul le protocole SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --pg1-host-port=25</pre><div class="section-body-text">Nom obsolète: db-ssh-port</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-host-user"></a><div class="section3-header"><div class="section3-number">16.5.7</div><div class="section3-title">Hôte PostgreSQL Utilisateur (<span class="id">--pg-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de connexion <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est défini.</div><div class="section-body-text">Cet utilisateur sera également propriétaire du processus distant <span class="backrest">pgBackRest</span> et initiera les connexions à <span class="postgres">PostgreSQL</span>. Pour que cela puisse fonctionner correctement, l'utilisateur doit être le propriétaire de l'instance de base de données <span class="postgres">PostgreSQL</span>, qui est généralement par défaut <span class="id">postgres</span>.</div><pre class="code-block">default: postgres
example: --pg1-host-user=db_owner</pre><div class="section-body-text">Nom obsolète: db-user</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number">16.5.8</div><div class="section3-title">PostgreSQL Chemin (<span class="id">--pg-path</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="postgres">PostgreSQL</span> data directory.</div><div class="section-body-text">Ce paramètre doit être le même que le paramètre <span class="br-setting">data_directory</span> du fichier <span class="file">postgresql.conf</span>. Même si cette valeur peut être lue à partir de <span class="file">postgresql.conf</span> ou <span class="postgres">PostgreSQL</span>, il est conseillé de la définir au cas où ces ressources ne seraient pas disponibles pendant un scénario de restauration ou de sauvegarde hors ligne.<br/>
<br/>
L'option <span class="br-setting">pg-path</span> est testée par rapport à la valeur indiquée par <span class="postgres">PostgreSQL</span> à chaque sauvegarde en ligne, elle doit donc toujours être à jour.</div><pre class="code-block">example: --pg1-path=/data/db</pre><div class="section-body-text">Nom obsolète: db-path</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-port"></a><div class="section3-header"><div class="section3-number">16.5.9</div><div class="section3-title">PostgreSQL Port (<span class="id">--pg-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Port sur lequel <span class="postgres">PostgreSQL</span> écoute. Il n'est généralement pas nécessaire de le préciser car la plupart des instances <span class="postgres">PostgreSQL</span> fonctionnent sur le port par défaut.</div><pre class="code-block">default: 5432
allowed: 0-65535
example: --pg1-port=6543</pre><div class="section-body-text">Nom obsolète: db-port</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-socket-path"></a><div class="section3-header"><div class="section3-number">16.5.10</div><div class="section3-title">PostgreSQL Emplacement Socket Unix (<span class="id">--pg-socket-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement socket unix <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Le répertoire de la socket unix qui a été spécifié au démarrage de <span class="postgres">PostgreSQL</span>. <span class="backrest">pgBackRest</span> trouvera automatiquement l'emplacement standard pour votre système d'exploitation, il n'est donc généralement pas nécessaire de spécifier ce paramètre, sauf si le répertoire des sockets a été explicitement modifié avec le paramètre <span class="br-setting">unix_socket_directory</span> dans <span class="file">postgresql.conf</span>.</div><pre class="code-block">allowed: 0-65535
example: --pg1-socket-path=/var/run/postgresql</pre><div class="section-body-text">Nom obsolète: db-socket-path</div></div></div><div class="section3"><a id="command-stanza-delete/category-stanza/option-pg-user"></a><div class="section3-header"><div class="section3-number">16.5.11</div><div class="section3-title">PostgreSQL Utilisateur Base de données (<span class="id">--pg-user</span>)</div></div><div class="section-body"><div class="section-body-text">Nom d'utilisateur de base de données <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Le nom d'utilisateur de la base de données utilisé lors de la connexion à <span class="postgres">PostgreSQL</span>. S'il n'est pas spécifié, <span class="backrest">pgBackRest</span> se connectera avec l'utilisateur du système d'exploitation local ou <span class="id">PGUSER</span>.</div><pre class="code-block">example: --pg1-user=backupuser</pre></div></div></div></div></div></div><div class="section1"><a id="command-stanza-upgrade"></a><div class="section1-header"><div class="section1-number">17</div><div class="section1-title">Commande Mise à niveau du Stanza (<span class="id">stanza-upgrade</span>)</div></div><div class="section-intro">Immédiatement après la mise à niveau de <span class="postgres">PostgreSQL</span> vers une nouvelle version majeure, le chemin <span class="br-option">pg-path</span> pour toute la configuration de <span class="backrest">pgBackRest</span> doit être défini sur le nouvel emplacement de la base de données et la commande <span class="cmd">stanza-upgrade</span> doit être exécuté sur l'hôte du dépôt. Si l'instance <span class="postgres">PostgreSQL</span> est hors ligne, utilisez l'option <span class="br-option">--no-online</span>.</div><div class="section-body"><div class="section2"><a id="command-stanza-upgrade/category-command"></a><div class="section2-header"><div class="section2-number">17.1</div><div class="section2-title">Command Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-upgrade/category-command/option-backup-standby"></a><div class="section3-header"><div class="section3-number">17.1.1</div><div class="section3-title">Sauvegarde à partir du secondaire (<span class="id">--backup-standby</span>)</div></div><div class="section-body"><div class="section-body-text">Sauvegarde depuis l'instance standby secondaire.</div><div class="section-body-text">Activer la sauvegarde depuis le secondaire en standby pour réduire la charge sur l'instance primaire. Cette option nécessite que les hôtes <span class="host">primary</span> (primaire) et <span class="host">standby</span> (secondaire en standby) soit correctement configurés.</div><pre class="code-block">default: n
example: --backup-standby</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-command/option-online"></a><div class="section3-header"><div class="section3-number">17.1.2</div><div class="section3-title">Online (<span class="id">--online</span>)</div></div><div class="section-body"><div class="section-body-text">Mettre à jour une instance en ligne.</div><div class="section-body-text">Le fait de spécifier <span class="br-option">--no-online</span> empêche <span class="backrest">pgBackRest</span> de se connecter à <span class="postgres">PostgreSQL</span> lors de la mise à jour du stanza.</div><pre class="code-block">default: y
example: --no-online</pre></div></div></div></div><div class="section2"><a id="command-stanza-upgrade/category-general"></a><div class="section2-header"><div class="section2-number">17.2</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-upgrade/category-general/option-buffer-size"></a><div class="section3-header"><div class="section3-number">17.2.1</div><div class="section3-title">Taille de la mémoire tampon (<span class="id">--buffer-size</span>)</div></div><div class="section-body"><div class="section-body-text">Taille de la mémoire tampon pour les opérations sur les fichiers.</div><div class="section-body-text">Définissez la taille de la mémoire tampon utilisée pour les opérations de copie, de compression et de décompression. Un maximum de 3 tampons seront utilisés à la fois par processus. Un maximum supplémentaire de 256K par processus peut être utilisé pour les tampons zlib.<br/>
<br/>
La taille peut être saisie en octets (par défaut) ou en KB, MB, GB, TB, ou PB où le multiplicateur est une puissance de 1024. Par exemple, la valeur insensible à la casse 32k (ou 32KB) peut être utilisée au lieu de 32768.<br/>
<br/>
Les valeurs autorisées, en octets, sont<span class="id">16384</span>, <span class="id">32768</span>, <span class="id">65536</span>, <span class="id">131072</span>, <span class="id">262144</span>, <span class="id">524288</span>, <span class="id">1048576</span>, <span class="id">2097152</span>, <span class="id">4194304</span>, <span class="id">8388608</span>, et <span class="id">16777216</span>.</div><pre class="code-block">default: 1048576
example: --buffer-size=32K</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">17.2.2</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-compress-level-network"></a><div class="section3-header"><div class="section3-number">17.2.3</div><div class="section3-title">Niveau de compression réseau (<span class="id">--compress-level-network</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de compression du réseau.</div><div class="section-body-text">Définit le niveau de compression sur le réseau, lorsque <span class="br-setting">compress-type=none</span> et que la commande n'est pas exécutée sur le même hôte que le dépôt. La compression est utilisée pour réduire le trafic réseau mais peut être désactivée en définissant <span class="br-setting">compress-level-network=0</span>. Lorsque <span class="br-setting">compress-type</span> n'est pas égal à <span class="id">none</span>, le paramètre <span class="br-setting">compress-level-network</span> est ignoré et <span class="br-setting">compress-level</span> est utilisé à la place de sorte que le fichier ne soit compressé qu'une seule fois. La compression SSH est toujours désactivée.</div><pre class="code-block">default: 3
allowed: 0-9
example: --compress-level-network=1</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-config"></a><div class="section3-header"><div class="section3-number">17.2.4</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">17.2.5</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">17.2.6</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-db-timeout"></a><div class="section3-header"><div class="section3-number">17.2.7</div><div class="section3-title">Timeout de la base de données (<span class="id">--db-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente des requêtes à la base de données.</div><div class="section-body-text">Définit le délai d'attente, en secondes, pour les interrogations de la base de données. Cela inclut les fonctions <span class="id">pg_start_backup()</span> et <span class="id">pg_stop_backup()</span> qui peuvent chacune prendre un temps considérable. C'est pourquoi le délai d'attente doit être maintenu à un niveau élevé, sauf si vous savez que ces fonctions retourneront rapidement (c'est-à-dire si vous avez défini <span class="br-setting">startfast=y</span> et que vous savez que l'instance de base de données ne générera pas beaucoup de segments WAL pendant la sauvegarde). <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">db-timeout</span> doit être inférieure à l'option <span class="br-option">protocol-timeout</span>.</div></div></div><pre class="code-block">default: 1800
allowed: 0.1-604800
example: --db-timeout=600</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-io-timeout"></a><div class="section3-header"><div class="section3-number">17.2.8</div><div class="section3-title">Délai d'attente E/S (<span class="id">--io-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente E/S.</div><div class="section-body-text">Délai d'attente, en secondes, utilisé pour les connexions et les opérations de lecture/écriture.<br/>
<br/>
Notez que l'ensemble de l'opération de lecture/écriture n'a pas besoin de se terminer dans ce délai mais une <i>progression</i> doit être constatée, même s'il ne s'agit que d'un seul octet.</div><pre class="code-block">default: 60
allowed: 0.1-3600
example: --io-timeout=120</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number">17.2.9</div><div class="section3-title">Chemin fichier de verrouillage (<span class="id">--lock-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockés les fichiers de verrouillage.</div><div class="section-body-text">Le chemin de verrouillage fournit l'emplacement à <span class="backrest">pgBackRest</span> pour créer des fichiers de verrouillage afin d'éviter que des opérations en conflictuelles ne soient exécutées simultanément.</div><pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">17.2.10</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-protocol-timeout"></a><div class="section3-header"><div class="section3-number">17.2.11</div><div class="section3-title">Délai d'attente au niveau Protocole (<span class="id">--protocol-timeout</span>)</div></div><div class="section-body"><div class="section-body-text">Délai d'attente du protocole.</div><div class="section-body-text">Définit le délai, en secondes, durant lequel le processus local ou distant attendra qu'un nouveau message soit reçu au niveau de la couche protocole. Cela permet d'éviter que les processus n'attendent indéfiniment un message. <div class="admonition"><div class="note">NOTE:</div><div class="note-text">L'option <span class="br-option">protocol-timeout</span> doit être supérieure à celle de <span class="br-option">db-timeout</span> option.</div></div></div><pre class="code-block">default: 1830
allowed: 0.1-604800
example: --protocol-timeout=630</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-sck-keep-alive"></a><div class="section3-header"><div class="section3-number">17.2.12</div><div class="section3-title">Keep Alive (<span class="id">--sck-keep-alive</span>)</div></div><div class="section-body"><div class="section-body-text">Activation de la fonction de keep-alive (maintien en vie).</div><div class="section-body-text">Activation des messages de keep-alive (maintien en vie) sur les connexions réseaux.</div><pre class="code-block">default: y
example: --no-sck-keep-alive</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">17.2.13</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-tcp-keep-alive-count"></a><div class="section3-header"><div class="section3-number">17.2.14</div><div class="section3-title">Conteur Keep Alive (<span class="id">--tcp-keep-alive-count</span>)</div></div><div class="section-body"><div class="section-body-text">Compteur Keep-alive.</div><div class="section-body-text">Spécifie le nombre de messages TCP à garder en mémoire qui peuvent être perdus avant que la connexion ne soit considérée comme morte.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPCNT</span>.</div><pre class="code-block">allowed: 1-32
example: --tcp-keep-alive-count=3</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-tcp-keep-alive-idle"></a><div class="section3-header"><div class="section3-number">17.2.15</div><div class="section3-title">Temps d'inactivité Keep Alive (<span class="id">--tcp-keep-alive-idle</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'inactivité du keepalive.</div><div class="section-body-text">Spécifie la durée (en secondes) sans activité du réseau après laquelle le système d'exploitation doit envoyer un message TCP de maintien en activité (keep-alive).<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPIDLE</span>.</div><pre class="code-block">allowed: 1-3600
example: --tcp-keep-alive-idle=60</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-general/option-tcp-keep-alive-interval"></a><div class="section3-header"><div class="section3-number">17.2.16</div><div class="section3-title">Intervalle du Keep Alive (<span class="id">--tcp-keep-alive-interval</span>)</div></div><div class="section-body"><div class="section-body-text">Temps d'intervalle de maintien en vie (keep-alive).</div><div class="section-body-text">Spécifie le temps (en secondes) après lequel un message TCP de maintien en activité (keep-alive) non acquitté doit être retransmis.<br/>
<br/>
Cette option n'est disponible que sur les systèmes qui prennent en charge l'option réseau <span class="id">TCP_KEEPINTVL</span>.</div><pre class="code-block">allowed: 1-900
example: --tcp-keep-alive-interval=30</pre></div></div></div></div><div class="section2"><a id="command-stanza-upgrade/category-log"></a><div class="section2-header"><div class="section2-number">17.3</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-upgrade/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">17.3.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">17.3.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">17.3.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">17.3.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">17.3.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">17.3.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-stanza-upgrade/category-repository"></a><div class="section2-header"><div class="section2-number">17.4</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">17.4.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">17.4.2</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">17.4.3</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">17.4.4</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">17.4.5</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">17.4.6</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">17.4.7</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">17.4.8</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">17.4.9</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">17.4.10</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">17.4.11</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">17.4.12</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div><div class="section2"><a id="command-stanza-upgrade/category-stanza"></a><div class="section2-header"><div class="section2-number">17.5</div><div class="section2-title">Stanza Options</div></div><div class="section-body"><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host"></a><div class="section3-header"><div class="section3-number">17.5.1</div><div class="section3-title">Hôte PostgreSQL (<span class="id">--pg-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte <span class="postgres">PostgreSQL</span> pour les opérations à distance via SSH.</div><div class="section-body-text">Utilisé pour les sauvegardes lorsque l'hôte <span class="postgres">PostgreSQL</span> est différent de l'hôte du dépôt.</div><pre class="code-block">example: --pg1-host=db.domain.com</pre><div class="section-body-text">Nom obsolète: db-host</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-cmd"></a><div class="section3-header"><div class="section3-number">17.5.2</div><div class="section3-title">Hôte PostgreSQL Commande (<span class="id">--pg-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des exécutable <span class="backrest">pgBackRest</span> sur l'hôte <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Uniquement requis si le chemin vers <span class="file">pgbackrest</span> est différent sur le serveur local et <span class="postgres">PostgreSQL</span>. S'il n'est pas défini, le chemin de l'<span class="file">pgbackrest</span> de l'hôte de la base de données sera le même que le chemin de l'<span class="file">pgbackrest</span> local.</div><pre class="code-block">example: --pg1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: db-cmd</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-config"></a><div class="section3-header"><div class="section3-number">17.5.3</div><div class="section3-title">Hôte PostgreSQL Configuration (<span class="id">--pg-host-config</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="backrest">pgBackRest</span> database host configuration file.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le fichier de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --pg1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: db-config</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-config-include-path"></a><div class="section3-header"><div class="section3-number">17.5.4</div><div class="section3-title">Hôte PostgreSQL Chemin inclusion Configuration (<span class="id">--pg-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion de la configuration <span class="backrest">pgBackRest</span> sur l'hôte.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin d'inclusion de la configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --pg1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-config-path"></a><div class="section3-header"><div class="section3-number">17.5.5</div><div class="section3-title">Hôte PostgreSQL Chemin Configuration (<span class="id">--pg-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte de base de données.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --pg1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-port"></a><div class="section3-header"><div class="section3-number">17.5.6</div><div class="section3-title">Hôte PostgreSQL Port (<span class="id">--pg-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est configuré.</div><div class="section-body-text">Utiliser cette option pour spécifier un port non par défaut pour le protocole hôte <span class="postgres">PostgreSQL</span>. Actuellement, seul le protocole SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --pg1-host-port=25</pre><div class="section-body-text">Nom obsolète: db-ssh-port</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-host-user"></a><div class="section3-header"><div class="section3-number">17.5.7</div><div class="section3-title">Hôte PostgreSQL Utilisateur (<span class="id">--pg-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de connexion <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est défini.</div><div class="section-body-text">Cet utilisateur sera également propriétaire du processus distant <span class="backrest">pgBackRest</span> et initiera les connexions à <span class="postgres">PostgreSQL</span>. Pour que cela puisse fonctionner correctement, l'utilisateur doit être le propriétaire de l'instance de base de données <span class="postgres">PostgreSQL</span>, qui est généralement par défaut <span class="id">postgres</span>.</div><pre class="code-block">default: postgres
example: --pg1-host-user=db_owner</pre><div class="section-body-text">Nom obsolète: db-user</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-path"></a><div class="section3-header"><div class="section3-number">17.5.8</div><div class="section3-title">PostgreSQL Chemin (<span class="id">--pg-path</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="postgres">PostgreSQL</span> data directory.</div><div class="section-body-text">Ce paramètre doit être le même que le paramètre <span class="br-setting">data_directory</span> du fichier <span class="file">postgresql.conf</span>. Même si cette valeur peut être lue à partir de <span class="file">postgresql.conf</span> ou <span class="postgres">PostgreSQL</span>, il est conseillé de la définir au cas où ces ressources ne seraient pas disponibles pendant un scénario de restauration ou de sauvegarde hors ligne.<br/>
<br/>
L'option <span class="br-setting">pg-path</span> est testée par rapport à la valeur indiquée par <span class="postgres">PostgreSQL</span> à chaque sauvegarde en ligne, elle doit donc toujours être à jour.</div><pre class="code-block">example: --pg1-path=/data/db</pre><div class="section-body-text">Nom obsolète: db-path</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-port"></a><div class="section3-header"><div class="section3-number">17.5.9</div><div class="section3-title">PostgreSQL Port (<span class="id">--pg-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Port sur lequel <span class="postgres">PostgreSQL</span> écoute. Il n'est généralement pas nécessaire de le préciser car la plupart des instances <span class="postgres">PostgreSQL</span> fonctionnent sur le port par défaut.</div><pre class="code-block">default: 5432
allowed: 0-65535
example: --pg1-port=6543</pre><div class="section-body-text">Nom obsolète: db-port</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-socket-path"></a><div class="section3-header"><div class="section3-number">17.5.10</div><div class="section3-title">PostgreSQL Emplacement Socket Unix (<span class="id">--pg-socket-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement socket unix <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Le répertoire de la socket unix qui a été spécifié au démarrage de <span class="postgres">PostgreSQL</span>. <span class="backrest">pgBackRest</span> trouvera automatiquement l'emplacement standard pour votre système d'exploitation, il n'est donc généralement pas nécessaire de spécifier ce paramètre, sauf si le répertoire des sockets a été explicitement modifié avec le paramètre <span class="br-setting">unix_socket_directory</span> dans <span class="file">postgresql.conf</span>.</div><pre class="code-block">allowed: 0-65535
example: --pg1-socket-path=/var/run/postgresql</pre><div class="section-body-text">Nom obsolète: db-socket-path</div></div></div><div class="section3"><a id="command-stanza-upgrade/category-stanza/option-pg-user"></a><div class="section3-header"><div class="section3-number">17.5.11</div><div class="section3-title">PostgreSQL Utilisateur Base de données (<span class="id">--pg-user</span>)</div></div><div class="section-body"><div class="section-body-text">Nom d'utilisateur de base de données <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Le nom d'utilisateur de la base de données utilisé lors de la connexion à <span class="postgres">PostgreSQL</span>. S'il n'est pas spécifié, <span class="backrest">pgBackRest</span> se connectera avec l'utilisateur du système d'exploitation local ou <span class="id">PGUSER</span>.</div><pre class="code-block">example: --pg1-user=backupuser</pre></div></div></div></div></div></div><div class="section1"><a id="command-start"></a><div class="section1-header"><div class="section1-number">18</div><div class="section1-title">Commande Start (<span class="id">start</span>)</div></div><div class="section-intro">Si les processus <span class="backrest">pgBackRest</span> ont été précédemment arrêtés à l'aide de la commande <span class="cmd">stop</span>, ils peuvent être relancés à l'aide de la commande <span class="cmd">start</span>. Notez que cela ne démarrera pas immédiatement les processus <span class="backrest">pgBackRest</span> mais ils seront autorisés à s'exécuter.</div><div class="section-body"><div class="section2"><a id="command-start/category-general"></a><div class="section2-header"><div class="section2-number">18.1</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-start/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">18.1.1</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-start/category-general/option-config"></a><div class="section3-header"><div class="section3-number">18.1.2</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-start/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">18.1.3</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-start/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">18.1.4</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-start/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number">18.1.5</div><div class="section3-title">Chemin fichier de verrouillage (<span class="id">--lock-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockés les fichiers de verrouillage.</div><div class="section-body-text">Le chemin de verrouillage fournit l'emplacement à <span class="backrest">pgBackRest</span> pour créer des fichiers de verrouillage afin d'éviter que des opérations en conflictuelles ne soient exécutées simultanément.</div><pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre></div></div><div class="section3"><a id="command-start/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">18.1.6</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-start/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">18.1.7</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div></div></div><div class="section2"><a id="command-start/category-log"></a><div class="section2-header"><div class="section2-number">18.2</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-start/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">18.2.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-start/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">18.2.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-start/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">18.2.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-start/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">18.2.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-start/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">18.2.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-start/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">18.2.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-start/category-repository"></a><div class="section2-header"><div class="section2-number">18.3</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-start/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">18.3.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-start/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number">18.3.2</div><div class="section3-title">Hôte du dépot (<span class="id">--repo-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte de dépôt dans le cas d'un fonctionnement à distance via SSH.</div><div class="section-body-text">Assurez-vous que l'authentification SSH soit correctement approuvé entre l'hôte <span class="postgres">PostgreSQL</span> et l'hôte du référentiel.<br/>
<br/>
Ce paramètre n'est pas nécessaire pour la sauvegarde et l'archivage sur un système de fichiers monté localement.</div><pre class="code-block">example: --repo1-host=repo1.domain.com</pre><div class="section-body-text">Nom obsolète: backup-host</div></div></div><div class="section3"><a id="command-start/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number">18.3.3</div><div class="section3-title">Chemin des binaires (<span class="id">--repo-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin des binaires <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Nécessaire uniquement si le chemin d'accès à <span class="file">pgbackrest</span> est différent entre les hôtes locaux et l'hote du dépôt. S'il n'est pas défini, le chemin des binaires sur l'hôte du dépôt sera le même que le chemin des binaires locaux.</div><pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: backup-cmd</div></div></div><div class="section3"><a id="command-start/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number">18.3.4</div><div class="section3-title">Emplacement du fichier de configuration (<span class="id">--repo-host-config</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du fichier de configuration <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le fichier de configuration de l'hôte du dépôt se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: backup-config</div></div></div><div class="section3"><a id="command-start/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number">18.3.5</div><div class="section3-title">Chemin d'inclusion de la configuration (<span class="id">--repo-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion <span class="backrest">pgBackRest</span> de la configuration de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin d'inclusion de la configuration de l'hôte du dépôt se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-start/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number">18.3.6</div><div class="section3-title">Chemin de configuration (<span class="id">--repo-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin de configuration de l'hôte du référentiel se trouve à un endroit différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --repo1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-start/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number">18.3.7</div><div class="section3-title">Port de l'hôte du dépôt (<span class="id">--repo-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Utilisez cette option pour spécifier un port non par défaut pour le protocole d'accès à l'hôte du dépôt. Actuellement, seul SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre><div class="section-body-text">Nom obsolète: backup-ssh-port</div></div></div><div class="section3"><a id="command-start/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number">18.3.8</div><div class="section3-title">Utilisateur de l'hôte du dépôt (<span class="id">--repo-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Définit l'utilisateur qui sera utilisé pour les opérations sur l'hôte du dépôt. De préférence, il ne s'agit pas de l'utilisateur <span class="id">postgres</span> mais plutôt d'un autre utilisateur comme <span class="id">pgbackrest</span>. Si <span class="postgres">PostgreSQL</span> fonctionne sur l'hôte du dépôt, l'utilisateur <span class="id">postgres</span> peut être placé dans le groupe <span class="id">pgbackrest</span> afin qu'il ait les autorisations de lecture sur le dépôt sans pouvoir en endommager le contenu accidentellement.</div><pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre><div class="section-body-text">Nom obsolète: backup-user</div></div></div><div class="section3"><a id="command-start/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">18.3.9</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-start/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">18.3.10</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-start/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">18.3.11</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-start/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">18.3.12</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-start/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">18.3.13</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-start/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">18.3.14</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-start/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">18.3.15</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-start/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">18.3.16</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-start/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">18.3.17</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-start/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">18.3.18</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-start/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">18.3.19</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div><div class="section2"><a id="command-start/category-stanza"></a><div class="section2-header"><div class="section2-number">18.4</div><div class="section2-title">Stanza Options</div></div><div class="section-body"><div class="section3"><a id="command-start/category-stanza/option-pg-host"></a><div class="section3-header"><div class="section3-number">18.4.1</div><div class="section3-title">Hôte PostgreSQL (<span class="id">--pg-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte <span class="postgres">PostgreSQL</span> pour les opérations à distance via SSH.</div><div class="section-body-text">Utilisé pour les sauvegardes lorsque l'hôte <span class="postgres">PostgreSQL</span> est différent de l'hôte du dépôt.</div><pre class="code-block">example: --pg1-host=db.domain.com</pre><div class="section-body-text">Nom obsolète: db-host</div></div></div><div class="section3"><a id="command-start/category-stanza/option-pg-host-cmd"></a><div class="section3-header"><div class="section3-number">18.4.2</div><div class="section3-title">Hôte PostgreSQL Commande (<span class="id">--pg-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des exécutable <span class="backrest">pgBackRest</span> sur l'hôte <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Uniquement requis si le chemin vers <span class="file">pgbackrest</span> est différent sur le serveur local et <span class="postgres">PostgreSQL</span>. S'il n'est pas défini, le chemin de l'<span class="file">pgbackrest</span> de l'hôte de la base de données sera le même que le chemin de l'<span class="file">pgbackrest</span> local.</div><pre class="code-block">example: --pg1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: db-cmd</div></div></div><div class="section3"><a id="command-start/category-stanza/option-pg-host-config"></a><div class="section3-header"><div class="section3-number">18.4.3</div><div class="section3-title">Hôte PostgreSQL Configuration (<span class="id">--pg-host-config</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="backrest">pgBackRest</span> database host configuration file.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le fichier de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --pg1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: db-config</div></div></div><div class="section3"><a id="command-start/category-stanza/option-pg-host-config-include-path"></a><div class="section3-header"><div class="section3-number">18.4.4</div><div class="section3-title">Hôte PostgreSQL Chemin inclusion Configuration (<span class="id">--pg-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion de la configuration <span class="backrest">pgBackRest</span> sur l'hôte.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin d'inclusion de la configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --pg1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-start/category-stanza/option-pg-host-config-path"></a><div class="section3-header"><div class="section3-number">18.4.5</div><div class="section3-title">Hôte PostgreSQL Chemin Configuration (<span class="id">--pg-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte de base de données.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --pg1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-start/category-stanza/option-pg-host-port"></a><div class="section3-header"><div class="section3-number">18.4.6</div><div class="section3-title">Hôte PostgreSQL Port (<span class="id">--pg-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est configuré.</div><div class="section-body-text">Utiliser cette option pour spécifier un port non par défaut pour le protocole hôte <span class="postgres">PostgreSQL</span>. Actuellement, seul le protocole SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --pg1-host-port=25</pre><div class="section-body-text">Nom obsolète: db-ssh-port</div></div></div><div class="section3"><a id="command-start/category-stanza/option-pg-host-user"></a><div class="section3-header"><div class="section3-number">18.4.7</div><div class="section3-title">Hôte PostgreSQL Utilisateur (<span class="id">--pg-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de connexion <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est défini.</div><div class="section-body-text">Cet utilisateur sera également propriétaire du processus distant <span class="backrest">pgBackRest</span> et initiera les connexions à <span class="postgres">PostgreSQL</span>. Pour que cela puisse fonctionner correctement, l'utilisateur doit être le propriétaire de l'instance de base de données <span class="postgres">PostgreSQL</span>, qui est généralement par défaut <span class="id">postgres</span>.</div><pre class="code-block">default: postgres
example: --pg1-host-user=db_owner</pre><div class="section-body-text">Nom obsolète: db-user</div></div></div></div></div></div></div><div class="section1"><a id="command-stop"></a><div class="section1-header"><div class="section1-number">19</div><div class="section1-title">Commande Stop (<span class="id">stop</span>)</div></div><div class="section-intro">Interdit l'exécution de tout nouveau processus <span class="backrest">pgBackRest</span>. Par défaut, les processus en cours d'exécution seront autorisés à se terminer normalement. Utiliser l'option <span class="br-setting">--force</span> pour mettre fin aux processus en cours.<br/>
<br/>
Les processus <span class="backrest">pgBackRest</span> retourneront une erreur s'ils sont exécutés après la fin de la commande d'arrêt.</div><div class="section-body"><div class="section2"><a id="command-stop/category-command"></a><div class="section2-header"><div class="section2-number">19.1</div><div class="section2-title">Command Options</div></div><div class="section-body"><div class="section3"><a id="command-stop/category-command/option-force"></a><div class="section3-header"><div class="section3-number">19.1.1</div><div class="section3-title">Force (<span class="id">--force</span>)</div></div><div class="section-body"><div class="section-body-text">Forcer l'arrêt de tous les processus <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Cette option enverra un signal TERM à tous les processus <span class="backrest">pgBackRest</span> en cours pour effectuer un arrêt contrôlé et immédiat. Notez que cela arrêtera également les processus qui ont été lancés depuis un autre système et qui ont des commandes à distance fonctionnant sur le système actuel. Par exemple, si une sauvegarde a été lancée sur le serveur de sauvegarde, l'exécution de <span class="cmd">stop --force</span> sur le serveur de base de données arrêtera le processus de sauvegarde sur le serveur de sauvegarde.</div><pre class="code-block">default: n
example: --force</pre></div></div></div></div><div class="section2"><a id="command-stop/category-general"></a><div class="section2-header"><div class="section2-number">19.2</div><div class="section2-title">General Options</div></div><div class="section-body"><div class="section3"><a id="command-stop/category-general/option-cmd-ssh"></a><div class="section3-header"><div class="section3-number">19.2.1</div><div class="section3-title">Commande client SSH (<span class="id">--cmd-ssh</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès à l'exécutable du client ssh.</div><div class="section-body-text">Utilisez un client SSH spécifique lorsqu'une alternative est nécessaire ou lorsque l'exécutable <span class="file">ssh</span> n'est pas dans $PATH.</div><pre class="code-block">default: ssh
example: --cmd-ssh=/usr/bin/ssh</pre></div></div><div class="section3"><a id="command-stop/category-general/option-config"></a><div class="section3-header"><div class="section3-number">19.2.2</div><div class="section3-title">Config (<span class="id">--config</span>)</div></div><div class="section-body"><div class="section-body-text">Fichier de configuration <span class="backrest">pgBackRest</span>.</div><div class="section-body-text">Utiliser cette option pour spécifier un fichier de configuration différent de celui par défaut.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --config=/conf/pgbackrest/pgbackrest.conf</pre></div></div><div class="section3"><a id="command-stop/category-general/option-config-include-path"></a><div class="section3-header"><div class="section3-number">19.2.3</div><div class="section3-title">Config Include Path (<span class="id">--config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des fichiers de configuration <span class="backrest">pgBackRest</span> supplémentaires..</div><div class="section-body-text">Les fichiers de configuration existant à l'emplacement spécifié avec l'extension <span class="file">.conf</span> seront concaténés avec le fichier de configuration <span class="backrest">pgBackRest</span>, ce qui donne un seul fichier de configuration.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-stop/category-general/option-config-path"></a><div class="section3-header"><div class="section3-number">19.2.4</div><div class="section3-title">Emplacement configuration (<span class="id">--config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du répertoire de racine de <span class="backrest">pgBackRest</span> des fichiers de configuration.</div><div class="section-body-text">Ce paramètre est utilisé pour écraser le chemin racine par défaut pour les options <span class="br-option">--config</span> et <span class="br-option">--config-include-path</span> à moins qu'elles ne soient explicitement définies sur la ligne de commande.<br/>
<br/>
Par exemple, en utilisant uniquement <span class="id">--config-path=/conf/pgbackrest</span>, la valeur par défaut de <span class="br-option">--config</span> est <span class="id">/conf/pgbackrest/pgbackrest.conf</span> et la valeur par défaut de <span class="br-option">--config-include-path</span> est <span class="id">/conf/pgbackrest/conf.d</span>.</div><pre class="code-block">default: /etc/pgbackrest
example: --config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-stop/category-general/option-lock-path"></a><div class="section3-header"><div class="section3-number">19.2.5</div><div class="section3-title">Chemin fichier de verrouillage (<span class="id">--lock-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockés les fichiers de verrouillage.</div><div class="section-body-text">Le chemin de verrouillage fournit l'emplacement à <span class="backrest">pgBackRest</span> pour créer des fichiers de verrouillage afin d'éviter que des opérations en conflictuelles ne soient exécutées simultanément.</div><pre class="code-block">default: /tmp/pgbackrest
example: --lock-path=/backup/db/lock</pre></div></div><div class="section3"><a id="command-stop/category-general/option-neutral-umask"></a><div class="section3-header"><div class="section3-number">19.2.6</div><div class="section3-title">Umask neutre (<span class="id">--neutral-umask</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisation d'un <q>umask</q> neutre</div><div class="section-body-text">Définit l'umask à 0000 pour que les modes dans le dépôt de sauvegarde soient créés de manière appropriée. Le mode par défaut du répertoire est 0750 et le mode par défaut du fichier est 0640. Pour les répertoires lock et log, les modes de répertoire et de fichier sont respectivement fixés à 0770 et 0660.<br/>
<br/>
Pour utiliser l'umask de l'utilisateur en cours d'exécution, spécifiez plutôt <span class="br-setting">neutral-umask=n</span> dans le fichier de configuration ou <span class="br-setting">--no-neutral-umask</span> sur la ligne de commande.</div><pre class="code-block">default: y
example: --no-neutral-umask</pre></div></div><div class="section3"><a id="command-stop/category-general/option-stanza"></a><div class="section3-header"><div class="section3-number">19.2.7</div><div class="section3-title">Stanza (<span class="id">--stanza</span>)</div></div><div class="section-body"><div class="section-body-text">Defines the stanza.</div><div class="section-body-text">Un stanza est la configuration de la sauvegarde d'une instance <span class="postgres">PostgreSQL</span> où est définit l'endroit où il se trouve, la façon dont il sera sauvegardé, les options d'archivage, etc... La plupart des serveurs de base de données n'auront qu'une seule instance <span class="postgres">PostgreSQL</span> et donc un stanza alors que les serveurs de sauvegarde auront un stanza pour chaque instance de base de données qui doit être sauvegardé.<br/>
<br/>
Il est tentant de nommer le stanza en référence à l'instance primaire, mais un meilleur nom décrirait les bases de données contenues dans l'instance : comme le nom du stanza sera utilisé pour le primaire et tous les secondaire, il est plus approprié de choisir un nom qui décrit la fonction réelle du groupe d'instances, comme app ou dw, plutôt que le nom local de l'instance, comme main ou prod.</div><pre class="code-block">example: --stanza=main</pre></div></div></div></div><div class="section2"><a id="command-stop/category-log"></a><div class="section2-header"><div class="section2-number">19.3</div><div class="section2-title">Log Options</div></div><div class="section-body"><div class="section3"><a id="command-stop/category-log/option-log-level-console"></a><div class="section3-header"><div class="section3-number">19.3.1</div><div class="section3-title">Niveau du journal de la console (<span class="id">--log-level-console</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de journalisation en sortie sur la console.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-console=error</pre></div></div><div class="section3"><a id="command-stop/category-log/option-log-level-file"></a><div class="section3-header"><div class="section3-number">19.3.2</div><div class="section3-title">Niveau du journal fichier (<span class="id">--log-level-file</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau d'enregistrement des traces lors de l'enregistrement sur fichier.</div><div class="section-body-text">Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: info
example: --log-level-file=debug</pre></div></div><div class="section3"><a id="command-stop/category-log/option-log-level-stderr"></a><div class="section3-header"><div class="section3-number">19.3.3</div><div class="section3-title">Niveau du journal pour stderr (<span class="id">--log-level-stderr</span>)</div></div><div class="section-body"><div class="section-body-text">Niveau de traces sur la sortie console stderr.</div><div class="section-body-text">Spécifie les niveaux de traces qui sortiront en <span class="id">stderr</span> plutôt que <span class="id">stdout</span> (spécifié par <span class="br-option">log-level-console</span>). L'horodatage et le processus ne seront pas émis sur <span class="id">stderr</span>.<br/>
<br/>
Les niveaux de traces suivants sont pris en charge:<br/>
<ul><li><span class="id">off</span> - Pas de journal de traces (non recommandé)</li><li><span class="id">error</span> - Journaliser uniquement les erreurs</li><li><span class="id">warn</span> - Journaliser les avertissements et les erreurs</li><li><span class="id">info</span> - Journaliser les messages d'information, les avertissements et les erreurs</li><li><span class="id">detail</span> - Journaliser les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">debug</span> - Journaliser les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li><li><span class="id">trace</span> - Journaliser les traces (un débogage très verbeux), les message de Débogage, les détails, les messages d'information, les avertissements et les erreurs</li></ul></div><pre class="code-block">default: warn
example: --log-level-stderr=error</pre></div></div><div class="section3"><a id="command-stop/category-log/option-log-path"></a><div class="section3-header"><div class="section3-number">19.3.4</div><div class="section3-title">Emplacement du journal (<span class="id">--log-path</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement où les fichiers journaux de traces sont stockés.</div><div class="section-body-text">Le chemin d'accès au journal fournit un emplacement pour <span class="backrest">pgBackRest</span> pour stocker les fichiers journaux. Notez que si <span class="br-setting">log-level-file=off</span> alors aucun chemin pour l'emplacement des journaux de traces n'est nécessaire.</div><pre class="code-block">default: /var/log/pgbackrest
example: --log-path=/backup/db/log</pre></div></div><div class="section3"><a id="command-stop/category-log/option-log-subprocess"></a><div class="section3-header"><div class="section3-number">19.3.5</div><div class="section3-title">Journalisation des sous-processus (<span class="id">--log-subprocess</span>)</div></div><div class="section-body"><div class="section-body-text">Activer la journalisation des traces dans les sous-processus.</div><div class="section-body-text">Activez la journalisation des traces dans les fichiers pour tous les sous-processus créés par ce processus en utilisant le niveau de journalisation spécifié par <span class="br-option">log-level-file</span>.</div><pre class="code-block">default: n
example: --log-subprocess</pre></div></div><div class="section3"><a id="command-stop/category-log/option-log-timestamp"></a><div class="section3-header"><div class="section3-number">19.3.6</div><div class="section3-title">Horodatage du journal (<span class="id">--log-timestamp</span>)</div></div><div class="section-body"><div class="section-body-text">Activer l'horodatage dans les traces.</div><div class="section-body-text">Active l'horodatage dans la console et l'enregistrement des fichiers. Cette option est désactivée dans des situations particulières telles que la génération de documentation.</div><pre class="code-block">default: y
example: --no-log-timestamp</pre></div></div></div></div><div class="section2"><a id="command-stop/category-repository"></a><div class="section2-header"><div class="section2-number">19.4</div><div class="section2-title">Repository Options</div></div><div class="section-body"><div class="section3"><a id="command-stop/category-repository/option-repo-cipher-type"></a><div class="section3-header"><div class="section3-number">19.4.1</div><div class="section3-title">Type de chiffrement du dépôt (<span class="id">--repo-cipher-type</span>)</div></div><div class="section-body"><div class="section-body-text">Chiffrement (cipher) utilisé pour chiffrer le dépôt.</div><div class="section-body-text">Les types de chiffrement suivants sont pris en charge:<br/>
<ul><li><span class="id">none</span> - Le dépôt n'est pas chiffré.</li><li><span class="id">aes-256-cbc</span> - Advanced Encryption Standard avec une clef de 256 bit</li></ul>À noter que le chiffrement est toujours effectué côté client même si le type de stockage (par exemple S3) supporte le chiffrement.</div><pre class="code-block">default: none
example: --repo1-cipher-type=aes-256-cbc</pre></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-host"></a><div class="section3-header"><div class="section3-number">19.4.2</div><div class="section3-title">Hôte du dépot (<span class="id">--repo-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte de dépôt dans le cas d'un fonctionnement à distance via SSH.</div><div class="section-body-text">Assurez-vous que l'authentification SSH soit correctement approuvé entre l'hôte <span class="postgres">PostgreSQL</span> et l'hôte du référentiel.<br/>
<br/>
Ce paramètre n'est pas nécessaire pour la sauvegarde et l'archivage sur un système de fichiers monté localement.</div><pre class="code-block">example: --repo1-host=repo1.domain.com</pre><div class="section-body-text">Nom obsolète: backup-host</div></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-host-cmd"></a><div class="section3-header"><div class="section3-number">19.4.3</div><div class="section3-title">Chemin des binaires (<span class="id">--repo-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin des binaires <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Nécessaire uniquement si le chemin d'accès à <span class="file">pgbackrest</span> est différent entre les hôtes locaux et l'hote du dépôt. S'il n'est pas défini, le chemin des binaires sur l'hôte du dépôt sera le même que le chemin des binaires locaux.</div><pre class="code-block">example: --repo1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: backup-cmd</div></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-host-config"></a><div class="section3-header"><div class="section3-number">19.4.4</div><div class="section3-title">Emplacement du fichier de configuration (<span class="id">--repo-host-config</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement du fichier de configuration <span class="backrest">pgBackRest</span> sur l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le fichier de configuration de l'hôte du dépôt se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --repo1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: backup-config</div></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-host-config-include-path"></a><div class="section3-header"><div class="section3-number">19.4.5</div><div class="section3-title">Chemin d'inclusion de la configuration (<span class="id">--repo-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion <span class="backrest">pgBackRest</span> de la configuration de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin d'inclusion de la configuration de l'hôte du dépôt se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --repo1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-host-config-path"></a><div class="section3-header"><div class="section3-number">19.4.6</div><div class="section3-title">Chemin de configuration (<span class="id">--repo-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte du dépôt.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte du dépôt. Ceci n'est nécessaire que si le chemin de configuration de l'hôte du référentiel se trouve à un endroit différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --repo1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-host-port"></a><div class="section3-header"><div class="section3-number">19.4.7</div><div class="section3-title">Port de l'hôte du dépôt (<span class="id">--repo-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Utilisez cette option pour spécifier un port non par défaut pour le protocole d'accès à l'hôte du dépôt. Actuellement, seul SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --repo1-host-port=25</pre><div class="section-body-text">Nom obsolète: backup-ssh-port</div></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-host-user"></a><div class="section3-header"><div class="section3-number">19.4.8</div><div class="section3-title">Utilisateur de l'hôte du dépôt (<span class="id">--repo-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de l'hôte du dépôt lorsque <span class="br-setting">repo-host</span> est défini.</div><div class="section-body-text">Définit l'utilisateur qui sera utilisé pour les opérations sur l'hôte du dépôt. De préférence, il ne s'agit pas de l'utilisateur <span class="id">postgres</span> mais plutôt d'un autre utilisateur comme <span class="id">pgbackrest</span>. Si <span class="postgres">PostgreSQL</span> fonctionne sur l'hôte du dépôt, l'utilisateur <span class="id">postgres</span> peut être placé dans le groupe <span class="id">pgbackrest</span> afin qu'il ait les autorisations de lecture sur le dépôt sans pouvoir en endommager le contenu accidentellement.</div><pre class="code-block">default: pgbackrest
example: --repo1-host-user=repo-user</pre><div class="section-body-text">Nom obsolète: backup-user</div></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-path"></a><div class="section3-header"><div class="section3-number">19.4.9</div><div class="section3-title">Chemin d'accès du Dépots (<span class="id">--repo-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'accès où sont stockées les sauvegardes et les archives.</div><div class="section-body-text">Le dépôt est l'endroit où <span class="backrest">pgBackRest</span> stocke les sauvegardes et archive les segments des journaux de transaction (WAL).<br/>
<br/>
Il peut être difficile d'estimer à l'avance l'espace dont vous aurez besoin. La meilleure chose à faire est de prendre quelques sauvegardes puis d'enregistrer la taille des différents types de sauvegardes (full/incr/diff) et de mesurer la quantité de WAL générée par jour. Cela vous donnera une idée générale de l'espace dont vous aurez besoin, même si, bien sûr, les besoins changeront probablement au fil du temps, à fur et à mesure de l'évolution de votre base de données.</div><pre class="code-block">default: /var/lib/pgbackrest
example: --repo1-path=/backup/db/backrest</pre></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-s3-bucket"></a><div class="section3-header"><div class="section3-number">19.4.10</div><div class="section3-title">S3 Bucket (<span class="id">--repo-s3-bucket</span>)</div></div><div class="section-body"><div class="section-body-text">S3 dépôt bucket.</div><div class="section-body-text">Bucket S3 utilisé pour stocker le dépôt.<br/>
<br/>
Les dépots <span class="backrest">pgBackRest</span> peuvent être stockés à la racine du bucket en définissant <span class="br-option">repo-path=/</span> mais il est généralement préférable de spécifier un préfixe, comme par exemple <span class="path">/repo</span>, afin que les logs et autres contenus générés par AWS puissent également être stockés dans le bucket.</div><pre class="code-block">example: --repo1-s3-bucket=pg-backup</pre></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-s3-ca-file"></a><div class="section3-header"><div class="section3-number">19.4.11</div><div class="section3-title">Fichier SSL CA S3 (<span class="id">--repo-s3-ca-file</span>)</div></div><div class="section-body"><div class="section-body-text">Ficher SSL CA S3.</div><div class="section-body-text">Utiliser un fichier CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-file=/etc/pki/tls/certs/ca-bundle.crt</pre></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-s3-ca-path"></a><div class="section3-header"><div class="section3-number">19.4.12</div><div class="section3-title">Chemin SSL CA (<span class="id">--repo-s3-ca-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin S3 SSL CA.</div><div class="section-body-text">Utiliser un chemin pour le CA autre que celui défini par défaut dans le système.</div><pre class="code-block">example: --repo1-s3-ca-path=/etc/pki/tls/certs</pre></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-s3-endpoint"></a><div class="section3-header"><div class="section3-number">19.4.13</div><div class="section3-title">Point de terminaison S3 (<span class="id">--repo-s3-endpoint</span>)</div></div><div class="section-body"><div class="section-body-text">Dépot S3 Point de terminaison (endpoint).</div><div class="section-body-text">Le point de terminaison d'AWS doit être valable pour la région sélectionnée.</div><pre class="code-block">example: --repo1-s3-endpoint=s3.amazonaws.com</pre></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-s3-host"></a><div class="section3-header"><div class="section3-number">19.4.14</div><div class="section3-title">Hôte S3 (<span class="id">--repo-s3-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte du dépot S3.</div><div class="section-body-text">Conntecter sur un hôte différent du point de terminaison (endpoint). Il est généralement utilisé à des fins de test.</div><pre class="code-block">example: --repo1-s3-host=127.0.0.1</pre></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-s3-port"></a><div class="section3-header"><div class="section3-number">19.4.15</div><div class="section3-title">Port S3 (<span class="id">--repo-s3-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de connection au dépot S3.</div><div class="section-body-text">Port à utiliser lors de la connexion au point de terminaison (ou à l'hôte si spécifié).</div><pre class="code-block">default: 443
allowed: 1-65535
example: --repo1-s3-port=9000</pre></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-s3-region"></a><div class="section3-header"><div class="section3-number">19.4.16</div><div class="section3-title">Région S3 (<span class="id">--repo-s3-region</span>)</div></div><div class="section-body"><div class="section-body-text">Région du dépôt S3.</div><div class="section-body-text">La région d'AWS où le bucket a été créé.</div><pre class="code-block">example: --repo1-s3-region=us-east-1</pre></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-s3-uri-style"></a><div class="section3-header"><div class="section3-number">19.4.17</div><div class="section3-title">S3 Formats d'URI (<span class="id">--repo-s3-uri-style</span>)</div></div><div class="section-body"><div class="section-body-text">S3 URI formats.</div><div class="section-body-text">Les formats URI suivants sont pris en charge:<br/>
<ul><li><span class="id">host</span> - Connexion à l'hôte <span class="id">bucket.endpoint</span>.</li><li><span class="id">path</span> - Connexion à l'hôte <span class="id">endpoint</span> et ajout du bucket aux URIs.</li></ul></div><pre class="code-block">default: host
example: --repo1-s3-uri-style=path</pre></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-s3-verify-tls"></a><div class="section3-header"><div class="section3-number">19.4.18</div><div class="section3-title">S3 Vérifiction TLS (<span class="id">--repo-s3-verify-tls</span>)</div></div><div class="section-body"><div class="section-body-text">Vérifier le certificat du serveur S3.</div><div class="section-body-text">Désactive la vérification du certificat du serveur S3. Cette fonction ne doit être utilisée que dans le cadre de tests ou dans le cas d'une utilisation avec un certificat a été auto-signé.</div><pre class="code-block">default: y
example: --no-repo1-s3-verify-tls</pre><div class="section-body-text">Nom obsolète: repo-s3-verify-ssl</div></div></div><div class="section3"><a id="command-stop/category-repository/option-repo-type"></a><div class="section3-header"><div class="section3-number">19.4.19</div><div class="section3-title">Type de dépot (<span class="id">--repo-type</span>)</div></div><div class="section-body"><div class="section-body-text">Type de stockage utilisé pour le dépôt.</div><div class="section-body-text">Les types de stockage suivants sont pris en charge :<br/>
<ul><li><span class="id">cifs</span> - Comme <span class="id">posix</span>, mais désactive les liens et les fsyncs sur les répertoires</li><li><span class="id">posix</span> - Systèmes de fichiers conformes à Posix</li><li><span class="id">s3</span> - Service de stockage d'objet (AWS Simple Storage Service)</li></ul></div><pre class="code-block">default: posix
example: --repo1-type=cifs</pre></div></div></div></div><div class="section2"><a id="command-stop/category-stanza"></a><div class="section2-header"><div class="section2-number">19.5</div><div class="section2-title">Stanza Options</div></div><div class="section-body"><div class="section3"><a id="command-stop/category-stanza/option-pg-host"></a><div class="section3-header"><div class="section3-number">19.5.1</div><div class="section3-title">Hôte PostgreSQL (<span class="id">--pg-host</span>)</div></div><div class="section-body"><div class="section-body-text">Hôte <span class="postgres">PostgreSQL</span> pour les opérations à distance via SSH.</div><div class="section-body-text">Utilisé pour les sauvegardes lorsque l'hôte <span class="postgres">PostgreSQL</span> est différent de l'hôte du dépôt.</div><pre class="code-block">example: --pg1-host=db.domain.com</pre><div class="section-body-text">Nom obsolète: db-host</div></div></div><div class="section3"><a id="command-stop/category-stanza/option-pg-host-cmd"></a><div class="section3-header"><div class="section3-number">19.5.2</div><div class="section3-title">Hôte PostgreSQL Commande (<span class="id">--pg-host-cmd</span>)</div></div><div class="section-body"><div class="section-body-text">Emplacement des exécutable <span class="backrest">pgBackRest</span> sur l'hôte <span class="postgres">PostgreSQL</span>.</div><div class="section-body-text">Uniquement requis si le chemin vers <span class="file">pgbackrest</span> est différent sur le serveur local et <span class="postgres">PostgreSQL</span>. S'il n'est pas défini, le chemin de l'<span class="file">pgbackrest</span> de l'hôte de la base de données sera le même que le chemin de l'<span class="file">pgbackrest</span> local.</div><pre class="code-block">example: --pg1-host-cmd=/usr/lib/backrest/bin/pgbackrest</pre><div class="section-body-text">Nom obsolète: db-cmd</div></div></div><div class="section3"><a id="command-stop/category-stanza/option-pg-host-config"></a><div class="section3-header"><div class="section3-number">19.5.3</div><div class="section3-title">Hôte PostgreSQL Configuration (<span class="id">--pg-host-config</span>)</div></div><div class="section-body"><div class="section-body-text"><span class="backrest">pgBackRest</span> database host configuration file.</div><div class="section-body-text">Définit l'emplacement du fichier de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le fichier de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent de celui du fichier de configuration local.</div><pre class="code-block">default: /etc/pgbackrest/pgbackrest.conf
example: --pg1-host-config=/conf/pgbackrest/pgbackrest.conf</pre><div class="section-body-text">Nom obsolète: db-config</div></div></div><div class="section3"><a id="command-stop/category-stanza/option-pg-host-config-include-path"></a><div class="section3-header"><div class="section3-number">19.5.4</div><div class="section3-title">Hôte PostgreSQL Chemin inclusion Configuration (<span class="id">--pg-host-config-include-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin d'inclusion de la configuration <span class="backrest">pgBackRest</span> sur l'hôte.</div><div class="section-body-text">Définit l'emplacement du chemin d'inclusion de la configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin d'inclusion de la configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve à un endroit différent du chemin d'inclusion de la configuration locale.</div><pre class="code-block">default: /etc/pgbackrest/conf.d
example: --pg1-host-config-include-path=/conf/pgbackrest/conf.d</pre></div></div><div class="section3"><a id="command-stop/category-stanza/option-pg-host-config-path"></a><div class="section3-header"><div class="section3-number">19.5.5</div><div class="section3-title">Hôte PostgreSQL Chemin Configuration (<span class="id">--pg-host-config-path</span>)</div></div><div class="section-body"><div class="section-body-text">Chemin de configuration <span class="backrest">pgBackRest</span> de l'hôte de base de données.</div><div class="section-body-text">Définit l'emplacement du chemin de configuration sur l'hôte <span class="postgres">PostgreSQL</span>. Ceci n'est requis que si le chemin de configuration de l'hôte <span class="postgres">PostgreSQL</span> se trouve dans un emplacement différent du chemin de configuration local.</div><pre class="code-block">default: /etc/pgbackrest
example: --pg1-host-config-path=/conf/pgbackrest</pre></div></div><div class="section3"><a id="command-stop/category-stanza/option-pg-host-port"></a><div class="section3-header"><div class="section3-number">19.5.6</div><div class="section3-title">Hôte PostgreSQL Port (<span class="id">--pg-host-port</span>)</div></div><div class="section-body"><div class="section-body-text">Port de l'hôte <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est configuré.</div><div class="section-body-text">Utiliser cette option pour spécifier un port non par défaut pour le protocole hôte <span class="postgres">PostgreSQL</span>. Actuellement, seul le protocole SSH est pris en charge</div><pre class="code-block">allowed: 0-65535
example: --pg1-host-port=25</pre><div class="section-body-text">Nom obsolète: db-ssh-port</div></div></div><div class="section3"><a id="command-stop/category-stanza/option-pg-host-user"></a><div class="section3-header"><div class="section3-number">19.5.7</div><div class="section3-title">Hôte PostgreSQL Utilisateur (<span class="id">--pg-host-user</span>)</div></div><div class="section-body"><div class="section-body-text">Utilisateur de connexion <span class="postgres">PostgreSQL</span> lorsque <span class="br-setting">pg-host</span> est défini.</div><div class="section-body-text">Cet utilisateur sera également propriétaire du processus distant <span class="backrest">pgBackRest</span> et initiera les connexions à <span class="postgres">PostgreSQL</span>. Pour que cela puisse fonctionner correctement, l'utilisateur doit être le propriétaire de l'instance de base de données <span class="postgres">PostgreSQL</span>, qui est généralement par défaut <span class="id">postgres</span>.</div><pre class="code-block">default: postgres
example: --pg1-host-user=db_owner</pre><div class="section-body-text">Nom obsolète: db-user</div></div></div></div></div></div></div><div class="section1"><a id="command-version"></a><div class="section1-header"><div class="section1-number">20</div><div class="section1-title">Commande Version (<span class="id">version</span>)</div></div><div class="section-intro">Affiche la version <span class="backrest">pgBackRest</span> installée..</div><div class="section-body"></div></div></div><div class="page-footer">Copyright &copy; 2015-2020, The PostgreSQL Global Development Group, <a href="https://github.com/pgbackrest/pgbackrest/blob/master/LICENSE">MIT License</a>.  Updated July 2, 2020</div></body></html>